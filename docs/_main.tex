% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Usefulness of R for Psychology},
  pdfauthor={Fábio A. Silva},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}

\title{Usefulness of R for Psychology}
\author{Fábio A. Silva}
\date{2021-10-15}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

\emph{What you'll learn here}:

\begin{itemize}
\item
  Extract data from single and multiple output files (in different formats).
\item
  Mess around with the data, changing the dataframe to your preference.
\item
  Extract target measures (accuracy, response times, sensitivity, criterion, etc.)
\item
  Visualize the data as it comes in.
\item
  Create multiple parameters at the beginning that allow you to change minor details while running the script.
\item
  Extract data for mixed models.
\item
  Produce simple analysis (for a more detailed vision on analysis, see P2).
\item
  \ldots{}
\end{itemize}

\hypertarget{opening-files}{%
\chapter{OPENING FILES}\label{opening-files}}

\textbf{Before opening the data}\\
First, you need to tell R where the files are located. He is lazy that way, and will not look everywhere on your computer for them. So, tell him by using the command \texttt{setwd()}.

\textbf{Reading the data}\\
So, by now you should have a general idea on how to import data files to R. Here we just remind you how to read some of the most common formats, atlthough R can read just about anything (just google read ``file type'' in R on google). Be sure to install the \texttt{xlsx} and \texttt{haven} packages to open Excell and SPSS files, respectively. Additionally, there are multiple ways to read the same file. Some will be built in R itself, others will require external packages. This is important to know because some functions, although working, may be outdated or just give you some sort of weird error. Maybe you can overcome this by using a different package.

If you want to import/read an Excel file, just use:\\
\texttt{read.xlsx(file\ =\ \textquotesingle{}example.xlsx\textquotesingle{},\ sheetName\ =\ \textquotesingle{}page\_1\textquotesingle{},\ header\ =\ TRUE)}~\\
If a text file:\\
\texttt{read.delim(file\ =\ \textquotesingle{}example.txt\textquotesingle{},\ header\ =\ TRUE,\ sep\ =\ \textquotesingle{},\textquotesingle{},\ dec\ =\ \textquotesingle{}.\textquotesingle{})}~\\
CSV:\\
\texttt{read.csv(file\ =\ \textquotesingle{}example.csv\textquotesingle{},\ header\ =\ TRUE,\ sep\ =\ \textquotesingle{},\textquotesingle{},\ dec\ =\ \textquotesingle{}.\textquotesingle{})}~\\
SAV (SPSS):\\
\texttt{read\_sav(file\ =\ \textquotesingle{}example.sav\textquotesingle{})}

\textbf{Managing your imported data}\\
To have your data in your environment, so that you can mess with it, you should assign your \texttt{read} command to a variable (object). Lets say you do the following \texttt{df\ \textless{}-\ read.delim(file\ =\ \textquotesingle{}example.txt\textquotesingle{},\ header\ =\ TRUE,\ sep\ =\ \textquotesingle{},\textquotesingle{},\ dec\ =\ \textquotesingle{}.\textquotesingle{})}. Now, your df object is the dataframe containing that imported data set.

\textbf{Possible problems}\\
You may encounter several problems. Perhaps one of the most common problems is the something like ``the number of columns is superior to the data''. This probably has to due with R separating columns where it shouldn't or making more columns than it should. You can fix this perhaps by making sure the \texttt{sep} command is specifying the exact separator of the file. It helps to open the file with excel for instance, and double check the separator. Also be sure that you have the decimal symbol is different from the new columns symbol. For instance, sometimes R reads the .csv file (which means comma separated file) and you have commas as decimals. This creates way to many columns that mismatch the number of headers present.\\
There will surely be more problems, but you can find a way around them by using google.

\textbf{Checking the data}\\
After you've opened the data, you should take a peak at it. There's several ways of doing this such as \texttt{head(df)} or some others I'm not recalling at the moment. Lets see bellow.

\hypertarget{opening-multiple-files}{%
\section{Opening multiple files}\label{opening-multiple-files}}

Lets say you have a folder, lets assume is named ``data'', and in there you have all your data files (files from each participant). Ideally, to analyze and view the data as a whole, you would want to import all of the data files, and then merge them into a big data file, containing all the participants (identified accordingly).\\
+
Here's a snippet of code that would allow you to do that. Beware though, any file that matches the criteria (in this case ``.csv'' files) will be gathered from the folder (your working directory).

Firstly, lets gather the names of the files in our directory that we wanna import.\\
P.s. Ignore the warning, it just tells you that the directory is only changed for this chunk and then it goes back to normal.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Setting our working directory for this chunk (in this case our data folder)}
\FunctionTok{setwd}\NormalTok{(}\StringTok{\textquotesingle{}data\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Listing all txt files in folder}
\NormalTok{list\_of\_files }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}

\CommentTok{\# Searches for ".csv" files in the folder}
\NormalTok{list\_all\_data }\OtherTok{\textless{}{-}} \FunctionTok{dir}\NormalTok{(}\AttributeTok{pattern=}\StringTok{\textquotesingle{}.csv\textquotesingle{}}\NormalTok{)}

\CommentTok{\# For each ".csv" file, append this file to a list that will contain all ".csv" file names.}
\ControlFlowTok{for}\NormalTok{ (file }\ControlFlowTok{in}\NormalTok{ list\_all\_data)\{}
\NormalTok{  list\_of\_files }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(list\_of\_files, file)}
  \FunctionTok{cat}\NormalTok{(}\StringTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}n}\StringTok{File processed:\textquotesingle{}}\NormalTok{, file)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## File processed: Participant_1.csv
## File processed: Participant_10.csv
## File processed: Participant_2.csv
## File processed: Participant_3.csv
## File processed: Participant_4.csv
## File processed: Participant_5.csv
## File processed: Participant_6.csv
## File processed: Participant_7.csv
## File processed: Participant_8.csv
## File processed: Participant_9.csv
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Organizing the files}
\NormalTok{list\_of\_files }\OtherTok{\textless{}{-}} \FunctionTok{as.character}\NormalTok{(list\_of\_files)  }\CommentTok{\# To character}
\CommentTok{\#list\_of\_files \textless{}{-} mixedsort(sort(list\_of\_files))  \# Sorting them by name}
\NormalTok{list\_of\_files }\OtherTok{\textless{}{-}} \FunctionTok{as.list}\NormalTok{(list\_of\_files)  }\CommentTok{\# Transforming it to list}

\CommentTok{\# How many files were processed?}
\FunctionTok{cat}\NormalTok{(}\StringTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}n}\StringTok{Total number of files processed:\textquotesingle{}}\NormalTok{, }\FunctionTok{length}\NormalTok{(}\FunctionTok{unlist}\NormalTok{(list\_of\_files)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Total number of files processed: 10
\end{verbatim}

Then we need to create a function that iterates over all of this file names. It will need to import each file (by their name) and append them to a general dataframe.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Setting the working directory to the data folder for this chunk as well}
\FunctionTok{setwd}\NormalTok{(}\StringTok{\textquotesingle{}data\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Create our function with "file\_name" as input.}
\NormalTok{import\_data }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(file\_name)\{}
\NormalTok{  df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(file\_name, }\AttributeTok{header=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{encoding =} \StringTok{\textquotesingle{}utf{-}8\textquotesingle{}}\NormalTok{, }\AttributeTok{sep=}\StringTok{\textquotesingle{},\textquotesingle{}}\NormalTok{)  }\CommentTok{\# Import one file and name it "df"}
\NormalTok{  df\_part }\OtherTok{\textless{}\textless{}{-}}\NormalTok{ df  }\CommentTok{\# Make this file available outside the function}
\NormalTok{\}}

\CommentTok{\# We create an empty dataframe where all individual dataframes will be merged}
\NormalTok{df\_all }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{() }

\CommentTok{\# Create a index for number of name in list}
\NormalTok{ind }\OtherTok{\textless{}{-}} \DecValTok{1}  \CommentTok{\# Begins with file name 1.}

\CommentTok{\# Run the function}
\ControlFlowTok{for}\NormalTok{ (x }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(list\_of\_files))\{}
\NormalTok{  file\_name }\OtherTok{\textless{}{-}} \FunctionTok{unlist}\NormalTok{(list\_of\_files[ind])  }\CommentTok{\# Select one name from our list}
  \FunctionTok{import\_data}\NormalTok{(file\_name) }\CommentTok{\# Run our function }
\NormalTok{  ind }\OtherTok{\textless{}{-}}\NormalTok{ ind }\SpecialCharTok{+} \DecValTok{1}  \CommentTok{\# Move index of number along.}
\NormalTok{  df\_all }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(df\_all, df\_part)  }\CommentTok{\# Adds the individual dataframe to our "big" dataframe.}
\NormalTok{\}}

\CommentTok{\# Seeing our dataframe (you can see it all by clicking on it or using "View(df\_all)").}
\FunctionTok{head}\NormalTok{(df\_all)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Participant_ID   Condition       RT
## 1              1 Condition_1 1.478651
## 2              1 Condition_1 1.495121
## 3              1 Condition_1 1.506271
## 4              1 Condition_1 1.561987
## 5              1 Condition_1 1.508967
## 6              1 Condition_1 1.512732
\end{verbatim}

\hypertarget{exporting-files}{%
\section{Exporting files}\label{exporting-files}}

Aside from important, sometimes we also want to export the files we created/modified in R. We can do this with several commands, but perhaps the simpler ones are:\\
\texttt{write.table(x\ =\ df,\ file\ =\ \textquotesingle{}namewewant.txt\textquotesingle{},\ sep\ =\ \textquotesingle{},\textquotesingle{},\ dec\ =\ \textquotesingle{}.\textquotesingle{})} - We are export the \texttt{df} dataframe, to a not existing file with a name ``namewewant.txt'', that is separated by commas and has ``.'' for decimal points. We can also export to an existing data file, and ask for \texttt{append\ =\ TRUE}.

\texttt{write.csv(x\ =\ df,\ file\ =\ \textquotesingle{}namewewant.txt\textquotesingle{})} - Same thing as above, but instead creates a ``.csv'' file.

As an example, lets export the dataframe we created in the chunks above.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{write.csv}\NormalTok{(}\AttributeTok{x =}\NormalTok{ df\_all, }\AttributeTok{file =} \StringTok{\textquotesingle{}some\_data.csv\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{managing-the-data}{%
\chapter{MANAGING THE DATA}\label{managing-the-data}}

Now, in R you can manage your dataframe as you please. You can do anything. And I truly mean anything. Anything you can do in Excel and then some.

\hypertarget{classes-types-and-structures}{%
\section{Classes, Types and Structures}\label{classes-types-and-structures}}

The data you imported can be in a wide range of classes (types). There are 3 basic types of classes, built-in (different functions can use more), you need to be aware (altough there are more). These are:

\begin{itemize}
\tightlist
\item
  \emph{character}: strings (words), such as \texttt{"hello"} or \texttt{"hi123"}.\\
\item
  \emph{numeric}: any type of number, such as \texttt{2}or \texttt{30.4}.\\
\item
  \emph{logical}: The true or false values. \texttt{TRUE} or \texttt{FALSE}.
\end{itemize}

You can ask R about what type of object it is by using the \texttt{class(object)} command or the \texttt{typeof(object)}

R also has different data structures. The ones worth talking about here are:

\begin{itemize}
\tightlist
\item
  \emph{atomic vector}: Basically every R data structure. A vector could be a character or an numeric object, for instance.
\item
  \emph{lists}: a list of objects. Can be created by using \texttt{list()}. You can retrieve the value by using \texttt{{[}{[}{]}{]}}.
\item
  \emph{matrix}: are like tables.
\item
  \emph{data frame}: fancy matrices (more common)
\item
  \emph{factor}: more of a type of class than anything. This object is a factor with levels.
\item
  \emph{tibble}: a special data frame from tidyverse
\end{itemize}

\url{https://swcarpentry.github.io/r-novice-inflammation/13-supp-data-structures/}

\hypertarget{columns}{%
\section{Columns}\label{columns}}

Lets start by some simply manipulations. Lets say you want to change column names. Ideally, I would avoid spaces in the headers (and overall actually) but you do as you please.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris  }\CommentTok{\# mtcars is a built{-}in dataset. Just imagine I\textquotesingle{}m reading from a file}
\CommentTok{\# Option 1}
\FunctionTok{colnames}\NormalTok{(df) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Colname 1\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 2\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 3\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 4\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 5\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Option 2}
\FunctionTok{names}\NormalTok{(df) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Colname 1\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 2\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 3\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 4\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 5\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Or just change a specific column name}
\FunctionTok{colnames}\NormalTok{(df)[}\DecValTok{2}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}Colname 2 {-} New\textquotesingle{}}

\CommentTok{\# Finale result}
\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Colname 1 Colname 2 - New Colname 3 Colname 4 Colname 5
## 1       5.1             3.5       1.4       0.2    setosa
## 2       4.9             3.0       1.4       0.2    setosa
## 3       4.7             3.2       1.3       0.2    setosa
## 4       4.6             3.1       1.5       0.2    setosa
## 5       5.0             3.6       1.4       0.2    setosa
## 6       5.4             3.9       1.7       0.4    setosa
\end{verbatim}

We can also change the order of the columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[,}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

We can sort by a specific (or multiple columns).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris  }\CommentTok{\# Just restoring the dataframe to be less confusing}


\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[}\FunctionTok{order}\NormalTok{(df[, }\DecValTok{1}\NormalTok{]), ]  }\CommentTok{\# Orders by first column}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[}\FunctionTok{order}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{df[, }\DecValTok{1}\NormalTok{]), ]  }\CommentTok{\# Orders by first column descending}

\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[}\FunctionTok{order}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{df[, }\DecValTok{1}\NormalTok{], df[, }\DecValTok{3}\NormalTok{]), ]  }\CommentTok{\# Orders by first columns descending and then by third column}
\end{Highlighting}
\end{Shaded}

We can create new columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{new\_data }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\StringTok{\textquotesingle{}New Data\textquotesingle{}}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(df))  }\CommentTok{\# Creating new irrelevant data}

\NormalTok{df}\SpecialCharTok{$}\NormalTok{NewColumn }\OtherTok{\textless{}{-}}\NormalTok{ new\_data  }\CommentTok{\# Added this data (data must have same length as dataframe!)}

\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species NewColumn
## 132          7.9         3.8          6.4         2.0 virginica  New Data
## 136          7.7         3.0          6.1         2.3 virginica  New Data
## 118          7.7         3.8          6.7         2.2 virginica  New Data
## 123          7.7         2.8          6.7         2.0 virginica  New Data
## 119          7.7         2.6          6.9         2.3 virginica  New Data
## 106          7.6         3.0          6.6         2.1 virginica  New Data
\end{verbatim}

How to remove columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{Petal.Length }\OtherTok{\textless{}{-}} \ConstantTok{NULL}
\CommentTok{\# or}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{within}\NormalTok{(df, }\FunctionTok{rm}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

We can create and transform the columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris}

\NormalTok{df}\SpecialCharTok{$}\NormalTok{Sepal\_Area }\OtherTok{\textless{}{-}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Sepal.Length }\SpecialCharTok{*}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Sepal.Width  }\CommentTok{\# Creating new variable with is the multiplication of the first 2.}

\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species Sepal_Area
## 1          5.1         3.5          1.4         0.2  setosa      17.85
## 2          4.9         3.0          1.4         0.2  setosa      14.70
## 3          4.7         3.2          1.3         0.2  setosa      15.04
## 4          4.6         3.1          1.5         0.2  setosa      14.26
## 5          5.0         3.6          1.4         0.2  setosa      18.00
## 6          5.4         3.9          1.7         0.4  setosa      21.06
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{Sepal\_Area }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Sepal\_Area, }\DecValTok{1}\NormalTok{)  }\CommentTok{\# Transforming existing variable, making it just 1 decimal.}

\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species Sepal_Area
## 1          5.1         3.5          1.4         0.2  setosa       17.8
## 2          4.9         3.0          1.4         0.2  setosa       14.7
## 3          4.7         3.2          1.3         0.2  setosa       15.0
## 4          4.6         3.1          1.5         0.2  setosa       14.3
## 5          5.0         3.6          1.4         0.2  setosa       18.0
## 6          5.4         3.9          1.7         0.4  setosa       21.1
\end{verbatim}

\hypertarget{rows}{%
\section{Rows}\label{rows}}

Altering specific rows is a bit trickier. Nevertheless, this is usually less relevant, since we usually just want to change or apply a condition to an entire column. Having said this, here's some relevant commands.

Say you want to alter rows that meet a condition.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{Sepal.Length[df}\SpecialCharTok{$}\NormalTok{Sepal.Length }\SpecialCharTok{\textless{}=} \DecValTok{5}\NormalTok{] }\OtherTok{\textless{}{-}} \DecValTok{0}  \CommentTok{\# Any row in the Sepal.Length column less than five will turn to 0}

\NormalTok{df}\SpecialCharTok{$}\NormalTok{Sepal.Length[df}\SpecialCharTok{$}\NormalTok{Sepal.Length }\SpecialCharTok{==} \FloatTok{7.9}\NormalTok{] }\OtherTok{\textless{}{-}} \DecValTok{8}  \CommentTok{\# Changing rows with 7.9 to 8. }
\end{Highlighting}
\end{Shaded}

How to create a new entry (i.e., row).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{row }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FloatTok{5.6}\NormalTok{, }\FloatTok{3.2}\NormalTok{, }\FloatTok{1.9}\NormalTok{, }\FloatTok{0.1}\NormalTok{, }\StringTok{\textquotesingle{}new\_species\textquotesingle{}}\NormalTok{, }\DecValTok{10000}\NormalTok{)  }\CommentTok{\# Create a new row (all columns must be filled)}
\FunctionTok{colnames}\NormalTok{(row) }\OtherTok{\textless{}{-}} \FunctionTok{colnames}\NormalTok{(df)}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(df, row)}

\FunctionTok{tail}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     Sepal.Length Sepal.Width Petal.Length Petal.Width     Species Sepal_Area
## 146          6.7         3.0          5.2         2.3   virginica       20.1
## 147          6.3         2.5          5.0         1.9   virginica       15.8
## 148          6.5         3.0          5.2         2.0   virginica       19.5
## 149          6.2         3.4          5.4         2.3   virginica       21.1
## 150          5.9         3.0          5.1         1.8   virginica       17.7
## 151          5.6         3.2          1.9         0.1 new_species    10000.0
\end{verbatim}

How to delete a row.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(}\DecValTok{151}\NormalTok{, }\DecValTok{152}\NormalTok{),]}
\end{Highlighting}
\end{Shaded}

\hypertarget{tidyverse}{%
\section{Tidyverse}\label{tidyverse}}

Tidyverse allows us to do lots of things in a useful and simple way. Lets explore some of its several commands.
More than ever, tidyverse is useful here. Lets load it first.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.5     v purrr   0.3.4
## v tibble  3.1.4     v dplyr   1.0.7
## v tidyr   1.1.3     v stringr 1.4.0
## v readr   2.0.1     v forcats 0.5.1
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

Now, lets say we want to \textbf{filter} the dataframe.

We can \textbf{arrange} the dataframe as we wish.
We can sort by just 1 column or more. In the latter case the second, third and so on variables will break the ties.
Missing values are sorted to the end.

Another useful trick is to \textbf{select} columns.
With this command we can select the columns we want, or do not want.

To create new columns, we can also use \textbf{mutate}. This a versatile command that allows you to do several things.
Here are a bunch of examples:

We can also create summaries of the data with the command \textbf{summarise()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species Sepal_Area
## 1          5.1         3.5          1.4         0.2  setosa       17.8
## 2          0.0         3.0          1.4         0.2  setosa       14.7
## 3          0.0         3.2          1.3         0.2  setosa       15.0
## 4          0.0         3.1          1.5         0.2  setosa       14.3
## 5          0.0         3.6          1.4         0.2  setosa       18.0
## 6          5.4         3.9          1.7         0.4  setosa       21.1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Summarising mean Sepatl.length by species}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# Grouping by this variable}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Mean\_By\_Species =} \FunctionTok{mean}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 2
##   Species    Mean_By_Species
##   <fct>                <dbl>
## 1 setosa                2.34
## 2 versicolor            5.64
## 3 virginica             6.49
\end{verbatim}

You can group by more than one factor and ask for other summaries, such as median, sd, and other basic operations. For instance:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{count =} \FunctionTok{n}\NormalTok{())  }\CommentTok{\# Gives you the number of entries in each group}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 2
##   Species    count
##   <fct>      <int>
## 1 setosa        50
## 2 versicolor    50
## 3 virginica     50
\end{verbatim}

You can then build operations on top of your summaries (like mutations or plots)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Mean\_Length =} \FunctionTok{mean}\NormalTok{(Sepal.Length)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(Species, Mean\_Length)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_col}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{_main_files/figure-latex/unnamed-chunk-20-1.pdf}

\hypertarget{missing-values}{%
\section{Missing Values}\label{missing-values}}

We have several ways of dealing with missing values \texttt{NA} (which mean ``Not Available'' by the way).
We can remove then, or omit them, depending on the situation. The important thing to note is that you ask R for certain commands. For instance, if you ask a mean of a column that contains \texttt{NA} the result will be \texttt{NA}. You can either a) specify \texttt{na.rm\ =\ TRUE} on the command (if the specific command allows you to do so), or just remove the \texttt{NA} values prior to running the command.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{Sepal.Length }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Sepal.Length)}
\CommentTok{\# Asking a mean with NA values}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Mean =} \FunctionTok{mean}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Mean
## 1   NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Removing NAs when asking the mean}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Mean =} \FunctionTok{mean}\NormalTok{(Sepal.Length, }\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Mean
## 1 4.822667
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Removing NAs then asking for the mean}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(Sepal.Length)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Mean =} \FunctionTok{mean}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Mean
## 1 4.822667
\end{verbatim}

\hypertarget{counts}{%
\section{Counts}\label{counts}}

Already mentioned above. Gives you the number of entries.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{count =} \FunctionTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 2
##   Species     count
##   <fct>       <int>
## 1 setosa         50
## 2 versicolor     50
## 3 virginica      50
## 4 new_species     1
\end{verbatim}

\hypertarget{ungrouping}{%
\section{Ungrouping}\label{ungrouping}}

Lastly, you can use \texttt{ungroup()} in a pipe to ungroup whay you've did.

See tidyverse book page 107 for Exploratory Data Analysis

  \bibliography{book.bib,packages.bib}

\end{document}
