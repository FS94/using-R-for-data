<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Basic Statistical Analysis | Usefulness of R for managing data</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
set in the _output.yml file.
The HTML output format for this example is bookdown::gitbook,</p>" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Basic Statistical Analysis | Usefulness of R for managing data" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
set in the _output.yml file.
The HTML output format for this example is bookdown::gitbook,</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Basic Statistical Analysis | Usefulness of R for managing data" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
set in the _output.yml file.
The HTML output format for this example is bookdown::gitbook,</p>" />
  

<meta name="author" content="Fábio A. Silva" />


<meta name="date" content="2023-02-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exploratory-data-analysis-eda.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>2</b> Basic R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-r.html"><a href="basic-r.html#note"><i class="fa fa-check"></i><b>2.1</b> Note</a></li>
<li class="chapter" data-level="2.2" data-path="basic-r.html"><a href="basic-r.html#what-is-r-and-rstudio"><i class="fa fa-check"></i><b>2.2</b> What is R and RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="basic-r.html"><a href="basic-r.html#why-r"><i class="fa fa-check"></i><b>2.3</b> Why R?</a></li>
<li class="chapter" data-level="2.4" data-path="basic-r.html"><a href="basic-r.html#where-to-get-it-and-how-to-run-it"><i class="fa fa-check"></i><b>2.4</b> Where to get it and how to run it</a></li>
<li class="chapter" data-level="2.5" data-path="basic-r.html"><a href="basic-r.html#environment"><i class="fa fa-check"></i><b>2.5</b> Environment</a></li>
<li class="chapter" data-level="2.6" data-path="basic-r.html"><a href="basic-r.html#scripts-notebooks-and-rmarkdown-and-projects"><i class="fa fa-check"></i><b>2.6</b> Scripts, Notebooks and RMarkdown (and Projects)</a></li>
<li class="chapter" data-level="2.7" data-path="basic-r.html"><a href="basic-r.html#working-directories"><i class="fa fa-check"></i><b>2.7</b> Working directories</a></li>
<li class="chapter" data-level="2.8" data-path="basic-r.html"><a href="basic-r.html#operators"><i class="fa fa-check"></i><b>2.8</b> Operators</a></li>
<li class="chapter" data-level="2.9" data-path="basic-r.html"><a href="basic-r.html#classes-types-and-structures"><i class="fa fa-check"></i><b>2.9</b> Classes, Types and Structures</a></li>
<li class="chapter" data-level="2.10" data-path="basic-r.html"><a href="basic-r.html#comments"><i class="fa fa-check"></i><b>2.10</b> Comments</a></li>
<li class="chapter" data-level="2.11" data-path="basic-r.html"><a href="basic-r.html#objects"><i class="fa fa-check"></i><b>2.11</b> Objects</a></li>
<li class="chapter" data-level="2.12" data-path="basic-r.html"><a href="basic-r.html#combinations"><i class="fa fa-check"></i><b>2.12</b> Combinations</a></li>
<li class="chapter" data-level="2.13" data-path="basic-r.html"><a href="basic-r.html#subsetting"><i class="fa fa-check"></i><b>2.13</b> Subsetting</a></li>
<li class="chapter" data-level="2.14" data-path="basic-r.html"><a href="basic-r.html#ifs-and-elses"><i class="fa fa-check"></i><b>2.14</b> Ifs and elses</a></li>
<li class="chapter" data-level="2.15" data-path="basic-r.html"><a href="basic-r.html#loops"><i class="fa fa-check"></i><b>2.15</b> Loops</a></li>
<li class="chapter" data-level="2.16" data-path="basic-r.html"><a href="basic-r.html#functions"><i class="fa fa-check"></i><b>2.16</b> Functions</a></li>
<li class="chapter" data-level="2.17" data-path="basic-r.html"><a href="basic-r.html#packages"><i class="fa fa-check"></i><b>2.17</b> Packages</a></li>
<li class="chapter" data-level="2.18" data-path="basic-r.html"><a href="basic-r.html#shortcuts"><i class="fa fa-check"></i><b>2.18</b> Shortcuts</a></li>
<li class="chapter" data-level="2.19" data-path="basic-r.html"><a href="basic-r.html#chunk-settings"><i class="fa fa-check"></i><b>2.19</b> Chunk settings</a></li>
<li class="chapter" data-level="2.20" data-path="basic-r.html"><a href="basic-r.html#code-completion"><i class="fa fa-check"></i><b>2.20</b> Code completion</a></li>
<li class="chapter" data-level="2.21" data-path="basic-r.html"><a href="basic-r.html#other-useful-features"><i class="fa fa-check"></i><b>2.21</b> Other useful features</a></li>
<li class="chapter" data-level="2.22" data-path="basic-r.html"><a href="basic-r.html#getting-help"><i class="fa fa-check"></i><b>2.22</b> Getting help</a></li>
<li class="chapter" data-level="2.23" data-path="basic-r.html"><a href="basic-r.html#using-ai-to-help-you"><i class="fa fa-check"></i><b>2.23</b> Using AI to help you</a></li>
<li class="chapter" data-level="2.24" data-path="basic-r.html"><a href="basic-r.html#further-reading"><i class="fa fa-check"></i><b>2.24</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html"><i class="fa fa-check"></i><b>3</b> R - Dealing with data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#opening-files"><i class="fa fa-check"></i><b>3.1</b> Opening files</a></li>
<li class="chapter" data-level="3.2" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#opening-multiple-files"><i class="fa fa-check"></i><b>3.2</b> Opening multiple files</a></li>
<li class="chapter" data-level="3.3" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#merging"><i class="fa fa-check"></i><b>3.3</b> Merging</a></li>
<li class="chapter" data-level="3.4" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#exporting"><i class="fa fa-check"></i><b>3.4</b> Exporting</a></li>
<li class="chapter" data-level="3.5" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#special-cases-in-r"><i class="fa fa-check"></i><b>3.5</b> Special cases in R</a></li>
<li class="chapter" data-level="3.6" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#manipulating-the-data-in-dataframes"><i class="fa fa-check"></i><b>3.6</b> Manipulating the data in dataframes</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#subsetting-a-dataframe"><i class="fa fa-check"></i><b>3.6.1</b> Subsetting a dataframe</a></li>
<li class="chapter" data-level="3.6.2" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#columns"><i class="fa fa-check"></i><b>3.6.2</b> Columns</a></li>
<li class="chapter" data-level="3.6.3" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#rows"><i class="fa fa-check"></i><b>3.6.3</b> Rows</a></li>
<li class="chapter" data-level="3.6.4" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#tidyverse-pipes"><i class="fa fa-check"></i><b>3.6.4</b> Tidyverse &amp; Pipes</a></li>
<li class="chapter" data-level="3.6.5" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#filtering"><i class="fa fa-check"></i><b>3.6.5</b> Filtering</a></li>
<li class="chapter" data-level="3.6.6" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#arranging"><i class="fa fa-check"></i><b>3.6.6</b> Arranging</a></li>
<li class="chapter" data-level="3.6.7" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#selecting"><i class="fa fa-check"></i><b>3.6.7</b> Selecting</a></li>
<li class="chapter" data-level="3.6.8" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#mutating"><i class="fa fa-check"></i><b>3.6.8</b> Mutating</a></li>
<li class="chapter" data-level="3.6.9" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#ifelse"><i class="fa fa-check"></i><b>3.6.9</b> Ifelse</a></li>
<li class="chapter" data-level="3.6.10" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#grouping-and-summarizing"><i class="fa fa-check"></i><b>3.6.10</b> Grouping and Summarizing</a></li>
<li class="chapter" data-level="3.6.11" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#changing-format-widelong"><i class="fa fa-check"></i><b>3.6.11</b> Changing Format (Wide/Long)</a></li>
<li class="chapter" data-level="3.6.12" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#missing-values"><i class="fa fa-check"></i><b>3.6.12</b> Missing Values</a></li>
<li class="chapter" data-level="3.6.13" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#counts"><i class="fa fa-check"></i><b>3.6.13</b> Counts</a></li>
<li class="chapter" data-level="3.6.14" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#ungrouping"><i class="fa fa-check"></i><b>3.6.14</b> Ungrouping</a></li>
<li class="chapter" data-level="3.6.15" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#stringscharacters"><i class="fa fa-check"></i><b>3.6.15</b> Strings/Characters</a></li>
<li class="chapter" data-level="3.6.16" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#splits"><i class="fa fa-check"></i><b>3.6.16</b> Splits</a></li>
<li class="chapter" data-level="3.6.17" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#mapping"><i class="fa fa-check"></i><b>3.6.17</b> Mapping</a></li>
<li class="chapter" data-level="3.6.18" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#nesting"><i class="fa fa-check"></i><b>3.6.18</b> Nesting</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="r---dealing-with-data.html"><a href="r---dealing-with-data.html#end"><i class="fa fa-check"></i><b>3.7</b> End</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html"><i class="fa fa-check"></i><b>4</b> Exploratory Data Analysis (EDA)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#loading-data"><i class="fa fa-check"></i><b>4.1</b> Loading data</a></li>
<li class="chapter" data-level="4.2" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#checking-data"><i class="fa fa-check"></i><b>4.2</b> Checking data</a></li>
<li class="chapter" data-level="4.3" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#cleaning"><i class="fa fa-check"></i><b>4.3</b> Cleaning</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#cleaning-col.-names"><i class="fa fa-check"></i><b>4.3.1</b> Cleaning col. names</a></li>
<li class="chapter" data-level="4.3.2" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#date"><i class="fa fa-check"></i><b>4.3.2</b> Date</a></li>
<li class="chapter" data-level="4.3.3" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#cleaning-some-columns"><i class="fa fa-check"></i><b>4.3.3</b> Cleaning some columns</a></li>
<li class="chapter" data-level="4.3.4" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#dealing-with-na-values"><i class="fa fa-check"></i><b>4.3.4</b> Dealing with NA values</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#summarising"><i class="fa fa-check"></i><b>4.4</b> Summarising</a></li>
<li class="chapter" data-level="4.5" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#plots"><i class="fa fa-check"></i><b>4.5</b> Plots</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#formula"><i class="fa fa-check"></i><b>4.5.1</b> Formula</a></li>
<li class="chapter" data-level="4.5.2" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#cols-and-bars"><i class="fa fa-check"></i><b>4.5.2</b> Cols and Bars</a></li>
<li class="chapter" data-level="4.5.3" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#boxplots"><i class="fa fa-check"></i><b>4.5.3</b> Boxplots</a></li>
<li class="chapter" data-level="4.5.4" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#density"><i class="fa fa-check"></i><b>4.5.4</b> Density</a></li>
<li class="chapter" data-level="4.5.5" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#facets"><i class="fa fa-check"></i><b>4.5.5</b> Facets</a></li>
<li class="chapter" data-level="4.5.6" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#coord-flip"><i class="fa fa-check"></i><b>4.5.6</b> Coord flip</a></li>
<li class="chapter" data-level="4.5.7" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#correlation-plots"><i class="fa fa-check"></i><b>4.5.7</b> Correlation plots</a></li>
<li class="chapter" data-level="4.5.8" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#multiplots"><i class="fa fa-check"></i><b>4.5.8</b> Multiplots</a></li>
<li class="chapter" data-level="4.5.9" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#date-1"><i class="fa fa-check"></i><b>4.5.9</b> Date</a></li>
<li class="chapter" data-level="4.5.10" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#ordering-factors"><i class="fa fa-check"></i><b>4.5.10</b> Ordering factors</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#end-1"><i class="fa fa-check"></i><b>4.6</b> End</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html"><i class="fa fa-check"></i><b>5</b> Basic Statistical Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#correlations"><i class="fa fa-check"></i><b>5.1</b> Correlations</a></li>
<li class="chapter" data-level="5.2" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#linear-regressions"><i class="fa fa-check"></i><b>5.2</b> Linear Regressions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#t-tests"><i class="fa fa-check"></i><b>5.2.1</b> T-tests</a></li>
<li class="chapter" data-level="5.2.2" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#anovas"><i class="fa fa-check"></i><b>5.2.2</b> Anovas</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#generalized-linear-regression"><i class="fa fa-check"></i><b>5.3</b> Generalized Linear Regression</a></li>
<li class="chapter" data-level="5.4" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#linear-mixed-models"><i class="fa fa-check"></i><b>5.4</b> Linear Mixed Models</a></li>
<li class="chapter" data-level="5.5" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#generalized-linear-mixed-models"><i class="fa fa-check"></i><b>5.5</b> Generalized Linear Mixed Models</a></li>
<li class="chapter" data-level="5.6" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#bayesian-analysis"><i class="fa fa-check"></i><b>5.6</b> Bayesian analysis</a></li>
<li class="chapter" data-level="5.7" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#time-series"><i class="fa fa-check"></i><b>5.7</b> Time series</a></li>
<li class="chapter" data-level="5.8" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#drift-difussion-modelling"><i class="fa fa-check"></i><b>5.8</b> Drift difussion modelling</a></li>
<li class="chapter" data-level="5.9" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#survival-analysis"><i class="fa fa-check"></i><b>5.9</b> Survival analysis</a></li>
<li class="chapter" data-level="5.10" data-path="basic-statistical-analysis.html"><a href="basic-statistical-analysis.html#end-2"><i class="fa fa-check"></i><b>5.10</b> End</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Usefulness of R for managing data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-statistical-analysis" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Basic Statistical Analysis<a href="basic-statistical-analysis.html#basic-statistical-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter we will perform some basic statistical analyses on several distinct data sets. These analyses are just some examples that should get you going. The point here is to show you the syntax adopted by most analyses-related functions as well as to demonstrate how you need to prepare data, what the output looks like, etc.. Everything you will see will pretty much be the action part of the analysis plan, and not the whole exploration and full comprehension of the data that should precede any analysis. I will not be discussing the output of each analysis, only how to perform them. That latter part will be up to you, since you already have the know-how on how to read, wrangle, describe and visualize your data (Chapter 1, 2 and 3).<br />
Thus, this is by no means a detailed guide on how to analyse data. That would require an entire book on itself. So remember, this is just a “demo” and not the entire game. I will make sure, however, to leave some references for each topic if you are interested in better understanding and applying these analyses methods yourself. At the end you will have some more general recommendations for a full “intro to analysis with R” type of books/guides.<br />
</p>
<p><strong>Disclaimer</strong>: I am not (by no means) a statistical expert, and some of the explanations used here, albeit brief and simple, might oversimplify or even outright give you a wrong idea about the analysis. I advise you to carefully read about the analysis you plan to perform and not just rely on this guide for that purpose.</p>
<p>Now, why use R? Why not just manipulate the data however you like and then save it as a “.csv” and read it in SPSS (or any other statistical analysis program). Well, there are several reasons…</p>
<ul>
<li><p><em>1</em>: It does not cut your workflow.<br />
</p></li>
<li><p><em>2</em>: It records every step you take in the analysis.<br />
</p></li>
<li><p><em>3</em>: It provides a sharable report for others to see and execute the code themselves.<br />
</p></li>
<li><p><em>4</em>: It has more (way more) ways for you to analyze data.<br />
</p></li>
<li><p><em>5</em>: It makes you understand (at least a bit more) what you are doing.<br />
</p></li>
</ul>
<div id="correlations" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Correlations<a href="basic-statistical-analysis.html#correlations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Correlations tests, as you might already know, measure covariance between variables (strength of association), indicating if there is a positive or negative relationship between them.</p>
<p>There are several types, but I will focus here on the two (well three) most common ones:</p>
<ul>
<li><p><em>Pearson r correlation (Parametric)</em>: Measures the linear dependence between two variables (x and y).<br />
</p></li>
<li><p><em>Spearman rho AND Kendall tau correlation (Non-parametric)</em>: Computes the correlation between the rankings of variable x and y.<br />
</p></li>
</ul>
<p>There are several built-in commands/functions to perform correlations in R. These are <code>cor()</code>, <code>cor.test()</code>. There are slight differences between them, since <code>cor()</code> does not provide any p-values, but works for multiple comparisons, and <code>cor.test()</code> provides p-values, but does not work for multiple comparisons. There are definitely more functions to calculate different correlation indexes and with more features, but these are the simpler ones and do not require you to install any package to perform them.</p>
<p>To show off some examples of correlation, we will use a data set “Ginzberg” from the <code>carData</code> package, which containing data about psychiatric patients hospitalized with depression.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="basic-statistical-analysis.html#cb227-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(carData<span class="sc">::</span>Ginzberg)</span>
<span id="cb227-2"><a href="basic-statistical-analysis.html#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="basic-statistical-analysis.html#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   simplicity fatalism depression adjsimp adjfatal adjdep
##        &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1      0.930   0.356       0.599   0.759   0.107   0.419
## 2      0.911   1.18        0.728   0.727   0.999   0.517
## 3      0.534  -0.0584      0.534   0.622   0.0381  0.707
## 4      0.741   0.356       0.566   0.835   0.422   0.656
## 5      0.534   0.770       0.502   0.477   0.814   0.535
## 6      0.628   1.39        0.566   0.407   1.23    0.340</code></pre>
<p>We can choose to selectively correlate two variables, like for instance fatalism with depression</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="basic-statistical-analysis.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb229-2"><a href="basic-statistical-analysis.html#cb229-2" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb229-3"><a href="basic-statistical-analysis.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(fatalism, depression)) <span class="sc">+</span> </span>
<span id="cb229-4"><a href="basic-statistical-analysis.html#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb229-5"><a href="basic-statistical-analysis.html#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">formula =</span> <span class="st">&#39;y ~ x&#39;</span>)</span></code></pre></div>
<p><img src="using_r_data_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="basic-statistical-analysis.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation test</span></span>
<span id="cb230-2"><a href="basic-statistical-analysis.html#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d<span class="sc">$</span>fatalism, d<span class="sc">$</span>depression)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  d$fatalism and d$depression
## t = 7.8024, df = 80, p-value = 1.97e-11
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.5136315 0.7652141
## sample estimates:
##       cor 
## 0.6573674</code></pre>
<p>Alternatively we can quickly explor all correlations within a data set</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="basic-statistical-analysis.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple descripite measure</span></span>
<span id="cb232-2"><a href="basic-statistical-analysis.html#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(d[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span></code></pre></div>
<pre><code>##            simplicity  fatalism depression   adjsimp  adjfatal    adjdep
## simplicity  1.0000000 0.6312820  0.6432668 0.8828320 0.4739231 0.5055916
## fatalism    0.6312820 1.0000000  0.6573674 0.4762675 0.8871990 0.5155501
## depression  0.6432668 0.6573674  1.0000000 0.5240324 0.5317250 0.9150317
## adjsimp     0.8828320 0.4762675  0.5240324 1.0000000 0.5368211 0.5726930
## adjfatal    0.4739231 0.8871990  0.5317250 0.5368211 1.0000000 0.5810994
## adjdep      0.5055916 0.5155501  0.9150317 0.5726930 0.5810994 1.0000000</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="basic-statistical-analysis.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple graphic version</span></span>
<span id="cb234-2"><a href="basic-statistical-analysis.html#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(d)</span></code></pre></div>
<p><img src="using_r_data_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="basic-statistical-analysis.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># More elaborate version</span></span>
<span id="cb235-2"><a href="basic-statistical-analysis.html#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb235-3"><a href="basic-statistical-analysis.html#cb235-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(d)</span></code></pre></div>
<p><img src="using_r_data_files/figure-html/unnamed-chunk-113-2.png" width="672" /></p>
<p>You can also split the correlation by groups. Here’s how.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="basic-statistical-analysis.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a generic group variable</span></span>
<span id="cb236-2"><a href="basic-statistical-analysis.html#cb236-2" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>), <span class="fu">nrow</span>(d), <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb236-3"><a href="basic-statistical-analysis.html#cb236-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>group <span class="ot">&lt;-</span> group</span>
<span id="cb236-4"><a href="basic-statistical-analysis.html#cb236-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-5"><a href="basic-statistical-analysis.html#cb236-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-6"><a href="basic-statistical-analysis.html#cb236-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation plots</span></span>
<span id="cb236-7"><a href="basic-statistical-analysis.html#cb236-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(d[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">7</span>)], </span>
<span id="cb236-8"><a href="basic-statistical-analysis.html#cb236-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color =</span> group))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="using_r_data_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
<p>Lastly, we can correlate all other variables with one of our choosing.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="basic-statistical-analysis.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Naming cols</span></span>
<span id="cb238-2"><a href="basic-statistical-analysis.html#cb238-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(d)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span>
<span id="cb238-3"><a href="basic-statistical-analysis.html#cb238-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-4"><a href="basic-statistical-analysis.html#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="co"># d to dataframe (cor.test is picky)</span></span>
<span id="cb238-5"><a href="basic-statistical-analysis.html#cb238-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(d)</span>
<span id="cb238-6"><a href="basic-statistical-analysis.html#cb238-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-7"><a href="basic-statistical-analysis.html#cb238-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over all combinations</span></span>
<span id="cb238-8"><a href="basic-statistical-analysis.html#cb238-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> cols){</span>
<span id="cb238-9"><a href="basic-statistical-analysis.html#cb238-9" aria-hidden="true" tabindex="-1"></a>  cor <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">cor.test</span>(d<span class="sc">$</span>depression, d[, col]))</span>
<span id="cb238-10"><a href="basic-statistical-analysis.html#cb238-10" aria-hidden="true" tabindex="-1"></a>  cor_value <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(cor[<span class="dv">4</span>]), <span class="dv">3</span>)</span>
<span id="cb238-11"><a href="basic-statistical-analysis.html#cb238-11" aria-hidden="true" tabindex="-1"></a>  cor_pvalue <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(cor[<span class="dv">3</span>]), <span class="dv">3</span>)</span>
<span id="cb238-12"><a href="basic-statistical-analysis.html#cb238-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb238-13"><a href="basic-statistical-analysis.html#cb238-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (cor_pvalue <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb238-14"><a href="basic-statistical-analysis.html#cb238-14" aria-hidden="true" tabindex="-1"></a>    cor_pvalue <span class="ot">=</span> <span class="st">&#39;&lt;0.001&#39;</span></span>
<span id="cb238-15"><a href="basic-statistical-analysis.html#cb238-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb238-16"><a href="basic-statistical-analysis.html#cb238-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb238-17"><a href="basic-statistical-analysis.html#cb238-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">Correlation between Depression and&#39;</span>, col, <span class="st">&#39;: &#39;</span>, cor_value, <span class="st">&#39;, with p-value:&#39;</span>, cor_pvalue)</span>
<span id="cb238-18"><a href="basic-statistical-analysis.html#cb238-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Correlation between Depression and simplicity :  0.643 , with p-value: &lt;0.001
## Correlation between Depression and fatalism :  0.657 , with p-value: &lt;0.001
## Correlation between Depression and adjsimp :  0.524 , with p-value: &lt;0.001
## Correlation between Depression and adjfatal :  0.532 , with p-value: &lt;0.001
## Correlation between Depression and adjdep :  0.915 , with p-value: &lt;0.001</code></pre>
<p>Now all of the correlation we have seen so far have been between two continuous variables, and we thus always employed a Pearson correlation test. To perform other correlations, just choose which method you want with the <code>method</code> argument inside the <code>cor.test()</code> function. You can choose between “pearson” (default), “kendall” or “spearman”.<br />
</p>
<p>For more information about correlations in R I recommend you read the following:<br />
- www.sthda.com/english/wiki/correlation-test-between-two-variables-in-r<br />
- <a href="https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/#for-2-variables" class="uri">https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/#for-2-variables</a></p>
</div>
<div id="linear-regressions" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Linear Regressions<a href="basic-statistical-analysis.html#linear-regressions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So linear regression (LR) are a statistical method used to model a relationship between a <strong>dependent (outcome) variable</strong> and <strong>independent (predictors) variables</strong> by fitting a linear equation to the observed data. We can use it to study understand the relationship between these variables or predict future (yet unobserved) values.<br />
The basic syntax for LR in R is as follows: <code>lm(y ~ x, data = d)</code>. <code>lm</code> stands for linear model. <code>y</code> will be our outcome variable and <code>x</code> our predictor. You can interpret <code>~</code> here and in the following analysis as “predicted by”.</p>
<p>Lets look at a couple of examples. To do this we are going to load the data “Soils” from the <code>carData</code> package. This data concerns soil characteristics measured on samples. We will assume “pH” is our outcome/dependent variable.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="basic-statistical-analysis.html#cb240-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> carData<span class="sc">::</span>Soils</span>
<span id="cb240-2"><a href="basic-statistical-analysis.html#cb240-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-3"><a href="basic-statistical-analysis.html#cb240-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(pH <span class="sc">~</span> Depth, <span class="at">data =</span> d)</span>
<span id="cb240-4"><a href="basic-statistical-analysis.html#cb240-4" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pH ~ Depth, data = d)
## 
## Coefficients:
## (Intercept)   Depth10-30   Depth30-60   Depth60-90  
##      5.3975      -0.3933      -1.1192      -1.4000</code></pre>
<p>Now if you call the model you created (here labeled as “m”) it prints only a very small output with the coefficients of the equation only. You can get a more detailed view of everything using the command <code>summary()</code> or something more concise with <code>anova()</code> or <code>car::Anova()</code>.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="basic-statistical-analysis.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pH ~ Depth, data = d)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.54417 -0.23250 -0.08083  0.15500  1.66583 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.3975     0.1089  49.585  &lt; 2e-16 ***
## Depth10-30   -0.3933     0.1539  -2.555   0.0142 *  
## Depth30-60   -1.1192     0.1539  -7.270 4.60e-09 ***
## Depth60-90   -1.4000     0.1539  -9.094 1.15e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3771 on 44 degrees of freedom
## Multiple R-squared:  0.7051, Adjusted R-squared:  0.685 
## F-statistic: 35.07 on 3 and 44 DF,  p-value: 9.811e-12</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="basic-statistical-analysis.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: pH
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## Depth      3 14.9590  4.9863  35.068 9.811e-12 ***
## Residuals 44  6.2563  0.1422                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="basic-statistical-analysis.html#cb246-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m)</span></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: pH
##            Sum Sq Df F value    Pr(&gt;F)    
## Depth     14.9590  3  35.068 9.811e-12 ***
## Residuals  6.2563 44                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Now its not the focus of this book to explain all the content of the output. If you ever performed a similar analysis in SPSS then you should, by looking careful, finding everything you need.</p>
<p>Now, linear regression has a few assumptions that you probably would like to assure. These are:</p>
<p>1 - <em>Linearity</em>: The relationship between the independent and dependent variables is linear.
2 - <em>Independence</em>: The observations are independent of each other.
3 - <em>Homoscedasticity</em>: The variance of the errors is constant across all levels of the independent variable(s)
4 - <em>Normality</em>: The errors are normally distributed.
5 - <em>Independence of errors</em>: The errors are independent of the independent variable(s)</p>
<p>Again, these are beside the point of the guide, but if you want to check them, here is a quick way around a few of the most pertinent points.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="basic-statistical-analysis.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Homoscedasticity </span></span>
<span id="cb248-2"><a href="basic-statistical-analysis.html#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m<span class="sc">$</span>residuals <span class="sc">~</span> m<span class="sc">$</span>fitted.values)</span></code></pre></div>
<p><img src="using_r_data_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="basic-statistical-analysis.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Or with ggplot</span></span>
<span id="cb249-2"><a href="basic-statistical-analysis.html#cb249-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(m<span class="sc">$</span>residuals, m<span class="sc">$</span>fitted.values)</span>
<span id="cb249-3"><a href="basic-statistical-analysis.html#cb249-3" aria-hidden="true" tabindex="-1"></a>t <span class="sc">%&gt;%</span> </span>
<span id="cb249-4"><a href="basic-statistical-analysis.html#cb249-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(m.fitted.values, m.residuals)) <span class="sc">+</span></span>
<span id="cb249-5"><a href="basic-statistical-analysis.html#cb249-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="using_r_data_files/figure-html/unnamed-chunk-118-2.png" width="672" /></p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="basic-statistical-analysis.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normality</span></span>
<span id="cb250-2"><a href="basic-statistical-analysis.html#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(m<span class="sc">$</span>residuals))</span></code></pre></div>
<p><img src="using_r_data_files/figure-html/unnamed-chunk-118-3.png" width="672" /></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="basic-statistical-analysis.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Or with ggplot</span></span>
<span id="cb251-2"><a href="basic-statistical-analysis.html#cb251-2" aria-hidden="true" tabindex="-1"></a>t <span class="sc">%&gt;%</span> </span>
<span id="cb251-3"><a href="basic-statistical-analysis.html#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(m.residuals)) <span class="sc">+</span></span>
<span id="cb251-4"><a href="basic-statistical-analysis.html#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="using_r_data_files/figure-html/unnamed-chunk-118-4.png" width="672" /></p>
<p>With your model you can then make predictions, of course. To do this you use the command <code>predict</code>. Lets create a different model first with a continuous predictor</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="basic-statistical-analysis.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New model</span></span>
<span id="cb252-2"><a href="basic-statistical-analysis.html#cb252-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(pH <span class="sc">~</span> Na, <span class="at">data =</span> d)</span>
<span id="cb252-3"><a href="basic-statistical-analysis.html#cb252-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-4"><a href="basic-statistical-analysis.html#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a data frame with several predictor variables we wish to now the predictions too.</span></span>
<span id="cb252-5"><a href="basic-statistical-analysis.html#cb252-5" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Na =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">3.5</span>, <span class="dv">7</span>, <span class="fl">8.2</span>, <span class="dv">10</span>))</span>
<span id="cb252-6"><a href="basic-statistical-analysis.html#cb252-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-7"><a href="basic-statistical-analysis.html#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicting</span></span>
<span id="cb252-8"><a href="basic-statistical-analysis.html#cb252-8" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m, pd)</span></code></pre></div>
<pre><code>##        1        2        3        4        5 
## 5.320747 4.966709 4.471054 4.301116 4.046208</code></pre>
<p>Lastly, lets plot our model.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="basic-statistical-analysis.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a dummy range of Na values.</span></span>
<span id="cb254-2"><a href="basic-statistical-analysis.html#cb254-2" aria-hidden="true" tabindex="-1"></a>na_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">range</span>(d<span class="sc">$</span>Na)[<span class="dv">1</span>], <span class="fu">range</span>(d<span class="sc">$</span>Na)[<span class="dv">2</span>], <span class="fl">0.5</span>)</span>
<span id="cb254-3"><a href="basic-statistical-analysis.html#cb254-3" aria-hidden="true" tabindex="-1"></a>plt_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Na =</span> na_values)</span>
<span id="cb254-4"><a href="basic-statistical-analysis.html#cb254-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-5"><a href="basic-statistical-analysis.html#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating predictions with prediction confidence intervals</span></span>
<span id="cb254-6"><a href="basic-statistical-analysis.html#cb254-6" aria-hidden="true" tabindex="-1"></a>plt_data<span class="sc">$</span>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, plt_data, <span class="at">se.fit =</span> <span class="cn">TRUE</span>, <span class="at">interval =</span> <span class="st">&#39;prediction&#39;</span>, <span class="at">level =</span> .<span class="dv">95</span>)<span class="sc">$</span>fit[, <span class="dv">1</span>]</span>
<span id="cb254-7"><a href="basic-statistical-analysis.html#cb254-7" aria-hidden="true" tabindex="-1"></a>plt_data<span class="sc">$</span>lwr <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, plt_data, <span class="at">se.fit =</span> <span class="cn">TRUE</span>, <span class="at">interval =</span> <span class="st">&#39;prediction&#39;</span>, <span class="at">level =</span> .<span class="dv">95</span>)<span class="sc">$</span>fit[, <span class="dv">2</span>]</span>
<span id="cb254-8"><a href="basic-statistical-analysis.html#cb254-8" aria-hidden="true" tabindex="-1"></a>plt_data<span class="sc">$</span>upr <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, plt_data, <span class="at">se.fit =</span> <span class="cn">TRUE</span>, <span class="at">interval =</span> <span class="st">&#39;prediction&#39;</span>, <span class="at">level =</span> .<span class="dv">95</span>)<span class="sc">$</span>fit[, <span class="dv">3</span>]</span>
<span id="cb254-9"><a href="basic-statistical-analysis.html#cb254-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-10"><a href="basic-statistical-analysis.html#cb254-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb254-11"><a href="basic-statistical-analysis.html#cb254-11" aria-hidden="true" tabindex="-1"></a>plt_data <span class="sc">%&gt;%</span> </span>
<span id="cb254-12"><a href="basic-statistical-analysis.html#cb254-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Na, predictions)) <span class="sc">+</span></span>
<span id="cb254-13"><a href="basic-statistical-analysis.html#cb254-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb254-14"><a href="basic-statistical-analysis.html#cb254-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb254-15"><a href="basic-statistical-analysis.html#cb254-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb254-16"><a href="basic-statistical-analysis.html#cb254-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">8</span>))</span></code></pre></div>
<p><img src="using_r_data_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<p>Linear regressions are one of the fundamental pillars of statistics. Nearly all statistical analyses are variations of linear regressions. I encourage you to truly understand them as it will give you more confidence when trying to perform any of the analyses shown below. Here are a few resources:<br />
</p>
<ul>
<li><a href="https://www.spiceworks.com/tech/artificial-intelligence/articles/what-is-linear-regression/" class="uri">https://www.spiceworks.com/tech/artificial-intelligence/articles/what-is-linear-regression/</a> (Just on linear regression)<br />
</li>
<li><a href="https://www.datacamp.com/tutorial/linear-regression-R" class="uri">https://www.datacamp.com/tutorial/linear-regression-R</a><br />
</li>
<li><a href="https://www.tutorialspoint.com/r/r_linear_regression.htm" class="uri">https://www.tutorialspoint.com/r/r_linear_regression.htm</a></li>
</ul>
<div id="t-tests" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> T-tests<a href="basic-statistical-analysis.html#t-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>T-tests, used two compare two samples, are also easily done with just base R.
You have the following options:</p>
<ul>
<li><p>One sample (for, as an example, a mean of 2)
<code>t.test(y, mu = 2)</code></p></li>
<li><p>Independent samples (samples not related to each other)
<code>t.test(y ~ x)</code> (Syntax wide)
<code>t.test(y1, y2)</code> (Syntax long)</p></li>
<li><p>Paired samples (samples related in some way to each other - e.g., from the same ID but different conditions)
<code>t.test(y1, y2, paired=TRUE)</code></p></li>
</ul>
<p>Lets proceed to some basic examples with the Soils data set from the <code>carData</code> package. This data set depicts soil characteristics that were measured on sample from three types of contours and four depths. The area was also divided into four blocks.</p>
<p>Needless to say the assumptions of the linear regression also hold for the t-tests and ANOVAs, so you should check them out first. But, for the purpose of demonstration, lets skip this and get to the point.</p>
<p>So one question, even if it doesn’t entirely makes sense (or at all), is if Density of the samples
is different from 1.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="basic-statistical-analysis.html#cb255-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> carData<span class="sc">::</span>Soils</span>
<span id="cb255-2"><a href="basic-statistical-analysis.html#cb255-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-3"><a href="basic-statistical-analysis.html#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(d<span class="sc">$</span>Dens, <span class="at">mu =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  d$Dens
## t = 9.9572, df = 47, p-value = 3.678e-13
## alternative hypothesis: true mean is not equal to 1
## 95 percent confidence interval:
##  1.252023 1.379644
## sample estimates:
## mean of x 
##  1.315833</code></pre>
<p>Now, we may want to know if a Top contour is different from a Slope contour in terms of pH values.
For that we can use a independent-sample t-test. As I showed above, you can use two different syntaxes, with the result, of course, being exactly the same. The choice of syntax usually depends on how your data is structured. If in a long format (such as in this data set) we usually just use the second type of syntax (<code>t.test(y1, y2)</code>). If in a wide format we typically use the first syntax (<code>y ~ x</code>). Still, as long as you prepare your data, you can use whatever format you want.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="basic-statistical-analysis.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax wide</span></span>
<span id="cb257-2"><a href="basic-statistical-analysis.html#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(d[d<span class="sc">$</span>Contour <span class="sc">==</span> <span class="st">&#39;Top&#39;</span>, <span class="st">&#39;pH&#39;</span>], d[d<span class="sc">$</span>Contour <span class="sc">==</span> <span class="st">&#39;Slope&#39;</span>, <span class="st">&#39;pH&#39;</span>])</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  d[d$Contour == &quot;Top&quot;, &quot;pH&quot;] and d[d$Contour == &quot;Slope&quot;, &quot;pH&quot;]
## t = -0.67156, df = 27.412, p-value = 0.5075
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.7143742  0.3618742
## sample estimates:
## mean of x mean of y 
##   4.57000   4.74625</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="basic-statistical-analysis.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax long</span></span>
<span id="cb259-2"><a href="basic-statistical-analysis.html#cb259-2" aria-hidden="true" tabindex="-1"></a>d_test <span class="ot">&lt;-</span> d[d<span class="sc">$</span>Contour <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;Top&#39;</span>, <span class="st">&#39;Slope&#39;</span>),]  <span class="co"># subsetting the data with these two types of contour</span></span>
<span id="cb259-3"><a href="basic-statistical-analysis.html#cb259-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(pH <span class="sc">~</span> Contour, <span class="at">data =</span> d_test)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  pH by Contour
## t = 0.67156, df = 27.412, p-value = 0.5075
## alternative hypothesis: true difference in means between group Slope and group Top is not equal to 0
## 95 percent confidence interval:
##  -0.3618742  0.7143742
## sample estimates:
## mean in group Slope   mean in group Top 
##             4.74625             4.57000</code></pre>
<p>Now all of these were examples of <strong>independent</strong> t-tests. To do a <strong>paired-samples (dependent)</strong> t-test you just have to use <code>paired = TRUE</code> within the function.
Now the data we used is not dependent/related in any manner. As such, lets use a different data set that features dependent/paired data. For this we will use the data set “ChickWeight” that is pre-installed in R. This data describes how time impact the weight gain by chickens considering different diets. Although the type of diet is not paired (only one diet is explored per chicken) the time intervals are measured per chick (each chicken is measured across several time intervals). We are going to work only with the first and second time measurements.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="basic-statistical-analysis.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading our data frame</span></span>
<span id="cb261-2"><a href="basic-statistical-analysis.html#cb261-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> ChickWeight</span>
<span id="cb261-3"><a href="basic-statistical-analysis.html#cb261-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-4"><a href="basic-statistical-analysis.html#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Messing up with the data so that we can work on a simple example</span></span>
<span id="cb261-5"><a href="basic-statistical-analysis.html#cb261-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb261-6"><a href="basic-statistical-analysis.html#cb261-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Time <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> Time <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb261-7"><a href="basic-statistical-analysis.html#cb261-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">ifelse</span>(Time <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&#39;InitialEvaluation&#39;</span>, <span class="st">&#39;FinalEvaluation&#39;</span>)) </span>
<span id="cb261-8"><a href="basic-statistical-analysis.html#cb261-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-9"><a href="basic-statistical-analysis.html#cb261-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>## Grouped Data: weight ~ Time | Chick
##   weight              Time Chick Diet
## 1     42 InitialEvaluation     1    1
## 2     51   FinalEvaluation     1    1
## 3     40 InitialEvaluation     2    1
## 4     49   FinalEvaluation     2    1
## 5     43 InitialEvaluation     3    1
## 6     39   FinalEvaluation     3    1</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="basic-statistical-analysis.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(weight <span class="sc">~</span> Time, <span class="at">data =</span> d, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  weight by Time
## t = 15.907, df = 49, p-value &lt; 2.2e-16
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##  7.129123 9.190877
## sample estimates:
## mean difference 
##            8.16</code></pre>
</div>
<div id="anovas" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Anovas<a href="basic-statistical-analysis.html#anovas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>(Very) Simply put, ANOVAs are used to compare groups with more than two-levels. So previously in the t-test examples we only compared two-groups. Either 1 level against a mean value, or two levels between themselves.
Now, if we want to assess if the type of contour differs in their pH level we can simply perform an anova. There are definitely more ways to perform ANOVAs, but for sake of brevity, I’ll just leave with the <code>aov()</code> way.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="basic-statistical-analysis.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading our data frame</span></span>
<span id="cb265-2"><a href="basic-statistical-analysis.html#cb265-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> carData<span class="sc">::</span>Soils</span>
<span id="cb265-3"><a href="basic-statistical-analysis.html#cb265-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-4"><a href="basic-statistical-analysis.html#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysis</span></span>
<span id="cb265-5"><a href="basic-statistical-analysis.html#cb265-5" aria-hidden="true" tabindex="-1"></a>oneway_anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(pH <span class="sc">~</span> Contour, <span class="at">data =</span> d)</span>
<span id="cb265-6"><a href="basic-statistical-analysis.html#cb265-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(oneway_anova)  <span class="co"># asks for the summary</span></span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## Contour      2  0.261  0.1303    0.28  0.757
## Residuals   45 20.955  0.4657</code></pre>
<p>Once more, we performed a one-way (Just 1 factor, which in this case is Contour) independent sample anova. To perform two-way or even more, we could just add more factors such as <code>aov(y ~ factor1 + factor2, data = d)</code>. Let me exemplify below so I can also you show how you test for interaction between factors in a two-way ANOVA.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="basic-statistical-analysis.html#cb267-1" aria-hidden="true" tabindex="-1"></a>twoway_anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(pH <span class="sc">~</span> Contour<span class="sc">*</span>Block, <span class="at">data =</span> d)</span>
<span id="cb267-2"><a href="basic-statistical-analysis.html#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(twoway_anova)</span></code></pre></div>
<pre><code>##               Df Sum Sq Mean Sq F value Pr(&gt;F)
## Contour        2  0.261  0.1303   0.274  0.762
## Block          3  1.232  0.4108   0.862  0.470
## Contour:Block  6  2.568  0.4280   0.898  0.507
## Residuals     36 17.154  0.4765</code></pre>
<p>The <code>*</code> between the two factors, signifies “interaction”.</p>
<p>Lastly, you may want to perform a paired samples ANOVA. In this case you can’t simply say <code>paired = TRUE</code>. Here you need a different function. I’m going to introduce you two new ways to perform a repeated-measures (or independent) ANOVA.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="basic-statistical-analysis.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)  <span class="co"># for anova_test()</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;rstatix&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="basic-statistical-analysis.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ez)  <span class="co"># for the ezANOVA()</span></span>
<span id="cb272-2"><a href="basic-statistical-analysis.html#cb272-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-3"><a href="basic-statistical-analysis.html#cb272-3" aria-hidden="true" tabindex="-1"></a>rep.anova1 <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> d, <span class="at">dv =</span> pH, <span class="at">wid =</span> Group, <span class="at">within =</span> Block)</span>
<span id="cb272-4"><a href="basic-statistical-analysis.html#cb272-4" aria-hidden="true" tabindex="-1"></a>rep.anova1</span></code></pre></div>
<pre><code>## ANOVA Table (type III tests)
## 
## $ANOVA
##   Effect DFn DFd     F     p p&lt;.05   ges
## 1  Block   3  33 3.192 0.036     * 0.058
## 
## $`Mauchly&#39;s Test for Sphericity`
##   Effect     W        p p&lt;.05
## 1  Block 0.069 9.95e-05     *
## 
## $`Sphericity Corrections`
##   Effect   GGe      DF[GG] p[GG] p[GG]&lt;.05   HFe     DF[HF] p[HF] p[HF]&lt;.05
## 1  Block 0.417 1.25, 13.78 0.089           0.446 1.34, 14.7 0.086</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="basic-statistical-analysis.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or</span></span>
<span id="cb274-2"><a href="basic-statistical-analysis.html#cb274-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-3"><a href="basic-statistical-analysis.html#cb274-3" aria-hidden="true" tabindex="-1"></a>rep.anova2 <span class="ot">&lt;-</span> <span class="fu">ezANOVA</span>(<span class="at">data =</span> d, <span class="at">dv =</span> pH, <span class="at">wid =</span> Group, <span class="at">within =</span> Block)</span>
<span id="cb274-4"><a href="basic-statistical-analysis.html#cb274-4" aria-hidden="true" tabindex="-1"></a>rep.anova2</span></code></pre></div>
<pre><code>## $ANOVA
##   Effect DFn DFd        F         p p&lt;.05        ges
## 2  Block   3  33 3.191956 0.0362248     * 0.05809364
## 
## $`Mauchly&#39;s Test for Sphericity`
##   Effect         W            p p&lt;.05
## 2  Block 0.0690423 9.949466e-05     *
## 
## $`Sphericity Corrections`
##   Effect       GGe      p[GG] p[GG]&lt;.05       HFe      p[HF] p[HF]&lt;.05
## 2  Block 0.4174896 0.08941906           0.4455701 0.08562993</code></pre>
<div id="post-hocs" class="section level4 hasAnchor" number="5.2.2.1">
<h4><span class="header-section-number">5.2.2.1</span> Post-hocs<a href="basic-statistical-analysis.html#post-hocs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Lastly, I would like to briefly introduce a way for you to perform post-hocs. Post-hoc tests are the follow-up on ANOVAs where you investigate which exact groups present a difference. So say for instance that our previous <code>twoway_anova</code> tells us that the type of Contour shows a statistically significant change over pH (I know it doesn’t, so just pretend). Now, you may want to know which contour do exactly differ between themselves in terms of pH values.</p>
<p>For that we will use the <code>emmeans</code> package and base functions such as <code>pairs()</code>and <code>contrast()</code>. There are many other ways to obtain post-hocs, some may be simpler but more specific, but, as an example, I’ll demonstrate one of the most versatile (i.e., <code>emmeans</code>). This allows you to do post-hoc test for many types of linear, generalized linear models and mixed models. Given its vast applicability, it sometimes may be a bit confusing in how to extract the post-hoc tests for your model the way you want. For that you can consult its help vignette here:</p>
<p><a href="https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html#contents" class="uri">https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html#contents</a></p>
<p>This function</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="basic-statistical-analysis.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)  <span class="co"># stands for estimated marginal means</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;emmeans&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:GGally&#39;:
## 
##     pigs</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="basic-statistical-analysis.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(twoway_anova)</span></code></pre></div>
<pre><code>##               Df Sum Sq Mean Sq F value Pr(&gt;F)
## Contour        2  0.261  0.1303   0.274  0.762
## Block          3  1.232  0.4108   0.862  0.470
## Contour:Block  6  2.568  0.4280   0.898  0.507
## Residuals     36 17.154  0.4765</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="basic-statistical-analysis.html#cb281-1" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(<span class="at">object =</span> twoway_anova,</span>
<span id="cb281-2"><a href="basic-statistical-analysis.html#cb281-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">specs =</span> <span class="sc">~</span> Contour<span class="sc">*</span>Block,</span>
<span id="cb281-3"><a href="basic-statistical-analysis.html#cb281-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by =</span> <span class="st">&#39;Contour&#39;</span>, </span>
<span id="cb281-4"><a href="basic-statistical-analysis.html#cb281-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;response&#39;</span>,</span>
<span id="cb281-5"><a href="basic-statistical-analysis.html#cb281-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb281-6"><a href="basic-statistical-analysis.html#cb281-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-7"><a href="basic-statistical-analysis.html#cb281-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-8"><a href="basic-statistical-analysis.html#cb281-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm)</span></code></pre></div>
<pre><code>## Contour = Depression:
##  contrast        estimate    SE df t.ratio p.value
##  Block1 - Block2  -0.3525 0.488 36  -0.722  0.8876
##  Block1 - Block3  -0.3000 0.488 36  -0.615  0.9268
##  Block1 - Block4  -0.6550 0.488 36  -1.342  0.5431
##  Block2 - Block3   0.0525 0.488 36   0.108  0.9995
##  Block2 - Block4  -0.3025 0.488 36  -0.620  0.9251
##  Block3 - Block4  -0.3550 0.488 36  -0.727  0.8855
## 
## Contour = Slope:
##  contrast        estimate    SE df t.ratio p.value
##  Block1 - Block2  -0.2725 0.488 36  -0.558  0.9437
##  Block1 - Block3  -0.2500 0.488 36  -0.512  0.9557
##  Block1 - Block4  -1.0225 0.488 36  -2.095  0.1742
##  Block2 - Block3   0.0225 0.488 36   0.046  1.0000
##  Block2 - Block4  -0.7500 0.488 36  -1.537  0.4270
##  Block3 - Block4  -0.7725 0.488 36  -1.583  0.4010
## 
## Contour = Top:
##  contrast        estimate    SE df t.ratio p.value
##  Block1 - Block2  -0.1050 0.488 36  -0.215  0.9964
##  Block1 - Block3   0.2250 0.488 36   0.461  0.9670
##  Block1 - Block4   0.3900 0.488 36   0.799  0.8544
##  Block2 - Block3   0.3300 0.488 36   0.676  0.9055
##  Block2 - Block4   0.4950 0.488 36   1.014  0.7423
##  Block3 - Block4   0.1650 0.488 36   0.338  0.9865
## 
## P value adjustment: tukey method for comparing a family of 4 estimates</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="basic-statistical-analysis.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(emm)</span></code></pre></div>
<pre><code>## Contour = Depression:
##  contrast      estimate    SE df t.ratio p.value
##  Block1 effect  -0.3269 0.299 36  -1.094  0.5628
##  Block2 effect   0.0256 0.299 36   0.086  0.9322
##  Block3 effect  -0.0269 0.299 36  -0.090  0.9322
##  Block4 effect   0.3281 0.299 36   1.098  0.5628
## 
## Contour = Slope:
##  contrast      estimate    SE df t.ratio p.value
##  Block1 effect  -0.3862 0.299 36  -1.292  0.4090
##  Block2 effect  -0.1138 0.299 36  -0.381  0.7058
##  Block3 effect  -0.1363 0.299 36  -0.456  0.7058
##  Block4 effect   0.6362 0.299 36   2.129  0.1608
## 
## Contour = Top:
##  contrast      estimate    SE df t.ratio p.value
##  Block1 effect   0.1275 0.299 36   0.427  0.7462
##  Block2 effect   0.2325 0.299 36   0.778  0.7462
##  Block3 effect  -0.0975 0.299 36  -0.326  0.7462
##  Block4 effect  -0.2625 0.299 36  -0.878  0.7462
## 
## P value adjustment: fdr method for 4 tests</code></pre>
<p>You can change your <code>by</code> parameters to adjust what comparisons you want in the <code>pairs</code> and <code>contrast</code> functions. I recommend you manipulate this to really understand its inner workings.</p>
<p>As for the difference between the two functions (i.e., <code>pairs</code> and <code>contrasts</code>):<br />
- <code>pairs</code> -&gt; Performs all pairwise comparisons
- <code>contrast</code> -&gt; Used to test specific comparisons/hypotheses</p>
<p>If they are pairwise comparisons you should instead say (in this example) <code>pairwise ~ Contour * Block</code>.</p>
</div>
</div>
</div>
<div id="generalized-linear-regression" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Generalized Linear Regression<a href="basic-statistical-analysis.html#generalized-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When you have a outcome variable in which its error distribution of its model is not normally distributed, i.e., outcomes such counts or yes/no answers, you should use a <strong>generalized</strong> linear regression (GLM). It has a <em>link function</em> that allows you to model the relationship between the predictor variables and the response variable in the same fashion as a linear regression. Again this is very briefly and simply put, I encourage you to explore more on your own.</p>
<p>Now, GLMs are aptly executed in R with the function <code>glm()</code></p>
<p>We are going to take on an example from the CES11 database (carData package) which a 2011 Canadian poll on abortion. Here people could vote on weather abortion should be banned (‘Yes’) or not (‘No’).
Before performing our GLM we need to first convert the YES/NO answers to 0 and 1 values. Which is which doesn’t really matter (only matter for the interpretation of the estimate). Since this is a A or B type of response, we will use the binomial family to model the data.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="basic-statistical-analysis.html#cb285-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> carData<span class="sc">::</span>CES11</span>
<span id="cb285-2"><a href="basic-statistical-analysis.html#cb285-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-3"><a href="basic-statistical-analysis.html#cb285-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Recoding</span></span>
<span id="cb285-4"><a href="basic-statistical-analysis.html#cb285-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb285-5"><a href="basic-statistical-analysis.html#cb285-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">abortion01 =</span> <span class="fu">ifelse</span>(abortion <span class="sc">==</span> <span class="st">&#39;Yes&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb285-6"><a href="basic-statistical-analysis.html#cb285-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-7"><a href="basic-statistical-analysis.html#cb285-7" aria-hidden="true" tabindex="-1"></a><span class="co"># GLM</span></span>
<span id="cb285-8"><a href="basic-statistical-analysis.html#cb285-8" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">glm</span>(abortion01 <span class="sc">~</span> gender, <span class="at">family =</span> <span class="st">&#39;binomial&#39;</span>, <span class="at">data =</span> d)</span>
<span id="cb285-9"><a href="basic-statistical-analysis.html#cb285-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-10"><a href="basic-statistical-analysis.html#cb285-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretation/Summary</span></span>
<span id="cb285-11"><a href="basic-statistical-analysis.html#cb285-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = abortion01 ~ gender, family = &quot;binomial&quot;, data = d)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.6425  -0.6425  -0.6365  -0.6365   1.8418  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.47295    0.07279 -20.235   &lt;2e-16 ***
## genderMale  -0.02064    0.10984  -0.188    0.851    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2137.6  on 2230  degrees of freedom
## Residual deviance: 2137.6  on 2229  degrees of freedom
## AIC: 2141.6
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Once more, there are many parameters you can tune, other functions you can use, and other families you can model. This is just the more widely known function and most simple example.</p>
</div>
<div id="linear-mixed-models" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Linear Mixed Models<a href="basic-statistical-analysis.html#linear-mixed-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, it is far beyond the scope of this brief book to explain to you what linear <strong>mixed models</strong> (LMMs) are. Firstly, they are known by many names (just see <a href="https://en.wikipedia.org/wiki/Multilevel_model" class="uri">https://en.wikipedia.org/wiki/Multilevel_model</a>). In linear mixed models you can specify both fixed and random effects. Fixed effects are your usual predictor variables that have systematic effects on your outcome (e.g., treatment manipulations). Random effects are those that have stochastic (random) effect on your outcome, since these are selected randomly. For instance, lets say you plan on exploring if aggressive words, compared to neutral words, cause people to have increased heart-rate. For this you would need to select a <strong>random sample</strong> of aggressive words and neutral words, since there is no way you could expose your participants to all aggressive or neutral words. These can thus be considered a <em>random variable</em>. Usually, IDs of the participants themselves are seen as random effects, since the participants introduce some random (unpredictable) variability (different sample of 1000 participant will lead to slightly different results). And by this I mean each word (the ID of each word), not the category of the word (the category is a fixed variable). You also can (need) to specify the structure of these random effects in a correct manner, namely which effects are nested or crossed and their respective structure. Now, I’m sorry if this doesn’t make any sense, but the purpose here is to introduce you to a brief example of LMMs in R and I must skip with a detailed explanation. If it makes you feel any better, the distinction between random and fixed effects is still debated even among top statisticians. There are many more topics to cover for you to understand properly a LMM (even I don’t think I understand all of them), but we’ll stop here.</p>
<p>To perform LMMs I will use the <code>lmer()</code> function from the <code>lme4</code> package. We will use the sleepstudy data from <code>lme4</code> package. This data is from an experiment related to how sleep deprivation impairs reaction times. In this data participants were trained on the first two days (day 0 and 1) and began the experiment on day 2 (baseline).</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="basic-statistical-analysis.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="basic-statistical-analysis.html#cb291-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> lme4<span class="sc">::</span>sleepstudy</span>
<span id="cb291-2"><a href="basic-statistical-analysis.html#cb291-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-3"><a href="basic-statistical-analysis.html#cb291-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing the data adjusting for deprivation days</span></span>
<span id="cb291-4"><a href="basic-statistical-analysis.html#cb291-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb291-5"><a href="basic-statistical-analysis.html#cb291-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Days <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb291-6"><a href="basic-statistical-analysis.html#cb291-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Days =</span> Days <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb291-7"><a href="basic-statistical-analysis.html#cb291-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Days =</span> <span class="fu">as.factor</span>(Days))</span>
<span id="cb291-8"><a href="basic-statistical-analysis.html#cb291-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-9"><a href="basic-statistical-analysis.html#cb291-9" aria-hidden="true" tabindex="-1"></a>lmm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Reaction <span class="sc">~</span> Days <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject), <span class="at">data =</span> d)</span>
<span id="cb291-10"><a href="basic-statistical-analysis.html#cb291-10" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(lmm)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: Reaction
##       Chisq Df Pr(&gt;Chisq)    
## Days 107.17  7  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="basic-statistical-analysis.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hocs</span></span>
<span id="cb293-2"><a href="basic-statistical-analysis.html#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb293-3"><a href="basic-statistical-analysis.html#cb293-3" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(<span class="at">object =</span> lmm,</span>
<span id="cb293-4"><a href="basic-statistical-analysis.html#cb293-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">specs =</span> pairwise <span class="sc">~</span> Days,</span>
<span id="cb293-5"><a href="basic-statistical-analysis.html#cb293-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;response&#39;</span>,</span>
<span id="cb293-6"><a href="basic-statistical-analysis.html#cb293-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adjust =</span> <span class="st">&#39;bonferroni&#39;</span>, </span>
<span id="cb293-7"><a href="basic-statistical-analysis.html#cb293-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">contr =</span> <span class="fu">list</span>(<span class="at">Days =</span> <span class="st">&quot;dummy&quot;</span>))</span>
<span id="cb293-8"><a href="basic-statistical-analysis.html#cb293-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-9"><a href="basic-statistical-analysis.html#cb293-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-10"><a href="basic-statistical-analysis.html#cb293-10" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span></code></pre></div>
<pre><code>## I bet you wanted to call this with just object[[1]] - use &#39;[[]]&#39; or which&#39; if I&#39;m wrong.
## See &#39;? emm_list&#39; for more information</code></pre>
<pre><code>## Note: adjust = &quot;tukey&quot; was changed to &quot;sidak&quot;
## because &quot;tukey&quot; is only appropriate for one set of pairwise comparisons</code></pre>
<pre><code>##  contrast      estimate   SE  df t.ratio p.value
##  Days0 - Days1    -17.6 10.2 119  -1.723  0.4728
##  Days0 - Days2    -23.3 10.2 119  -2.277  0.1600
##  Days0 - Days3    -43.2 10.2 119  -4.219  0.0003
##  Days0 - Days4    -46.8 10.2 119  -4.577  0.0001
##  Days0 - Days5    -53.4 10.2 119  -5.219  &lt;.0001
##  Days0 - Days6    -71.3 10.2 119  -6.967  &lt;.0001
##  Days0 - Days7    -85.5 10.2 119  -8.357  &lt;.0001
## 
## Degrees-of-freedom method: kenward-roger 
## P value adjustment: sidak method for 7 tests</code></pre>
</div>
<div id="generalized-linear-mixed-models" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Generalized Linear Mixed Models<a href="basic-statistical-analysis.html#generalized-linear-mixed-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Much like generalized linear models, <strong>Generalized Linear Mixed Models (GLMMs)</strong> allow us to model data that doens’t follow a linear trend, like binary data or count data.
To perform GLMMs I will use the <code>glmer()</code> function from the same <code>lme4</code> package. We will use the MplsStops data from <code>carData</code> package. This data set contains the results of nearly all stops made by the Minneapolis Police Department for the year 2017. I’m interested in exploring if more stops are made for Black compared with White people. Since these have been collected by different precincts and different neighborhoods, I can use them too to help explain variability in the data. Obviously this is just an example, since firstly, the data should be adjusted towards the number of White and Black people living in these areas, but it serves as a base example.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="basic-statistical-analysis.html#cb297-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> carData<span class="sc">::</span>MplsStops </span>
<span id="cb297-2"><a href="basic-statistical-analysis.html#cb297-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-3"><a href="basic-statistical-analysis.html#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolating Black/White people and preparing data</span></span>
<span id="cb297-4"><a href="basic-statistical-analysis.html#cb297-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb297-5"><a href="basic-statistical-analysis.html#cb297-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">as.character</span>(race)) <span class="sc">%&gt;%</span> </span>
<span id="cb297-6"><a href="basic-statistical-analysis.html#cb297-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(race <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;Black&#39;</span>, <span class="st">&#39;White&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb297-7"><a href="basic-statistical-analysis.html#cb297-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">as.factor</span>(race)) <span class="sc">%&gt;%</span> </span>
<span id="cb297-8"><a href="basic-statistical-analysis.html#cb297-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(policePrecinct, neighborhood, race) <span class="sc">%&gt;%</span> </span>
<span id="cb297-9"><a href="basic-statistical-analysis.html#cb297-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Stops =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;policePrecinct&#39;, &#39;neighborhood&#39;. You can
## override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="basic-statistical-analysis.html#cb299-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb299-2"><a href="basic-statistical-analysis.html#cb299-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
## # Groups:   policePrecinct, neighborhood [3]
##   policePrecinct neighborhood    race  Stops
##            &lt;int&gt; &lt;fct&gt;           &lt;fct&gt; &lt;int&gt;
## 1              1 Cedar Riverside Black   140
## 2              1 Cedar Riverside White    80
## 3              1 Downtown East   Black    49
## 4              1 Downtown East   White    81
## 5              1 Downtown West   Black  1367
## 6              1 Downtown West   White   780</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="basic-statistical-analysis.html#cb301-1" aria-hidden="true" tabindex="-1"></a>glmm <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Stops <span class="sc">~</span> race <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>policePrecinct),</span>
<span id="cb301-2"><a href="basic-statistical-analysis.html#cb301-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="st">&#39;poisson&#39;</span>, <span class="at">data =</span> d)</span>
<span id="cb301-3"><a href="basic-statistical-analysis.html#cb301-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-4"><a href="basic-statistical-analysis.html#cb301-4" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(glmm)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: Stops
##       Chisq Df Pr(&gt;Chisq)    
## race 456.84  1  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="bayesian-analysis" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Bayesian analysis<a href="basic-statistical-analysis.html#bayesian-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bayesian analysis, can be performed with, among others, the package <code>brms</code>.
This package creates an interface for STAN through R. For those of you who don’t know what STAN is, don’t worry, its just another probabilistic programming language used for Bayesian statistical inference.
A bayesian model is not that different from the models we built above, we just need to specificy some additional parameters, like <em>family</em> and <em>priors</em>. Explaining this is beyond this guide, so I encourage you to visit/read the following:</p>
<ul>
<li><a href="https://rstudio-pubs-static.s3.amazonaws.com/721703_f1c1a8d256ce4393aabfe23c9c1d221d.html#what-is-bayesian-inference-work" class="uri">https://rstudio-pubs-static.s3.amazonaws.com/721703_f1c1a8d256ce4393aabfe23c9c1d221d.html#what-is-bayesian-inference-work</a></li>
<li>Statistical Rethinking by Richard McElreath</li>
</ul>
<p>Now, we are going to build a model using the <code>mtcars</code>. For this example we are going to create a model predicting <em>mpg</em> (miles per galon) using <em>disp</em> (displacement of the engine). The model is going to be pretty simple with uninformative priors.</p>
<p>Here is a list (courtesy of chatGPT) of all parameters that can be defined inside a <code>brm()</code> model, with their respective descriptions</p>
<p>• <em>formula</em>: The model formula specified using bf(), which defines the response and predictor variables in the model.
• <em>data</em>: The dataset containing the variables used in the model.
• <em>family</em>: The likelihood function used in the model, which specifies the distribution of the response variable. Common options include gaussian() (for linear regression), binomial() (for logistic regression), poisson() (for count data), and negbinomial() (for overdispersed count data).
• <em>prior</em>: A specification of the prior distributions used for the model parameters. Priors can be specified using prior() and can include a wide range of distributions, such as normal(), cauchy(), gamma(), student_t(), and lkj().
• <em>control</em>: A list of control parameters that affect the behavior of the MCMC algorithm used to estimate the posterior distribution. Control parameters can include adapt_delta (the target acceptance rate for the algorithm), max_treedepth (the maximum depth of the trees used in the algorithm), and iter (the total number of MCMC iterations to run).
• <em>chains</em>: The number of Markov chains to run during the MCMC algorithm. The default is 4.
• <em>cores</em>: The number of cores to use for parallel processing during the MCMC algorithm.
• <em>iter</em>: The total number of MCMC iterations to run.
• <em>warmup</em>: The number of warmup iterations to run at the beginning of the MCMC algorithm, which are discarded before the posterior distribution is estimated.
• <em>thin</em>: The thinning interval used to reduce autocorrelation between the MCMC samples.
• <em>cores</em>: The number of CPU cores to use for parallel processing.
• <em>seed</em>: The random seed used to initialize the MCMC algorithm.
• <em>save_all_pars</em>: Whether to save all parameter values during the MCMC algorithm. If TRUE, all parameter values are saved, which can be useful for diagnostic purposes.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="basic-statistical-analysis.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span></code></pre></div>
<pre><code>## Loading required package: Rcpp</code></pre>
<pre><code>## Loading &#39;brms&#39; package (version 2.18.0). Useful instructions
## can be found by typing help(&#39;brms&#39;). A more detailed introduction
## to the package is available through vignette(&#39;brms_overview&#39;).</code></pre>
<pre><code>## 
## Attaching package: &#39;brms&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     ngrps</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     ar</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="basic-statistical-analysis.html#cb309-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> mtcars</span>
<span id="cb309-2"><a href="basic-statistical-analysis.html#cb309-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-3"><a href="basic-statistical-analysis.html#cb309-3" aria-hidden="true" tabindex="-1"></a><span class="fu">brm</span>(<span class="at">formula =</span> <span class="fu">bf</span>(mpg <span class="sc">~</span> disp),</span>
<span id="cb309-4"><a href="basic-statistical-analysis.html#cb309-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> d,</span>
<span id="cb309-5"><a href="basic-statistical-analysis.html#cb309-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb309-6"><a href="basic-statistical-analysis.html#cb309-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb309-7"><a href="basic-statistical-analysis.html#cb309-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> b)),</span>
<span id="cb309-8"><a href="basic-statistical-analysis.html#cb309-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">500</span>)</span></code></pre></div>
<pre><code>## Compiling Stan program...</code></pre>
<pre><code>## Start sampling</code></pre>
<pre><code>## 
## SAMPLING FOR MODEL &#39;anon_model&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 3.6e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.36 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 1: Iteration:  501 / 2000 [ 25%]  (Sampling)
## Chain 1: Iteration:  700 / 2000 [ 35%]  (Sampling)
## Chain 1: Iteration:  900 / 2000 [ 45%]  (Sampling)
## Chain 1: Iteration: 1100 / 2000 [ 55%]  (Sampling)
## Chain 1: Iteration: 1300 / 2000 [ 65%]  (Sampling)
## Chain 1: Iteration: 1500 / 2000 [ 75%]  (Sampling)
## Chain 1: Iteration: 1700 / 2000 [ 85%]  (Sampling)
## Chain 1: Iteration: 1900 / 2000 [ 95%]  (Sampling)
## Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.064 seconds (Warm-up)
## Chain 1:                0.04 seconds (Sampling)
## Chain 1:                0.104 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;anon_model&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 9e-06 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.09 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 2: Iteration:  501 / 2000 [ 25%]  (Sampling)
## Chain 2: Iteration:  700 / 2000 [ 35%]  (Sampling)
## Chain 2: Iteration:  900 / 2000 [ 45%]  (Sampling)
## Chain 2: Iteration: 1100 / 2000 [ 55%]  (Sampling)
## Chain 2: Iteration: 1300 / 2000 [ 65%]  (Sampling)
## Chain 2: Iteration: 1500 / 2000 [ 75%]  (Sampling)
## Chain 2: Iteration: 1700 / 2000 [ 85%]  (Sampling)
## Chain 2: Iteration: 1900 / 2000 [ 95%]  (Sampling)
## Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.054 seconds (Warm-up)
## Chain 2:                0.043 seconds (Sampling)
## Chain 2:                0.097 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;anon_model&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 7e-06 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.07 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 3: Iteration:  501 / 2000 [ 25%]  (Sampling)
## Chain 3: Iteration:  700 / 2000 [ 35%]  (Sampling)
## Chain 3: Iteration:  900 / 2000 [ 45%]  (Sampling)
## Chain 3: Iteration: 1100 / 2000 [ 55%]  (Sampling)
## Chain 3: Iteration: 1300 / 2000 [ 65%]  (Sampling)
## Chain 3: Iteration: 1500 / 2000 [ 75%]  (Sampling)
## Chain 3: Iteration: 1700 / 2000 [ 85%]  (Sampling)
## Chain 3: Iteration: 1900 / 2000 [ 95%]  (Sampling)
## Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.027 seconds (Warm-up)
## Chain 3:                0.042 seconds (Sampling)
## Chain 3:                0.069 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;anon_model&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 8e-06 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 4: Iteration:  501 / 2000 [ 25%]  (Sampling)
## Chain 4: Iteration:  700 / 2000 [ 35%]  (Sampling)
## Chain 4: Iteration:  900 / 2000 [ 45%]  (Sampling)
## Chain 4: Iteration: 1100 / 2000 [ 55%]  (Sampling)
## Chain 4: Iteration: 1300 / 2000 [ 65%]  (Sampling)
## Chain 4: Iteration: 1500 / 2000 [ 75%]  (Sampling)
## Chain 4: Iteration: 1700 / 2000 [ 85%]  (Sampling)
## Chain 4: Iteration: 1900 / 2000 [ 95%]  (Sampling)
## Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.031 seconds (Warm-up)
## Chain 4:                0.04 seconds (Sampling)
## Chain 4:                0.071 seconds (Total)
## Chain 4:</code></pre>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: mpg ~ disp 
##    Data: d (Number of observations: 32) 
##   Draws: 4 chains, each with iter = 2000; warmup = 500; thin = 1;
##          total post-warmup draws = 6000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    29.32      1.30    26.73    31.77 1.00     6134     4014
## disp         -0.04      0.00    -0.05    -0.03 1.00     6922     4592
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     3.38      0.47     2.64     4.45 1.00     3204     2894
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="basic-statistical-analysis.html#cb314-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">data =</span> d, </span>
<span id="cb314-2"><a href="basic-statistical-analysis.html#cb314-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> gaussian,</span>
<span id="cb314-3"><a href="basic-statistical-analysis.html#cb314-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> mpg <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> disp, <span class="co"># or simply bf(mpg ~ disp)</span></span>
<span id="cb314-4"><a href="basic-statistical-analysis.html#cb314-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb314-5"><a href="basic-statistical-analysis.html#cb314-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb314-6"><a href="basic-statistical-analysis.html#cb314-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">prior</span>(<span class="fu">lognormal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb314-7"><a href="basic-statistical-analysis.html#cb314-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb314-8"><a href="basic-statistical-analysis.html#cb314-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">7</span>,</span>
<span id="cb314-9"><a href="basic-statistical-analysis.html#cb314-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">&#39;ex_fit&#39;</span>)</span>
<span id="cb314-10"><a href="basic-statistical-analysis.html#cb314-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-11"><a href="basic-statistical-analysis.html#cb314-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m1)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: mpg ~ 1 + disp 
##    Data: d (Number of observations: 32) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    29.30      1.21    26.77    31.71 1.00     3401     2398
## disp         -0.04      0.00    -0.05    -0.03 1.00     3515     2666
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     3.28      0.42     2.59     4.20 1.00     2640     2936
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="time-series" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Time series<a href="basic-statistical-analysis.html#time-series" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Time series analysis are another common type of analysis that allows us to identify trends and forecast future values in data that is collected in regular intervals along some time-frame.
To illustrate a time-series analysis we are going to use the “AirPassengers” data set. This data set represents the monthly totals of international airline passengers from 1949 to 1960.
To perform a time series you need to make sure that your data is a <code>ts</code> object. Luckily our example is already in this format. For further reading and questions, you can read the following:</p>
<ul>
<li><a href="https://a-little-book-of-r-for-time-series.readthedocs.io/en/latest/src/timeseries.html" class="uri">https://a-little-book-of-r-for-time-series.readthedocs.io/en/latest/src/timeseries.html</a></li>
<li><a href="https://www.geeksforgeeks.org/time-series-analysis-in-r/" class="uri">https://www.geeksforgeeks.org/time-series-analysis-in-r/</a></li>
</ul>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="basic-statistical-analysis.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the AirPassengers dataset</span></span>
<span id="cb316-2"><a href="basic-statistical-analysis.html#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(AirPassengers)</span>
<span id="cb316-3"><a href="basic-statistical-analysis.html#cb316-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> AirPassengers</span>
<span id="cb316-4"><a href="basic-statistical-analysis.html#cb316-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-5"><a href="basic-statistical-analysis.html#cb316-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the data frame to a ts object.</span></span>
<span id="cb316-6"><a href="basic-statistical-analysis.html#cb316-6" aria-hidden="true" tabindex="-1"></a>ts_data <span class="ot">&lt;-</span> <span class="fu">ts</span>(d, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1949</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb316-7"><a href="basic-statistical-analysis.html#cb316-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-8"><a href="basic-statistical-analysis.html#cb316-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting data frame</span></span>
<span id="cb316-9"><a href="basic-statistical-analysis.html#cb316-9" aria-hidden="true" tabindex="-1"></a>d_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">time</span>(ts_data), <span class="at">passengers =</span> <span class="fu">as.numeric</span>(ts_data))</span>
<span id="cb316-10"><a href="basic-statistical-analysis.html#cb316-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-11"><a href="basic-statistical-analysis.html#cb316-11" aria-hidden="true" tabindex="-1"></a>d_plot <span class="sc">%&gt;%</span> </span>
<span id="cb316-12"><a href="basic-statistical-analysis.html#cb316-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(date, passengers)) <span class="sc">+</span></span>
<span id="cb316-13"><a href="basic-statistical-analysis.html#cb316-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<pre><code>## Don&#39;t know how to automatically pick scale for object of type ts. Defaulting to continuous.</code></pre>
<p><img src="using_r_data_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="basic-statistical-analysis.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a decomposition to separate the trend, seasonal, and random components</span></span>
<span id="cb318-2"><a href="basic-statistical-analysis.html#cb318-2" aria-hidden="true" tabindex="-1"></a>decomp <span class="ot">&lt;-</span> <span class="fu">decompose</span>(ts_data)</span>
<span id="cb318-3"><a href="basic-statistical-analysis.html#cb318-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-4"><a href="basic-statistical-analysis.html#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See the results of the decomposition</span></span>
<span id="cb318-5"><a href="basic-statistical-analysis.html#cb318-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decomp)</span></code></pre></div>
<p><img src="using_r_data_files/figure-html/unnamed-chunk-132-2.png" width="672" /></p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="basic-statistical-analysis.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a simple linear regression model to the time series data</span></span>
<span id="cb319-2"><a href="basic-statistical-analysis.html#cb319-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(ts_data <span class="sc">~</span> <span class="fu">time</span>(ts_data))</span>
<span id="cb319-3"><a href="basic-statistical-analysis.html#cb319-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-4"><a href="basic-statistical-analysis.html#cb319-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ts_data ~ time(ts_data))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -93.858 -30.727  -5.757  24.489 164.999 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -62055.907   2166.077  -28.65   &lt;2e-16 ***
## time(ts_data)     31.886      1.108   28.78   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 46.06 on 142 degrees of freedom
## Multiple R-squared:  0.8536, Adjusted R-squared:  0.8526 
## F-statistic: 828.2 on 1 and 142 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="drift-difussion-modelling" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Drift difussion modelling<a href="basic-statistical-analysis.html#drift-difussion-modelling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="survival-analysis" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Survival analysis<a href="basic-statistical-analysis.html#survival-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="end-2" class="section level2 hasAnchor" number="5.10">
<h2><span class="header-section-number">5.10</span> End<a href="basic-statistical-analysis.html#end-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exploratory-data-analysis-eda.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-Chapter4.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["using_r_data.pdf", "using_r_data.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
