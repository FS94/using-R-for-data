% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Usefulness of R for managing data},
  pdfauthor={Fábio A. Silva},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Usefulness of R for managing data}
\author{Fábio A. Silva}
\date{2023-03-16}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

This is a guide on R and its role in basic data manipulation.
It requires no prior experience/knowledge in R.

Currently, it is divided into 4 chapters (last one is still under development).

\begin{itemize}
\item
  \textbf{Chapter 1} will introduce you to R and provide you the basic programming tools, alongside other useful tips, to help you navigate R.
\item
  \textbf{Chapter 2} will introduce you to data management tools.
\item
  \textbf{Chapter 3} will introduce you to a more practical example of data exploration, emphasizing plot building.
\item
  \textbf{Chapter 4} will show you some basic statistical analysis.
\end{itemize}

In the future I plan to further elaborate on this guide, but for now I think its good enough for most people to get a picture on what R is, why you should use it, as well as, of course, how to use it.

I hope you learn something and find this guide useful.

\hypertarget{basic-r}{%
\chapter{Basic R}\label{basic-r}}

\hypertarget{note}{%
\section{Note}\label{note}}

This portion of the guide is intended to present you the basics of R to get you up and running.\\

However, this is not meant to give you all the guidance and know-how, as well as answer all your questions.
There are plenty of internet tutorials already that answer more specific and basic questions.\\

I'll provide a few links at the end that complement what I'll show you here.

\hypertarget{what-is-r-and-rstudio}{%
\section{What is R and RStudio}\label{what-is-r-and-rstudio}}

From their own website, simply put ``R is a language and environment for statistical computing and graphics.''.\\

So R is a programming language, just like Python, Matlab or even the syntax you find in SPSS.
This language is particularly driven towards mathematical operations and thus proves quite useful when it comes to data management and analysis.
Importantly, its an expansive (things keep getting added all the time) and open-source (the code is freely available).

As for RStudio, it is an interface for this programming language.
Simply put, it makes working with R easier and everyone (in general) uses this interface to code in R.
When you install R it already installs a very basic editor that lets you do some stuff, but RStudio is way more convening for everything other than simple calculations.
You can see the basic R editor as Textpad (or Notepad application) and RStudio as Word.

\hypertarget{why-r}{%
\section{Why R?}\label{why-r}}

Here follows a list of things R is can do (and excels, pun intended, at):

\begin{itemize}
\item
  Read (nearly) all types of data.
\item
  Manipulate data in every way possible.
\item
  Create any type of graphic data visualization.
\item
  Perform any type of statistical analysis.
\item
  Perform any type of machine learning applications.
\item
  Web scraping.
\item
  Creating reports.
\item
  Creating web apps.
\item
  Many more\ldots{}
\end{itemize}

\hypertarget{where-to-get-it-and-how-to-run-it}{%
\section{Where to get it and how to run it}\label{where-to-get-it-and-how-to-run-it}}

You can download R from \url{https://cran.r-project.org/} and RStudio from \url{https://www.rstudio.com/}.

\hypertarget{environment}{%
\section{Environment}\label{environment}}

This is your basic environment.
You have 4 (actually 5 with the upper bar area) divisions.

The top pane (1), gives you access to plenty of options regarding RStudio, letting you open files, save, search, etc..

The pane number 2 is your main area of work.
This is your script.
The script is the area where you will write your code.
This code (all or whatever lines you select) will then be executed in the console.

The console (4) is where your code is executed.
You can write single lines directly into it.
This is where your information about your errors will show up.

Your right area of the screen contains 2 distinct areas, that can show different things.
Area number 3 usually contains your environment.
In here you will see every variable that you have attributed (they will be stored here).
You can access them by clicking on them.
It also contains other sub menus, but I will not go into detail here.

The bottom area (5) contains the files that are in the directory where you area working, will show your plots, will contain your packages (for easy access), the help menu and the viewer (interactive plots pane).

Note, all of your environment is customizable, changing both what panels appear and where, and the overall appearance of Rstudio (you change to dark mode if you think you're cool enough, for instance).

\begin{figure}
\centering
\includegraphics{images/rstudio_ide.png}
\caption{R IDE.}
\end{figure}

\hypertarget{scripts-notebooks-and-rmarkdown-and-projects}{%
\section{Scripts, Notebooks and RMarkdown (and Projects)}\label{scripts-notebooks-and-rmarkdown-and-projects}}

In creating a new R script you can choose one of three different R documents, \textbf{R Script}, \textbf{R Notebook} and \textbf{R Markdown}.
Well you can actually choose more, but these are perhaps (particularly regarding the focus of this book) the most important ones.\\

\textbf{R script} is a simple sheet where you write code and add comments by using \#.
R scripts are best used when are writing scripts for automacy (automating tasks) and don't necessarily need to view any output along the way, but only at the end (when everything is computed and done).
Otherwise, I would almost always recommend either one of the other two formats.

The other two formats are pretty much the same.
They only differ in terms of their preview function.
These types of special scripts are built with a markdown language, such that the script panel can now be seen as a text document and you can, within that ``text document,'' insert code chunks and run these code chunk as needed.
Importantly, and perhaps one of the best features, is that the output of each chunk is, by default, shown just below that code chunk.
This makes these scripts extremely useful when doing data analysis of any kind, given that, provided that they are not too messy, they have the potential to make great reports of your data analysis (showing results and graphs along the way).
So if you are new o this, I would recommend using \textbf{R Notebook} otherwise just default to \textbf{R Markdown}.

Lastly, when starting project you can instead opt to first create a Project in RStudio.
This will create a \emph{.Rproj} file in the folder you created your project in.
This will help you resume faster your project by simply opening this \emph{.RProj} and every script associated with the project, as well as the defined working directories will be opened and ready.
It has more advantages, such as better integration in version control system such as git, better for collaboration, reproducibility and efficiency.

\hypertarget{working-directories}{%
\section{Working directories}\label{working-directories}}

Whenever you create a new R-type file (e.g., R-script, Rmarkdown, etc.) and you save it somewhere (e.g., ``C:/Users/fabio/OneDrive/My Things/Stats/Teaching/R\_Book'') it sets your working directory to that folder.
You can change verify this by using the command \texttt{getwd()}.

You can also alter this working directory by executing \texttt{setwd(\textquotesingle{}what\ working\ directory\ I\ want")}.

Importantly, when saving your working directory it should in a string format and separated by ``/'' and not ``\textbackslash{}''.
For instance \texttt{setwd("C:/Users/MyName/Work/Project1")}.

There is also a quick way to do it, although I don't recommend it as much because the next time you initiate RStudio and work on that script you'll need to again set the working directory.
If you have it in writing in one of the first lines of your scripts it automatically runs it the moment you run your script.

\hypertarget{operators}{%
\section{Operators}\label{operators}}

R has \textbf{arithmetic operators} and \textbf{logical operators}.\\

The first ones, \textbf{arithmetic operators} are the following (there are more but, I believe, less important):

\texttt{+}: adds\\
\texttt{-}: subtracts\\
\texttt{*}: multiplies\\
\texttt{/}: divides\\
\texttt{\^{}} or \texttt{**}: exponentiates

Then there are \textbf{logical operators}:

\texttt{\textless{}}: lesser than\\
\texttt{\textless{}=}: lesser or equal than\\
\texttt{\textgreater{}}: bigger than\\
\texttt{\textgreater{}=}: bigger or equal than\\
\texttt{==}: equals\\
\texttt{!=}: not equal to\\
\texttt{!x}: not x\\
\texttt{x\ \textbar{}\ y}: x OR y\\
\texttt{x\ \&\ y}: x AND y

\hypertarget{classes-types-and-structures}{%
\section{Classes, Types and Structures}\label{classes-types-and-structures}}

The data you imported can be in a wide range of classes (types).
There are 4 basic types of classes, built-in (different functions can use more), you need to be aware (although there are more).
These are:

\begin{itemize}
\item
  \emph{character}: Strings (words), such as \texttt{"hello"} or \texttt{"hi123"}.\\
\item
  \emph{numeric}: Any type of number, such as \texttt{2}or \texttt{30.4}.\\
\item
  \emph{logical}: The true or false values.
  \texttt{TRUE} or \texttt{FALSE}.
\item
  \emph{date}: In a date format.
  Can be converted from different types (e.g., \texttt{2007-11-11}, \texttt{2jan1960})
\end{itemize}

You can ask R about what type of object it is by using the \texttt{class(object)} command or the \texttt{typeof(object)}

R also has different data structures.
The ones worth talking about here are:

\begin{itemize}
\item
  \emph{atomic vector}: Basically every R data structure.
  A vector could be a character or an numeric object, for instance.
\item
  \emph{lists}: a list of objects.
  Can be created by using \texttt{list()}.
  You can retrieve the value by using \texttt{{[}{[}{]}{]}}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{l }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\StringTok{\textquotesingle{}Potatoes\textquotesingle{}}\NormalTok{, }\DecValTok{4}\NormalTok{)}

\NormalTok{l}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [[1]]
## [1] "Potatoes"
## 
## [[2]]
## [1] 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_list }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\StringTok{\textquotesingle{}Potatoes\textquotesingle{}}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{, }\DecValTok{15}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Strawberry\textquotesingle{}}\NormalTok{, }\DecValTok{1000}\NormalTok{))}

\CommentTok{\# or}
\NormalTok{my\_list }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{ingredients =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Strawberry\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Milk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Coffee\textquotesingle{}}\NormalTok{), }\AttributeTok{type =} \StringTok{\textquotesingle{}Milkshake\textquotesingle{}}\NormalTok{, }\AttributeTok{rating =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  \emph{matrix}: are like tables.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{9}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{3}\NormalTok{)}

\NormalTok{carro }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\AttributeTok{data =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{9}\NormalTok{,}\AttributeTok{nrow =} \DecValTok{3}\NormalTok{,}\AttributeTok{ncol =} \DecValTok{3}\NormalTok{)}

\NormalTok{my\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{9}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{dimnames =} \FunctionTok{list}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"X"}\NormalTok{,}\StringTok{"Y"}\NormalTok{,}\StringTok{"Z"}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{,}\StringTok{"B"}\NormalTok{,}\StringTok{"C"}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  \emph{data frame}: fancy matrices (more common)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ iris}
\CommentTok{\# View(iris)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  \emph{factor}: more of a type of class than anything. This object is a factor with levels.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(d}\SpecialCharTok{$}\NormalTok{Species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "factor"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{levels}\NormalTok{(d}\SpecialCharTok{$}\NormalTok{Species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "setosa"     "versicolor" "virginica"
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \emph{tibble}: a special data frame from tidyverse
\end{itemize}

For additional info, visit: \url{https://swcarpentry.github.io/r-novice-inflammation/13-supp-data-structures/}

\hypertarget{comments}{%
\section{Comments}\label{comments}}

Commenting your code is good practice.
You can comment anything, but perhaps its most practical use is to leave instructions as to what the code, or section of code, is doing.

Commenting is also great for when you don't want a certain part of your code to run.

Below you see a function, kinda of a confusing one, where comments in each line help me (and other readers) understand what the function is doing.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# My list}
\NormalTok{my\_list }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Water0\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fire10\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Ear899th\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}1Wind0\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Creating a function to remove numbers from my characters}
\NormalTok{rem\_num }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(list\_of\_words)\{}
\NormalTok{  final\_word\_list }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()  }\CommentTok{\# creates empty list}
  \ControlFlowTok{for}\NormalTok{ (word }\ControlFlowTok{in}\NormalTok{ list\_of\_words)\{  }\CommentTok{\# creating loop}
\NormalTok{    numberless }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{\textquotesingle{}[[:digit:]]+\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, word)  }\CommentTok{\# removing numbers}
\NormalTok{    final\_word\_list }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(final\_word\_list, numberless)  }\CommentTok{\# adding to a final list}
\NormalTok{  \}}
  \FunctionTok{print}\NormalTok{(final\_word\_list) }\CommentTok{\# show list at the end}
\NormalTok{\}}

\CommentTok{\# Executing function}
\FunctionTok{rem\_num}\NormalTok{(}\AttributeTok{list\_of\_words =}\NormalTok{ my\_list)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Water" "Fire"  "Earth" "Wind"
\end{verbatim}

\hypertarget{objects}{%
\section{Objects}\label{objects}}

In R you can create objects.
This can be any type of classes we discussed above.
Your object can be a letter, a number, a word, a mix of letters and numbers, a data frame, a vectors, a list, multiple lists, multiple data frames, you name it.
If your object contains multiple things, it becomes a list.
Objects, when created, appear in your Environment panel (top right).
To create an object you must give it a name and then you use \texttt{\textless{}-} followed by whatever you want to make an object.\\

For instance:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \DecValTok{1}
\NormalTok{b }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}Hi\textquotesingle{}}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\StringTok{\textquotesingle{}Hi\textquotesingle{}}\NormalTok{, }\FloatTok{3.5}\NormalTok{)}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{)}
\NormalTok{d }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\StringTok{\textquotesingle{}Name\textquotesingle{}} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Ana\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}João\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Pedro\textquotesingle{}}\NormalTok{), }\StringTok{\textquotesingle{}Age\textquotesingle{}} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{25}\NormalTok{, }\DecValTok{40}\NormalTok{, }\DecValTok{19}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{combinations}{%
\section{Combinations}\label{combinations}}

In R, as you've seen above, you can use combinations (concatenations) and attribute these combinations to a variable.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create a combination with multiple items.}
\NormalTok{ctl }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\StringTok{\textquotesingle{}Hi\textquotesingle{}}\NormalTok{, }\FloatTok{3.5}\NormalTok{)}

\NormalTok{teste }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{9}\NormalTok{, }\DecValTok{71}\NormalTok{)}
\NormalTok{teste }\OtherTok{\textless{}{-}}\NormalTok{ teste }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{teste}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  5 10 72
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Asking the mean of that set of items.}
\FunctionTok{mean}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3.5
\end{verbatim}

\hypertarget{subsetting}{%
\section{Subsetting}\label{subsetting}}

When you have complex objects (not just a single entry object) you can use subset to select only a specific part of said object.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}apples\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}bananas\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}carrots\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}oranges\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}strawberry\textquotesingle{}}\NormalTok{)}

\NormalTok{a[}\DecValTok{1}\NormalTok{]   }\CommentTok{\# selects first entry}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "apples"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a[}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)]  }\CommentTok{\# selects entries 2 and 3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "bananas" "carrots"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a[}\DecValTok{3}\SpecialCharTok{:}\DecValTok{5}\NormalTok{]  }\CommentTok{\# selects entry 3 to entry 5}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "carrots"    "oranges"    "strawberry"
\end{verbatim}

\hypertarget{ifs-and-elses}{%
\section{Ifs and elses}\label{ifs-and-elses}}

The \texttt{if()} function is a really basic functions in programming languages that allows you to iterate certain actions (i.e., perform an action multiple times).
The \texttt{if()} function is written, and means, the following:

\textbf{If function}

if (condition)\{

perform\_this \# if true

\} else \{

perform\_that \# if false

\}

Here are just a few basic examples for you to get an idea.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# First example}
\ControlFlowTok{if}\NormalTok{ (}\DecValTok{3} \SpecialCharTok{\textgreater{}} \DecValTok{2}\NormalTok{)\{}
  \FunctionTok{print}\NormalTok{(}\StringTok{\textquotesingle{}True\textquotesingle{}}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
  \FunctionTok{print}\NormalTok{(}\StringTok{\textquotesingle{}False\textquotesingle{}}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "True"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Second example}
\NormalTok{my\_list }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}orange\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}banana\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}apple\textquotesingle{}}\NormalTok{)}

\ControlFlowTok{if}\NormalTok{ (my\_list[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{==} \StringTok{\textquotesingle{}apple\textquotesingle{}}\NormalTok{)\{}
  \FunctionTok{print}\NormalTok{(}\StringTok{\textquotesingle{}The second item in the list is apple!\textquotesingle{}}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (my\_list[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{==} \StringTok{\textquotesingle{}orange\textquotesingle{}}\NormalTok{)\{}
  \FunctionTok{print}\NormalTok{(}\StringTok{\textquotesingle{}The second item in the list is orange!\textquotesingle{}}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
  \FunctionTok{print}\NormalTok{(}\StringTok{\textquotesingle{}The second item in the list must be banana!\textquotesingle{}}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "The second item in the list must be banana!"
\end{verbatim}

\hypertarget{loops}{%
\section{Loops}\label{loops}}

Loops are also a great tool.
These functions automatically run a block of run repeatedly until a end condition is met.
You have two types of loops.
We will call them the ``for'' and ``while'' loops.
The latter runs a function, until a ``stop'' condition is met.
I would say while loops are less common, but can be quite useful.
However, be warned that they can easily get ``stuck'', i.e., you specify a condition that is never met and the loop runs infinitely, forcing you to stop r from running.
It follows the following structure.

\textbf{While loop}

while (condition)\{

perform\_this

\}

Lets see a basic example of this loop.
In this case we have a ``my number'' object which starts as 0.
Then we will have a function that will run until this number is no longer inferior to five.
Per each iteration/loop of this function we will add 1 to this number.
Let's see the example below.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Third example}
\NormalTok{my\_number }\OtherTok{=} \DecValTok{0}

\ControlFlowTok{while}\NormalTok{(my\_number }\SpecialCharTok{\textless{}} \DecValTok{5}\NormalTok{)\{}
  \FunctionTok{print}\NormalTok{(}\StringTok{\textquotesingle{}My current number is lower than 5\textquotesingle{}}\NormalTok{)}
\NormalTok{  my\_number }\OtherTok{\textless{}{-}}\NormalTok{ my\_number }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "My current number is lower than 5"
## [1] "My current number is lower than 5"
## [1] "My current number is lower than 5"
## [1] "My current number is lower than 5"
## [1] "My current number is lower than 5"
\end{verbatim}

A perhaps more common loop is the ``for'' type of loop.
This type of loop follows this basic structure:

\textbf{For loop}

for (element in set\_of\_elements)\{ do\_something \}

The element can be anything, either a single letter (commonly i, x or z) or a short word.
It does not need to have meaning - even though ``element'' is not known to R, in the context of that loop above it will signify every object in ``set\_of\_elements''.

Ok, so lets work on a very basic example.
Let say you have a number ``n'' and you want to add every number from 1 to 10 to this n.
Lets say our initial n is 0 and we want a loop to help us do this without having to do it ``manually''.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{))\{}
\NormalTok{  novo\_element }\OtherTok{\textless{}{-}}\NormalTok{ i }\SpecialCharTok{+} \DecValTok{10}
  \FunctionTok{print}\NormalTok{(novo\_element)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 11
## [1] 12
## [1] 13
## [1] 14
## [1] 15
## [1] 16
## [1] 17
## [1] 18
## [1] 19
## [1] 20
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{0}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)\{}
  \FunctionTok{cat}\NormalTok{(}\StringTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}n}\StringTok{Adding\textquotesingle{}}\NormalTok{, i ,}\StringTok{\textquotesingle{}to\textquotesingle{}}\NormalTok{, n)}
\NormalTok{  n }\OtherTok{=}\NormalTok{ n }\SpecialCharTok{+}\NormalTok{ i}
  \FunctionTok{cat}\NormalTok{(}\StringTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}n}\StringTok{Result:\textquotesingle{}}\NormalTok{, n)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Adding 1 to 0
## Result: 1
## Adding 2 to 1
## Result: 3
## Adding 3 to 3
## Result: 6
## Adding 4 to 6
## Result: 10
## Adding 5 to 10
## Result: 15
## Adding 6 to 15
## Result: 21
## Adding 7 to 21
## Result: 28
## Adding 8 to 28
## Result: 36
## Adding 9 to 36
## Result: 45
## Adding 10 to 45
## Result: 55
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}n}\StringTok{Final n\textquotesingle{}}\NormalTok{, n)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Final n 55
\end{verbatim}

Now onto a more practical one.
Lets say you have a list of numbers and you only want to add those that are above 10 to a new list.
You could look over every one of them and add it manually, or you could just build the loop below.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_number\_list }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{7}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{21}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{61}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{29}\NormalTok{, }\DecValTok{02}\NormalTok{, }\DecValTok{19}\NormalTok{, }\DecValTok{44}\NormalTok{,}
                    \DecValTok{03}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{5.5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{71}\NormalTok{, }\FloatTok{10.5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{65}\NormalTok{, }\FloatTok{4.5}\NormalTok{)}

\NormalTok{list\_bigger\_10 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{() }\CommentTok{\# empty object }

\ControlFlowTok{for}\NormalTok{ (n }\ControlFlowTok{in}\NormalTok{ my\_number\_list)\{}
  \ControlFlowTok{if}\NormalTok{ (n }\SpecialCharTok{\textgreater{}} \DecValTok{10}\NormalTok{)\{}
\NormalTok{    list\_bigger\_10 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(list\_bigger\_10, n)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{cat}\NormalTok{(}\StringTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}n}\StringTok{\textquotesingle{}}\NormalTok{, n, }\StringTok{\textquotesingle{}not bigger than 10\textquotesingle{}}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  7 not bigger than 10
##  5 not bigger than 10
##  2 not bigger than 10
##  2 not bigger than 10
##  3 not bigger than 10
##  4 not bigger than 10
##  5.5 not bigger than 10
##  10 not bigger than 10
##  4 not bigger than 10
##  4.5 not bigger than 10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(list\_bigger\_10)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 20.0 21.0 61.0 29.0 19.0 44.0 71.0 10.5 65.0
\end{verbatim}

\hypertarget{functions}{%
\section{Functions}\label{functions}}

A function is a set of statements (commands) organized in a way to perform a task.
R, for instance, already has a large number of in-built functions (for instance, \texttt{mean(c(5,\ 10,\ 15))} is a function).
The cool thing, however, is that, as with other programming languages, we can build our own function.
The function takes a set of arguments and performs actions over that argument and output something (if we want).\\

Its general structure is as follows:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{function\_name }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(arg\_1, arg\_2, ...)\{}
\NormalTok{   actions and commands}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Here are a few examples.
Lets say we want to create a function that tells us the square root of our input.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{square\_function }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(number\_to\_be\_squared)\{}
\NormalTok{  final\_number }\OtherTok{\textless{}{-}}\NormalTok{ (number\_to\_be\_squared)}\SpecialCharTok{\^{}}\DecValTok{2}
  \FunctionTok{return}\NormalTok{(final\_number)}
\NormalTok{\}}

\CommentTok{\# Now lets call the function}
\FunctionTok{square\_function}\NormalTok{(}\AttributeTok{number\_to\_be\_squared =} \DecValTok{9}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 81
\end{verbatim}

Functions can also be called without arguments.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{arg\_less }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{()\{}
  \FunctionTok{print}\NormalTok{(}\StringTok{\textquotesingle{}Just print this\textquotesingle{}}\NormalTok{)}
\NormalTok{\}}

\FunctionTok{arg\_less}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Just print this"
\end{verbatim}

They can also have multiple inputs

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mult\_fun }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(a, b, c)\{}
\NormalTok{  output }\OtherTok{\textless{}{-}}\NormalTok{ a }\SpecialCharTok{+}\NormalTok{ b}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{+} \FunctionTok{sqrt}\NormalTok{(c)}
  \FunctionTok{print}\NormalTok{(output)}
\NormalTok{\}}

\FunctionTok{mult\_fun}\NormalTok{(}\AttributeTok{a =} \DecValTok{1}\NormalTok{, }\AttributeTok{b =} \DecValTok{2}\NormalTok{, }\AttributeTok{c =} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 7.236068
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Or simply}
\CommentTok{\# mult\_fun(1, 2, 5)}
\end{Highlighting}
\end{Shaded}

\hypertarget{packages}{%
\section{Packages}\label{packages}}

There are over 9000 packages.
There are packages for nearly everything you want to do.
These packages add new functions to R.

You have \emph{base packages} (already installed, but not loaded) and \emph{contributed packages} (need to be installed and loaded).

You can install the latter by using the following command \texttt{install.packages(\textquotesingle{}package\_name\textquotesingle{})} and call (load) packages with \texttt{library(package\_name)}.\\

Most packages come from CRAN (Comprehensive R Archive Network, which is basically R's house), thus all you need to write is that.

However, if some packages come from github for instance you need to install the packages ``devtools'' (\texttt{install.packages(\textquotesingle{}devtools\textquotesingle{})}) then load it (\texttt{library(devtools)}) and finally use \texttt{install\_github("profile\_name/repository")} to install the package.
Usually if you google these packages they will have instructions on how to install them.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"ggplot2"}\NormalTok{)}

\FunctionTok{library}\NormalTok{(ggplot2)}
\end{Highlighting}
\end{Shaded}

You can also load and detach (remove package from your toolset for the time being) packages that you have already installed by going to the packages panel (bottom right) and searching and then selecting the package you want to load.

In specific situations, particularly if you just want to use one function of a package, instead of loading the package you can simply write \texttt{package\_name::function\_name()}.
R will just use that function from that package for that line in specific, but not load the package.

\hypertarget{conflicts}{%
\subsection{Conflicts}\label{conflicts}}

Sometimes you will notice that certain packages have the same function names, each with its specific purpose.
There are no conflict on packages loaded by default in R.
These conflicts emerge \textbf{only} when you load new packages (e.g.~\texttt{library("package\_name")}).
When this happens, R, unless specified, will use the function from the most recently loaded package.
So for instance, in the chapters ahead you will use (and load) a package called ``tidyverse''.
When you do call this package (\texttt{library(tidyverse)}) you will already be prompted with a message warning you of possible conflict (although most packages don't even prompt you with this message).
You can always check what conflicts are currently present by calling the function \texttt{conflict\_scout()} from the package (``conflicts'') which is pre-loaded in R.
If you do this further ahead you will be prompted with a similar message:

``\,``\,'' OUTPUT 2 conflicts - \texttt{filter()}: dplyr and stats - \texttt{lag()}: dplyr and stats ``\,``\,''

Now at least you know that the \texttt{filter()} and \texttt{lag()} functions are shared by two packages.
But remember, each function (depending on the package) has a different\ldots{} well function.
This might cause you problems when re-running your scripts.
So if you are loading unfamiliar packages or simply have several packages in an R session - \emph{a loaded package works for all scripts in a R session, you do not need to load a package for each script!} - be wary that conflict might emerge.

Now to resolve this conflict you have three alternatives, which I will present in order of efficiency:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Use \texttt{conflict\_prefer("function",\ "package\_prefered")} from the ``conflicted'' package to specify in the R session, which package you always want in regards to that function. So for instance, if I say \texttt{conflicted::conflict\_prefer("filter",\ "dplyr")}, R will now use \texttt{filter} from ``dplyr'' in every occasion and the \texttt{filter} function from the package stats will be neglected.
\item
  Use \texttt{package\_name::} before each conflicted function to specify which package you want in regards to that function.
\item
  Detach (un-load) the package you don't won't.
\end{enumerate}

\hypertarget{shortcuts}{%
\section{Shortcuts}\label{shortcuts}}

Here follows a list of useful shortcuts.
Note that these are the ones I can't live without.
There are plenty more, you just have to google them.

\begin{itemize}
\tightlist
\item
  \textbf{Insert the pipe operator (\%\textgreater\%)}: Command + Shift + M on a Mac, or Ctrl + Shift + M on Linux and Windows.\\
\item
  \textbf{Run the current line of code}: Command + Enter on a Mac or Control + Enter on Linux and Windows.\\
\item
  \textbf{Run all lines of code}: Command + A + Enter on a Mac or Control + A + Enter on Linux and Windows.\\
\item
  \textbf{Comment or un-comment lines}: Command + Shift + C on a Mac or Control + Shift + C on Linux and Windows.\\
\item
  \textbf{Insert a new code chunk}: Command + Option + I on a Mac or Control + Alt + I on a Linx and Windows.\\
\end{itemize}

\hypertarget{chunk-settings}{%
\section{Chunk settings}\label{chunk-settings}}

When using R Notebooks or R Markdown, you'll work with code chunks, as explained already.
One important thing to know is that these chunks are adjustable, and these adjustments are both easy to make and can come in handy when compiling your code.
These adjustments are made on the top part of the chunk that is between \texttt{\{\}}.
So for instance, in a normal chunk you have the top portion as ``\{r\}''.
The first parameter tells you which language you are coding in, which in this case is R.
If you are wondering, yes you can change the setting to code in other languages depending if you have them installed and configured with RStudio (e.g., ``\texttt{\{python\}}'').
Besides the language, you can change plenty of parameters.
They have to be separated only by commas.
Below are some brief examples of the ones I most commonly use (all of which, except ``fig.width'' and ``fig.height'' are defaulted to TRUE if you don't set them):

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{include\ =\ FALSE} : Runs the code, but does not include the code and the results in the finished file.
\item
  \texttt{echo\ =\ FALSE} : Runs the code, but does not include the code in the finished file (but it includes the results).
\item
  \texttt{message\ =\ FALSE} : Prevents messages generated by the code from appearing.
\item
  \texttt{warning\ =\ FALSE} : Prevents warnings generated by the code from appearing.
\item
  \texttt{fig.width\ =\ "width\_in\_pix"} and \texttt{fig.height\ =\ "height\_in\_pix"} : Set the width and height of the picture/plot.
\end{enumerate}

For more details go to: \url{https://rmarkdown.rstudio.com/lesson-3.html}

\hypertarget{code-completion}{%
\section{Code completion}\label{code-completion}}

When you begin to type, R will pop up suggestions as to what you want to write.
These can be names of functions, variables or data frames for example.
You can press TAB to select and let R auto-fill or just click on it with your mouse.

\hypertarget{other-useful-features}{%
\section{Other useful features}\label{other-useful-features}}

Pressing CTRL + F will open up the find/replace menu at the top of your script screen.
This can be immensely useful for you to find, and specially, replace lots of things within a portion (the portion you have selected) or the whole code (if you have no code selected).

\hypertarget{getting-help}{%
\section{Getting help}\label{getting-help}}

To get help you have several options, which depend a lot on which type of help you need.\\

If you want to know what arguments a functions requires, you can write its name and, and having your writing bar inside the ``()'' press TAB.

If you need generic help about a function - what arguments go where, or, for instance, what does ``na.rm'' mean in that function - you can use the command \texttt{?function\_name()} in which ``function\_name'' is the name of your function.
This will pop up a help menu regarding that function that will appear on your help panel (bottom right).
You can also click ``F1'' while your cursor is over the function name.
Depending on the function and its respective documentation this help can either be good or poor.

If you need further help, or need help in problems that are not just concerned about a single function, you will want an internet connection.
Having google searching skills will help lots with your R programming.\\

A few notes and advices:\\
- Search your problem using English language.\\

\begin{itemize}
\item
  Search your problem in a generic way using proper searching language (don't write sentences, write the most relevant words of the problem).\\
\item
  If its an error just post the error message on google.\\
\end{itemize}

Don't be afraid or let down if you need to use google to help you with stuff you learned but just don't remember.
Its normal, trust me.

\hypertarget{using-ai-to-help-you}{%
\section{Using AI to help you}\label{using-ai-to-help-you}}

As of its recent ``debut'', another important tool you should consider is \href{https://openai.com/blog/chatgpt/}{ChatGPT} by \href{https://openai.com}{OpenAI}.
If you haven't already come across it (launched November 2022), ChatGPT is a chatbot language model.
Don't be discouraged by this wording, its, to say the least, google on steroids, and is particularly useful for programming.
However, I cannot emphasize how this is underselling it.
I truly encourage you to explore it yourself, and use it as a companion when coding in R.
But I would advise some caution when using it, since it can give a false sense of confidence (answers are usually correct, by can lead to mistakes).
You should always use your good judgment and search for other helpful tips across the internet.

\hypertarget{further-reading}{%
\section{Further reading}\label{further-reading}}

Need a more in-depth fundamentals of R?
See the links below:\\
\url{https://www.evamariakiss.de/tutorial/r/}

\url{https://www.youtube.com/watch?v=_V8eKsto3Ug\&ab_channel=freeCodeCamp.org}

\hypertarget{r---dealing-with-data}{%
\chapter{R - Dealing with data}\label{r---dealing-with-data}}

\hypertarget{opening-files}{%
\section{Opening files}\label{opening-files}}

\textbf{Before opening the data}\\
First, you need to tell R where the files are located.
He is lazy that way, and will not look everywhere on your computer for them.
So, tell him by using the command \texttt{setwd()}.

\textbf{Reading the data}\\
Usually, when using R, you want to work with data.
This data is usually already there and you want to open it in R.
The good thing is that R can read just about anything (just google ``read''file type'' in R'' on google).
Here I show you how to read some of the most common formats.
Be sure to install the \texttt{xlsx} and \texttt{haven} packages to open Excel and SPSS files, respectively.
Additionally, there are multiple ways to read the same file.
Some will be built in R itself, others will require external packages.
This is important to know because some functions, although working, may be outdated or just give you some sort of weird error.
Maybe you can overcome this by using a different package.

If you want to import/read an Excel file, just use:\\
\texttt{read.xlsx(file\ =\ \textquotesingle{}example.xlsx\textquotesingle{},\ sheetName\ =\ \textquotesingle{}page\_1\textquotesingle{},\ header\ =\ TRUE)} (xlsx package)\\
If a text\\
\texttt{read.delim(file\ =\ \textquotesingle{}example.txt\textquotesingle{},\ header\ =\ TRUE,\ sep\ =\ \textquotesingle{},\textquotesingle{},\ dec\ =\ \textquotesingle{}.\textquotesingle{})}\strut \\
CSV:\\
\texttt{read.csv(file\ =\ \textquotesingle{}example.csv\textquotesingle{},\ header\ =\ TRUE,\ sep\ =\ \textquotesingle{},\textquotesingle{},\ dec\ =\ \textquotesingle{}.\textquotesingle{})}\strut \\
SAV (SPSS):\\
\texttt{read\_sav(file\ =\ \textquotesingle{}example.sav\textquotesingle{})} (haven package)

\textbf{Managing your imported data}\\
To have your data in your environment, so that you can mess with it, you should assign your \texttt{read} command to a variable (object).
Lets say you do the following \texttt{mydata\ \textless{}-\ read.delim(file\ =\ \textquotesingle{}example.txt\textquotesingle{},\ header\ =\ TRUE,\ sep\ =\ \textquotesingle{},\textquotesingle{},\ dec\ =\ \textquotesingle{}.\textquotesingle{})}.
Now, your \texttt{mydata} object is the dataframe containing that imported data set.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{\textquotesingle{}data/heart/heart\_2020\_cleaned.csv\textquotesingle{}}\NormalTok{, }\AttributeTok{sep =} \StringTok{\textquotesingle{},\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbf{Possible problems}\\
You may encounter several problems.
Here are a few of the most common error messages you will face when importing data to R.

\begin{itemize}
\tightlist
\item
  ``the number of columns is superior to the data'' or the data is all jumbled.
\end{itemize}

Perhaps one of the most common problems.
This probably has to due with R separating columns where it shouldn't and making more columns than it should.
You can fix this perhaps by making sure the \texttt{sep} command is specifying the exact separator of the file.
It helps to open the file with excel, for instance, and check the separator and the decimals symbol (you don't want to be separating columns by the decimal symbol).
For instance, sometimes R reads the .csv file (which means comma separated file) and you have commas as decimals (instead ``;'' is the separator).
This creates way to many columns that mismatch the number of headers present.

\begin{itemize}
\tightlist
\item
  cannot open file `name\_of\_file.csv': No such file or directory.
\end{itemize}

Make sure you are in the right working directory or are specifying the path correctly.

There will surely be more problems, but you can find a way around them by using google.

\textbf{Checking the data}\\
After you've opened the data, you should take a peak at it.
There's several ways of doing this such as \texttt{head(df)} or some others I'm not recalling at the moment.
Lets see bellow.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(mydata)}

\CommentTok{\# you can add a "," and say the number of rows you want to preview}
\FunctionTok{head}\NormalTok{(mydata, }\DecValTok{10}\NormalTok{) }

\CommentTok{\# Or you can just View it all}
\CommentTok{\#View(mydata)}
\end{Highlighting}
\end{Shaded}

\hypertarget{opening-multiple-files}{%
\section{Opening multiple files}\label{opening-multiple-files}}

Lets say you have a folder, lets assume is named ``data'', and in there you have all your data files (files from each participant).
Ideally, to analyze and view the data as a whole, you would want to import all of the data files, and then merge them into a big data file, containing all the participants (identified accordingly).\\

Here's a snippet of code that would allow you to do that.
Beware though, any file that matches the criteria (in this case ``.csv'' files) will be gathered from the folder (your working directory).

Firstly, lets gather the names of the files in our directory that we want to import.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Setting our working directory}
\FunctionTok{setwd}\NormalTok{(}\StringTok{\textquotesingle{}C:/Users/fabio/OneDrive/My Things/Stats/Teaching/R\_Book/data\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Look for ".csv" files}
\NormalTok{files }\OtherTok{\textless{}{-}} \FunctionTok{list.files}\NormalTok{(}\AttributeTok{pattern =} \StringTok{"*.csv"}\NormalTok{)}

\CommentTok{\# See how many were read}
\FunctionTok{cat}\NormalTok{(}\StringTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}n}\StringTok{Total number of files processed:\textquotesingle{}}\NormalTok{, }\FunctionTok{length}\NormalTok{(files))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Total number of files processed: 10
\end{verbatim}

Now lets create a dataframe and join each file into it.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Setting our working directory}
\FunctionTok{setwd}\NormalTok{(}\StringTok{\textquotesingle{}C:/Users/fabio/OneDrive/My Things/Stats/Teaching/R\_Book/data\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Creating an empty data frame}
\NormalTok{d }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{()}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in}\NormalTok{ files)\{}
\NormalTok{  temp }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(i) }\CommentTok{\# Reading each file}
\NormalTok{  d }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(d, temp)  }\CommentTok{\# Binding (by row) each file into our data frame}
\NormalTok{\}}

\CommentTok{\# Preview}
\FunctionTok{head}\NormalTok{(d)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Participant_ID   Condition       RT
## 1              1 Condition_1 1.478651
## 2              1 Condition_1 1.495121
## 3              1 Condition_1 1.506271
## 4              1 Condition_1 1.561987
## 5              1 Condition_1 1.508967
## 6              1 Condition_1 1.512732
\end{verbatim}

Alternatively, you might just want to read/import each file into R, without merging them.
For that you can use this bit of code.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Setting our working directory}
\FunctionTok{setwd}\NormalTok{(}\StringTok{\textquotesingle{}C:/Users/fabio/OneDrive/My Things/Stats/Teaching/R\_Book/data\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Loop through each CSV file and read into a data frame}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in}\NormalTok{ files) \{}
  \CommentTok{\# Read CSV file into a data frame with the same name as the file}
  \FunctionTok{assign}\NormalTok{(}\FunctionTok{sub}\NormalTok{(}\StringTok{".csv"}\NormalTok{, }\StringTok{""}\NormalTok{, i), }\FunctionTok{read.csv}\NormalTok{(i))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{merging}{%
\section{Merging}\label{merging}}

You can join two data frames either by rows or by columns.
Typically, you use rows when you try too join more data to your current data frame.
To do so, you can use \texttt{rbind()}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Splitting the data by rows}
\NormalTok{d1 }\OtherTok{\textless{}{-}}\NormalTok{ USArrests[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{20}\NormalTok{, ]}
\NormalTok{d2 }\OtherTok{\textless{}{-}}\NormalTok{ USArrests[}\DecValTok{21}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(USArrests), ]}

\CommentTok{\# Creating a new dataframe with the merged data}
\NormalTok{merged\_d }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(d1, d2)}
\end{Highlighting}
\end{Shaded}

More frequently, perhaps, you want to join complementary information (more variables) to your preexisting data.
To do so, you can use \texttt{cbind()}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Splitting the data by columns}
\NormalTok{d1 }\OtherTok{\textless{}{-}}\NormalTok{ USArrests[, }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{)]}
\NormalTok{d2 }\OtherTok{\textless{}{-}}\NormalTok{ USArrests[, }\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{)]}

\CommentTok{\# Creating a new dataframe with the merged data}
\NormalTok{merged\_d }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(d1, d2)}
\end{Highlighting}
\end{Shaded}

However, this above code only works correctly (as intended) if your data is perfectly lined up.
For instance, \texttt{rbind()} will work if you have the same number of variables (columns), with the same names and in the same positions.
So you need to be sure this is the case before you merge the data frames.

As for \texttt{cbind()} on the other hand, it requires you to have the same number of entries (rows) and for these to be arranged in the same manner (otherwise your info would mismatch).
You can try and order things correctly, but you can easily place some information incorrectly.
To circumvent this, you can use \texttt{merge()}.
In this command you only have to specify the IDs (e.g., ``sample\_ID'' or ``person\_ID'') that allow R to connect the information in the right place.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Preparing the data}
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ USArrests  }
\NormalTok{d}\SpecialCharTok{$}\NormalTok{State }\OtherTok{\textless{}{-}} \FunctionTok{rownames}\NormalTok{(d)  }
\FunctionTok{rownames}\NormalTok{(d) }\OtherTok{\textless{}{-}} \ConstantTok{NULL}
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ d[, }\FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{)]}

\CommentTok{\# Creating two separate dataframes}
\NormalTok{d1 }\OtherTok{\textless{}{-}}\NormalTok{ d[, }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)]}
\NormalTok{d2 }\OtherTok{\textless{}{-}}\NormalTok{ d[, }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Joining dataframes by the "State" column}
\NormalTok{d\_all }\OtherTok{\textless{}{-}} \FunctionTok{merge}\NormalTok{(}\AttributeTok{x =}\NormalTok{ d1, }\AttributeTok{y =}\NormalTok{ d2, }\AttributeTok{by =} \StringTok{\textquotesingle{}State\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Now lets say the data frames weren't perfectly matched.
For instance lets say we remove Alabama from \texttt{d1}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d1 }\OtherTok{\textless{}{-}}\NormalTok{ d1[}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, ]  }\CommentTok{\# Removing Alabama}

\CommentTok{\# Merging}
\NormalTok{d\_all }\OtherTok{\textless{}{-}} \FunctionTok{merge}\NormalTok{(}\AttributeTok{x =}\NormalTok{ d1, }\AttributeTok{y =}\NormalTok{ d2, }\AttributeTok{by =} \StringTok{\textquotesingle{}State\textquotesingle{}}\NormalTok{)  }\CommentTok{\# adds only what matches}
\NormalTok{d\_all }\OtherTok{\textless{}{-}} \FunctionTok{merge}\NormalTok{(}\AttributeTok{x =}\NormalTok{ d1, }\AttributeTok{y =}\NormalTok{ d2, }\AttributeTok{by =} \StringTok{\textquotesingle{}State\textquotesingle{}}\NormalTok{, }\AttributeTok{all =} \ConstantTok{TRUE}\NormalTok{)  }\CommentTok{\# adds everything}

\FunctionTok{head}\NormalTok{(d\_all)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        State UrbanPop Murder Assault Rape
## 1    Alabama       NA   13.2     236 21.2
## 2     Alaska       48   10.0     263 44.5
## 3    Arizona       80    8.1     294 31.0
## 4   Arkansas       50    8.8     190 19.5
## 5 California       91    9.0     276 40.6
## 6   Colorado       78    7.9     204 38.7
\end{verbatim}

Now you check the \texttt{d\_all} you will see that there is no Alabama.
You can use the parameter \texttt{all} or \texttt{all.x} or \texttt{all.y} to indicate if you want all of the rows in the data frames (either all or just the x or y data frames, respectively) to be added to the final data frame.
If so, as you can see, Alabama is also imported, even thought there is \texttt{NA} in the in one of the fields (because even though its not in d1, it is in the d2 data frame).
There are other parameters that can be tweaked for more specific scenarios, just run \texttt{?merge()} to explore the function and its parameters.

\hypertarget{exporting}{%
\section{Exporting}\label{exporting}}

Aside from importing, sometimes we also want to export the files we created/modified in R.
We can do this with several commands, but perhaps the simpler ones are:

\texttt{write.table(x\ =\ df,\ file\ =\ \textquotesingle{}namewewant.txt\textquotesingle{},\ sep\ =\ \textquotesingle{},\textquotesingle{},\ dec\ =\ \textquotesingle{}.\textquotesingle{})}

This tells R to export the \texttt{df} dataframe, to a not existing file with a name ``namewewant.txt'', that is separated by commas and has ``.'' for decimal points.
We can also export to an existing data file, and ask for \texttt{append\ =\ TRUE}, thus appending our data to the data already existing in that file.
Be sure thought, that this data has the same structure (e.g., number of columns, position of the columns).

We can also do the same thing as above, but instead create a ``.csv'' file.

\texttt{write.csv(x\ =\ df,\ file\ =\ \textquotesingle{}namewewant.csv\textquotesingle{})}

As an example, lets export the dataframe we created in the chunks above.
Note that if we don't specify the path along with the name of the file to be created, R will save the file to the current working directory.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Tells the path I want to export to.}
\NormalTok{path }\OtherTok{=} \StringTok{\textquotesingle{}C:/Users/fabio/OneDrive/My Things/Stats/Teaching/R\_Book/\textquotesingle{}}

\CommentTok{\# Merges the path with the file name I want to give it.}
\NormalTok{filename }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(path, }\StringTok{\textquotesingle{}some\_data.csv\textquotesingle{}}\NormalTok{, }\AttributeTok{sep =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Export it}
\FunctionTok{write.csv}\NormalTok{(}\AttributeTok{x =}\NormalTok{ d\_all, }\AttributeTok{file =}\NormalTok{ filename)}
\end{Highlighting}
\end{Shaded}

\hypertarget{special-cases-in-r}{%
\section{Special cases in R}\label{special-cases-in-r}}

In R variables, but more specifically on data frames, you can encounter the following default symbols:

\begin{itemize}
\item
  \textbf{NA}: Not Available (i.e., missing value)
\item
  \textbf{NaN}: Not a Number (e.g., 0/0)
\item
  \textbf{Inf} e \textbf{-Inf}: Infinity
\end{itemize}

These are special categories of values and can mess up your transformations and functions.
We will talk about them more in the next chapter.

\hypertarget{manipulating-the-data-in-dataframes}{%
\section{Manipulating the data in dataframes}\label{manipulating-the-data-in-dataframes}}

Now, in R you can manage your dataframe as you please.
You can do anything.
And I truly mean anything.
Anything you can do in Excel and then some.

\hypertarget{subsetting-a-dataframe}{%
\subsection{Subsetting a dataframe}\label{subsetting-a-dataframe}}

Subsetting is a very important skill that you should try to master.
It allows you to select only the portions of your data frame that you want.
This is vital for any type of data manipulation and cleaning you try to accomplish.

The symbols \texttt{\$} lets you subset (select) columns of a dataframe really easily, if you just want a column.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris}

\NormalTok{df}\SpecialCharTok{$}\NormalTok{Sepal.Length}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] 5.1 4.9 4.7 4.6 5.0 5.4 4.6 5.0 4.4 4.9 5.4 4.8 4.8 4.3 5.8 5.7 5.4 5.1
##  [19] 5.7 5.1 5.4 5.1 4.6 5.1 4.8 5.0 5.0 5.2 5.2 4.7 4.8 5.4 5.2 5.5 4.9 5.0
##  [37] 5.5 4.9 4.4 5.1 5.0 4.5 4.4 5.0 5.1 4.8 5.1 4.6 5.3 5.0 7.0 6.4 6.9 5.5
##  [55] 6.5 5.7 6.3 4.9 6.6 5.2 5.0 5.9 6.0 6.1 5.6 6.7 5.6 5.8 6.2 5.6 5.9 6.1
##  [73] 6.3 6.1 6.4 6.6 6.8 6.7 6.0 5.7 5.5 5.5 5.8 6.0 5.4 6.0 6.7 6.3 5.6 5.5
##  [91] 5.5 6.1 5.8 5.0 5.6 5.7 5.7 6.2 5.1 5.7 6.3 5.8 7.1 6.3 6.5 7.6 4.9 7.3
## [109] 6.7 7.2 6.5 6.4 6.8 5.7 5.8 6.4 6.5 7.7 7.7 6.0 6.9 5.6 7.7 6.3 6.7 7.2
## [127] 6.2 6.1 6.4 7.2 7.4 7.9 6.4 6.3 6.1 7.7 6.3 6.4 6.0 6.9 6.7 6.9 5.8 6.8
## [145] 6.7 6.7 6.3 6.5 6.2 5.9
\end{verbatim}

If you want more columns, you can use \texttt{{[}{]}}.
By indicating \texttt{df{[}rows,columns{]}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[ , }\StringTok{\textquotesingle{}Sepal.Length\textquotesingle{}}\NormalTok{]  }\CommentTok{\# just the "Sepal.Length]"}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] 5.1 4.9 4.7 4.6 5.0 5.4 4.6 5.0 4.4 4.9 5.4 4.8 4.8 4.3 5.8 5.7 5.4 5.1
##  [19] 5.7 5.1 5.4 5.1 4.6 5.1 4.8 5.0 5.0 5.2 5.2 4.7 4.8 5.4 5.2 5.5 4.9 5.0
##  [37] 5.5 4.9 4.4 5.1 5.0 4.5 4.4 5.0 5.1 4.8 5.1 4.6 5.3 5.0 7.0 6.4 6.9 5.5
##  [55] 6.5 5.7 6.3 4.9 6.6 5.2 5.0 5.9 6.0 6.1 5.6 6.7 5.6 5.8 6.2 5.6 5.9 6.1
##  [73] 6.3 6.1 6.4 6.6 6.8 6.7 6.0 5.7 5.5 5.5 5.8 6.0 5.4 6.0 6.7 6.3 5.6 5.5
##  [91] 5.5 6.1 5.8 5.0 5.6 5.7 5.7 6.2 5.1 5.7 6.3 5.8 7.1 6.3 6.5 7.6 4.9 7.3
## [109] 6.7 7.2 6.5 6.4 6.8 5.7 5.8 6.4 6.5 7.7 7.7 6.0 6.9 5.6 7.7 6.3 6.7 7.2
## [127] 6.2 6.1 6.4 7.2 7.4 7.9 6.4 6.3 6.1 7.7 6.3 6.4 6.0 6.9 6.7 6.9 5.8 6.8
## [145] 6.7 6.7 6.3 6.5 6.2 5.9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[}\DecValTok{5}\NormalTok{, ]   }\CommentTok{\# row 5 across all columns}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 5            5         3.6          1.4         0.2  setosa
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[}\DecValTok{1}\NormalTok{, }\StringTok{\textquotesingle{}Sepal.Length\textquotesingle{}}\NormalTok{]  }\CommentTok{\# row 1 of the "Sepal.Length" column}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5.1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Sepal.Length\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Sepal.Width\textquotesingle{}}\NormalTok{)]  }\CommentTok{\# row 1 to 5 from the Sepal.Length" and "Sepal.Width""}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width
## 1          5.1         3.5
## 4          4.6         3.1
\end{verbatim}

\hypertarget{columns}{%
\subsection{Columns}\label{columns}}

Lets start by some simply manipulations.
Lets say you want to change column names.
Ideally, I would avoid spaces in the headers (and overall actually) but you do as you please.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris  }\CommentTok{\# iris (mtcars) is a built{-}in dataset. Just imagine I\textquotesingle{}m reading from a file}
\CommentTok{\# Option 1}
\FunctionTok{colnames}\NormalTok{(df) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Colname 1\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 2\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 3\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 4\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 5\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Option 2}
\FunctionTok{names}\NormalTok{(df) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Colname 1\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 2\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 3\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 4\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Colname 5\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Or just change a specific column name}
\FunctionTok{colnames}\NormalTok{(df)[}\DecValTok{2}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}Colname 2 {-} New\textquotesingle{}}

\CommentTok{\# Final result}
\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Colname 1 Colname 2 - New Colname 3 Colname 4 Colname 5
## 1       5.1             3.5       1.4       0.2    setosa
## 2       4.9             3.0       1.4       0.2    setosa
## 3       4.7             3.2       1.3       0.2    setosa
## 4       4.6             3.1       1.5       0.2    setosa
## 5       5.0             3.6       1.4       0.2    setosa
## 6       5.4             3.9       1.7       0.4    setosa
\end{verbatim}

We can also change the order of the columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris }\CommentTok{\# Just restoring the dataframe to be less confusing}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[ ,}\FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{)]  }\CommentTok{\# 5 column shows up first now, followed by the previous first column, etc...}

\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Species Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1  setosa          5.1         3.5          1.4         0.2
## 2  setosa          4.9         3.0          1.4         0.2
## 3  setosa          4.7         3.2          1.3         0.2
## 4  setosa          4.6         3.1          1.5         0.2
## 5  setosa          5.0         3.6          1.4         0.2
## 6  setosa          5.4         3.9          1.7         0.4
\end{verbatim}

We can sort by a specific (or multiple columns).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[}\FunctionTok{order}\NormalTok{(df[, }\DecValTok{2}\NormalTok{]), ]  }\CommentTok{\# Orders by second column}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[}\FunctionTok{order}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{df[, }\DecValTok{2}\NormalTok{]), ]  }\CommentTok{\# Orders by second column descending}

\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[}\FunctionTok{order}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{df[, }\DecValTok{2}\NormalTok{], df[, }\DecValTok{3}\NormalTok{]), ]  }\CommentTok{\# Orders by second columns descending and then by third column}

\CommentTok{\# Alternatively since this is a bit confusing (does the same as above, respectively)}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{arrange}\NormalTok{(df, Sepal.Length)}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{arrange}\NormalTok{(df, }\FunctionTok{desc}\NormalTok{(Sepal.Length))}

\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{arrange}\NormalTok{(df, }\FunctionTok{desc}\NormalTok{(Sepal.Length), Sepal.Width)}
\end{Highlighting}
\end{Shaded}

We can create new columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{new\_data }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\StringTok{\textquotesingle{}New info\textquotesingle{}}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(df))  }\CommentTok{\# Creating new irrelevant data}

\NormalTok{df}\SpecialCharTok{$}\NormalTok{NewColumn }\OtherTok{\textless{}{-}}\NormalTok{ new\_data}

\NormalTok{df}\SpecialCharTok{$}\NormalTok{NewColumn }\OtherTok{\textless{}{-}}\NormalTok{ new\_data  }\CommentTok{\# Added this data (data must have same length as dataframe!)}
\end{Highlighting}
\end{Shaded}

We can remove columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{Petal.Length }\OtherTok{\textless{}{-}} \ConstantTok{NULL}
\CommentTok{\# or}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{within}\NormalTok{(df, }\FunctionTok{rm}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

And we can create and transform the columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris}

\NormalTok{df}\SpecialCharTok{$}\NormalTok{Sepal\_Area }\OtherTok{\textless{}{-}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Sepal.Length }\SpecialCharTok{*}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Sepal.Width  }\CommentTok{\# Creating new variable with is the multiplication of the first 2.}

\NormalTok{df}\SpecialCharTok{$}\NormalTok{Sepal\_Area }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Sepal\_Area, }\DecValTok{1}\NormalTok{)  }\CommentTok{\# Transforming existing variable, making it just 1 decimal.}

\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species Sepal_Area
## 1          5.1         3.5          1.4         0.2  setosa       17.8
## 2          4.9         3.0          1.4         0.2  setosa       14.7
## 3          4.7         3.2          1.3         0.2  setosa       15.0
## 4          4.6         3.1          1.5         0.2  setosa       14.3
## 5          5.0         3.6          1.4         0.2  setosa       18.0
## 6          5.4         3.9          1.7         0.4  setosa       21.1
\end{verbatim}

\hypertarget{rows}{%
\subsection{Rows}\label{rows}}

Altering specific rows is a bit trickier.
Fortunatelly, this is usually less relevant, since we usually just want to change or apply a condition to an entire column.
Having said this, here's some relevant commands.

Say you want to alter rows that meet a condition.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{Sepal.Length[df}\SpecialCharTok{$}\NormalTok{Sepal.Length }\SpecialCharTok{\textless{}=} \DecValTok{5}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}\textless{}4\textquotesingle{}}  \CommentTok{\# Any value in in the Sepal.Length column that is less or equal than five will turn to 0}

\NormalTok{df}\SpecialCharTok{$}\NormalTok{Sepal.Length[df}\SpecialCharTok{$}\NormalTok{Sepal.Length }\SpecialCharTok{==} \FloatTok{7.9}\NormalTok{] }\OtherTok{\textless{}{-}} \DecValTok{8}  \CommentTok{\# Changing rows with 7.9 to 8. }

\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species Sepal_Area
## 1          5.1         3.5          1.4         0.2  setosa       17.8
## 2           <4         3.0          1.4         0.2  setosa       14.7
## 3           <4         3.2          1.3         0.2  setosa       15.0
## 4           <4         3.1          1.5         0.2  setosa       14.3
## 5           <4         3.6          1.4         0.2  setosa       18.0
## 6          5.4         3.9          1.7         0.4  setosa       21.1
\end{verbatim}

Or want to create a new entry (i.e., row).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{row }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FloatTok{5.6}\NormalTok{, }\FloatTok{3.2}\NormalTok{, }\FloatTok{1.9}\NormalTok{, }\FloatTok{0.1}\NormalTok{, }\StringTok{\textquotesingle{}new\_species\textquotesingle{}}\NormalTok{, }\DecValTok{10000}\NormalTok{)  }\CommentTok{\# Create a new row (all columns must be filled)}
\FunctionTok{colnames}\NormalTok{(row) }\OtherTok{\textless{}{-}} \FunctionTok{colnames}\NormalTok{(df)}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(df, row)}

\FunctionTok{tail}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     Sepal.Length Sepal.Width Petal.Length Petal.Width     Species Sepal_Area
## 146          6.7         3.0          5.2         2.3   virginica       20.1
## 147          6.3         2.5          5.0         1.9   virginica       15.8
## 148          6.5         3.0          5.2         2.0   virginica       19.5
## 149          6.2         3.4          5.4         2.3   virginica       21.1
## 150          5.9         3.0          5.1         1.8   virginica       17.7
## 151          5.6         3.2          1.9         0.1 new_species    10000.0
\end{verbatim}

Or just want to delete a row.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(}\DecValTok{151}\NormalTok{, }\DecValTok{152}\NormalTok{),]  }\CommentTok{\# deletes row 152 and 152}
\end{Highlighting}
\end{Shaded}

If you want a package that allows you to do the above changes in rows and columns just like you would in Excel, you can too.
Just visit: \url{https://cran.r-project.org/web/packages/DataEditR/vignettes/DataEditR.html}

Although I would argue against it, since this doesn't make your R code easy to re-execute.

\hypertarget{tidyverse-pipes}{%
\subsection{Tidyverse \& Pipes}\label{tidyverse-pipes}}

Before presenting the following commands below, we should talk quickly about tidyverse and pipes.
Tidyverse, as the name implies ``Tidy'' + ``{[}Uni{]}verse'' is a big package that contains more packages.
All of these packages are designed for data science.
These are:

\begin{itemize}
\item
  \textbf{dplyr}: Basic grammar for data manipulation (also responsible for pipes).
\item
  \textbf{ggplot2}: Used to create all sorts of graphics.
\item
  \textbf{forcats}: Facilitates functional programming for data science (e.g., can replace loops with maps, a simpler command)
\item
  \textbf{tibble}: Better dataframe, making it cleaner and more efficient (although they are mostly interchangeable).
\item
  \textbf{readr}: Reads data of several types in a smart manner (including csv).
\item
  \textbf{stringr}: Makes working with string information easy.
\item
  \textbf{tidyr}: Helps to tidy data presentation.
\item
  \textbf{purr}: Makes handling factors (categorical variables) easier.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'tidyverse' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'ggplot2' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'tidyr' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'readr' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'purrr' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'dplyr' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'stringr' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'forcats' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'lubridate' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
## v dplyr     1.1.0     v readr     2.1.4
## v forcats   1.0.0     v stringr   1.5.0
## v ggplot2   3.4.1     v tibble    3.1.8
## v lubridate 1.9.2     v tidyr     1.3.0
## v purrr     1.0.1     
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
## i Use the ]8;;http://conflicted.r-lib.org/conflicted package]8;; to force all conflicts to become errors
\end{verbatim}

As you can see by the output you get when you load it, it basically loads them all making in a single line.

Now onto pipes.
Basically this allow you to chain your commands.
It comes from the \texttt{dplyr} or \texttt{magritrr} packages.
It can be read as follows:

\texttt{WITH\ THIS\ \%\textgreater{}\%\ EXECUTE\ THIS\ \%\textgreater{}\%\ THEN\ EXECUTE\ THIS\ \%\textgreater{}\%\ THEN\ THIS}

So instead of this:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{object1 }\OtherTok{\textless{}{-}} \FunctionTok{function\_1}\NormalTok{(object\_original)}
\NormalTok{object2 }\OtherTok{\textless{}{-}} \FunctionTok{function\_2}\NormalTok{(object1)}
\NormalTok{object3 }\OtherTok{\textless{}{-}} \FunctionTok{function\_3}\NormalTok{(object2)}

\CommentTok{\# or}
\NormalTok{object }\OtherTok{\textless{}{-}} \FunctionTok{function\_3}\NormalTok{(}\FunctionTok{function\_2}\NormalTok{(}\FunctionTok{function\_1}\NormalTok{(object)))}
\end{Highlighting}
\end{Shaded}

We can instead have this

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{object }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{function\_1}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{function\_2}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{function\_3}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Here are two concrete examples:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  With 4+4, add another 4.
  \texttt{4+4\ \%\textgreater{}\%\ +4}
\item
  With my dataframe (df), select its ``column1'' and then calculate the mean.
  \texttt{df\ \%\textgreater{}\%\ select(column1)\ \%\textgreater{}\%\ mean()}
\end{enumerate}

Remember, you can call this pipe command by pressing ``CTRL \& SHIFT + M'' in Windows and Command + Shift + M on a Mac.

You may find it weird at first, but trust me, it will become intuitive in no time.

If you want a better tutorial on pipes just visit the following link: \url{https://www.datacamp.com/community/tutorials/pipe-r-tutorial}

\hypertarget{filtering}{%
\subsection{Filtering}\label{filtering}}

Now, lets say we want to \textbf{filter} the dataframe.
That is, we want to select our data based on some criteria.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris}
\CommentTok{\#We can filter by Species. In this case we are only selecting "setosa".}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(Species }\SpecialCharTok{==} \StringTok{\textquotesingle{}setosa\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Or we can select "everything but".}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(Species }\SpecialCharTok{!=} \StringTok{\textquotesingle{}setosa\textquotesingle{}}\NormalTok{)}

\CommentTok{\# And we can even select multiple things}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(Species }\SpecialCharTok{!=} \StringTok{\textquotesingle{}setosa\textquotesingle{}} \SpecialCharTok{\&}\NormalTok{ Sepal.Length }\SpecialCharTok{\textgreater{}} \FloatTok{7.5}\NormalTok{)}

\CommentTok{\# We can also select one "OR" the other}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(Species }\SpecialCharTok{!=} \StringTok{\textquotesingle{}setosa\textquotesingle{}} \SpecialCharTok{|}\NormalTok{ Sepal.Length }\SpecialCharTok{\textgreater{}} \FloatTok{7.5}\NormalTok{)}

\CommentTok{\# We can remove NAs}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(Species))}
\end{Highlighting}
\end{Shaded}

\hypertarget{arranging}{%
\subsection{Arranging}\label{arranging}}

We can \textbf{arrange} the dataframe as we wish.
We can sort by just 1 column or more.
In the latter case the second, third and so on variables will break the ties.
Missing values are sorted to the end.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# It defaults as ascending}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(Sepal.Length)}

\CommentTok{\# We can make it descending:}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

\hypertarget{selecting}{%
\subsection{Selecting}\label{selecting}}

Another useful trick is to \textbf{select} columns.
With this command we can select the columns we want, or do not want.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Selecting Sepal.Lenght and Species columns}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Sepal.Length, Species)}

\CommentTok{\# We can also select multiple columns by saying from x to y:}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Sepal.Length}\SpecialCharTok{:}\NormalTok{Species)}

\CommentTok{\# To select everything but:}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(Sepal.Length, Species))}
\end{Highlighting}
\end{Shaded}

\hypertarget{mutating}{%
\subsection{Mutating}\label{mutating}}

To create new columns (or modify existing ones), we can use \textbf{mutate}.
This a versatile command that allows you to do several things.
Here are a bunch of examples:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create a new column with just the string "word" on it.}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{WordColumn =} \StringTok{\textquotesingle{}word\textquotesingle{}}\NormalTok{) }

\CommentTok{\# Create a combination of two columns}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{TwoColsTogether =} \FunctionTok{paste}\NormalTok{(Species, WordColumn))}

\CommentTok{\# Create the sum of two columns}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{SumOfCols =}\NormalTok{ Petal.Length }\SpecialCharTok{+}\NormalTok{ Petal.Width)}

\CommentTok{\# Among others}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Times100 =}\NormalTok{ Petal.Length}\SpecialCharTok{*}\DecValTok{100}\NormalTok{)}

\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{DividedBy2 =}\NormalTok{ Petal.Width}\SpecialCharTok{/}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ifelse}{%
\subsection{Ifelse}\label{ifelse}}

\texttt{ifelse()} is a base function of R (not from tidyverse, altough you have \texttt{if\_else()} from tidyverse which works and does exactly the same thing), but it fits quite well with its workflow.
Specifically it fits quite well with the \texttt{mutate()} command.
What it basically says is: \texttt{if\ THIS\_CONDITION\_IS\_MET\ then\ DO\_CASE\_1\ otherwise\ DO\_CASE\_2}.
The function will look like this: \texttt{ifelse(THIS\_CONDITION\_IS\_MET,\ DO\_CASE\_1,\ DO\_CASE\_2)}.
Lets look at some examples below.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris}

\CommentTok{\# Replacing for just 1 condition.}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{SpeciesAlt =} \FunctionTok{ifelse}\NormalTok{(Species }\SpecialCharTok{==} \StringTok{\textquotesingle{}setosa\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Specie1\textquotesingle{}}\NormalTok{, Species)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{head}\NormalTok{()  }\CommentTok{\# just to show the first 5 rows for the purpose of demonstration.}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species SpeciesAlt
## 1          5.1         3.5          1.4         0.2  setosa    Specie1
## 2          4.9         3.0          1.4         0.2  setosa    Specie1
## 3          4.7         3.2          1.3         0.2  setosa    Specie1
## 4          4.6         3.1          1.5         0.2  setosa    Specie1
## 5          5.0         3.6          1.4         0.2  setosa    Specie1
## 6          5.4         3.9          1.7         0.4  setosa    Specie1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Replacing for 3 conditions (Gets a bit chaotic)}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{SpeciesAlt =} \FunctionTok{ifelse}\NormalTok{(Species }\SpecialCharTok{==} \StringTok{\textquotesingle{}setosa\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Specie1\textquotesingle{}}\NormalTok{, }
                             \FunctionTok{ifelse}\NormalTok{(Species }\SpecialCharTok{==} \StringTok{\textquotesingle{}versicolor\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Specie2\textquotesingle{}}\NormalTok{,}
                                    \FunctionTok{ifelse}\NormalTok{(Species }\SpecialCharTok{==} \StringTok{\textquotesingle{}virginica\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Specie3\textquotesingle{}}\NormalTok{, Species)))) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{head}\NormalTok{()  }\CommentTok{\# just to show the first 5 rows for the purpose of demonstration.}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species SpeciesAlt
## 1          5.1         3.5          1.4         0.2  setosa    Specie1
## 2          4.9         3.0          1.4         0.2  setosa    Specie1
## 3          4.7         3.2          1.3         0.2  setosa    Specie1
## 4          4.6         3.1          1.5         0.2  setosa    Specie1
## 5          5.0         3.6          1.4         0.2  setosa    Specie1
## 6          5.4         3.9          1.7         0.4  setosa    Specie1
\end{verbatim}

As you can see, for changing just 1 Species, its quite easy and practical.
But for more than say 2 it starts to get very confusing.

As a simpler alternative, when you deal with plenty of cases, you should use \texttt{recode()}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Recoding all 3 cases}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{SpeciesAlt =} \FunctionTok{recode}\NormalTok{(Species, }\AttributeTok{setosa =} \StringTok{"Specie1"}\NormalTok{,}
                             \AttributeTok{versicolor =} \StringTok{"Specie2"}\NormalTok{, }
                             \AttributeTok{virginica =} \StringTok{\textquotesingle{}Specie3\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{head}\NormalTok{()  }\CommentTok{\# just to show the first 5 rows for the purpose of demonstration.}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species SpeciesAlt
## 1          5.1         3.5          1.4         0.2  setosa    Specie1
## 2          4.9         3.0          1.4         0.2  setosa    Specie1
## 3          4.7         3.2          1.3         0.2  setosa    Specie1
## 4          4.6         3.1          1.5         0.2  setosa    Specie1
## 5          5.0         3.6          1.4         0.2  setosa    Specie1
## 6          5.4         3.9          1.7         0.4  setosa    Specie1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Recoding just 2 and giving all the rest the label "others"}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{SpeciesAlt =} \FunctionTok{recode}\NormalTok{(Species, }\AttributeTok{setosa =} \StringTok{"Specie1"}\NormalTok{,}
                             \AttributeTok{versicolor =} \StringTok{"Specie2"}\NormalTok{, }\AttributeTok{.default =} \StringTok{\textquotesingle{}others\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{head}\NormalTok{()  }\CommentTok{\# just to show the first 5 rows for the purpose of demonstration.}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species SpeciesAlt
## 1          5.1         3.5          1.4         0.2  setosa    Specie1
## 2          4.9         3.0          1.4         0.2  setosa    Specie1
## 3          4.7         3.2          1.3         0.2  setosa    Specie1
## 4          4.6         3.1          1.5         0.2  setosa    Specie1
## 5          5.0         3.6          1.4         0.2  setosa    Specie1
## 6          5.4         3.9          1.7         0.4  setosa    Specie1
\end{verbatim}

As an alternative (since it allows you to make more elaborate conditionals), you can use \texttt{case\_when()}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Recoding all 3 cases}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{SpeciesAlt =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    Species }\SpecialCharTok{==} \StringTok{\textquotesingle{}setosa\textquotesingle{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textquotesingle{}Specie1\textquotesingle{}}\NormalTok{,}
\NormalTok{    Species }\SpecialCharTok{==} \StringTok{\textquotesingle{}versicolor\textquotesingle{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textquotesingle{}Specie2\textquotesingle{}}\NormalTok{,}
\NormalTok{    Species }\SpecialCharTok{==} \StringTok{\textquotesingle{}virginica\textquotesingle{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textquotesingle{}Specie3\textquotesingle{}}
\NormalTok{  )) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{head}\NormalTok{()  }\CommentTok{\# just to show the first 5 rows for the purpose of demonstration.}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species SpeciesAlt
## 1          5.1         3.5          1.4         0.2  setosa    Specie1
## 2          4.9         3.0          1.4         0.2  setosa    Specie1
## 3          4.7         3.2          1.3         0.2  setosa    Specie1
## 4          4.6         3.1          1.5         0.2  setosa    Specie1
## 5          5.0         3.6          1.4         0.2  setosa    Specie1
## 6          5.4         3.9          1.7         0.4  setosa    Specie1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Recoding just 2 and giving all the rest the label "others"}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{SpeciesAlt =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    Species }\SpecialCharTok{==} \StringTok{\textquotesingle{}setosa\textquotesingle{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textquotesingle{}Specie1\textquotesingle{}}\NormalTok{,}
\NormalTok{    Species }\SpecialCharTok{==} \StringTok{\textquotesingle{}versicolor\textquotesingle{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textquotesingle{}Specie2\textquotesingle{}}\NormalTok{,}
    \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \StringTok{\textquotesingle{}others\textquotesingle{}}
\NormalTok{  )) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{head}\NormalTok{()  }\CommentTok{\# just to show the first 5 rows for the purpose of demonstration.}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species SpeciesAlt
## 1          5.1         3.5          1.4         0.2  setosa    Specie1
## 2          4.9         3.0          1.4         0.2  setosa    Specie1
## 3          4.7         3.2          1.3         0.2  setosa    Specie1
## 4          4.6         3.1          1.5         0.2  setosa    Specie1
## 5          5.0         3.6          1.4         0.2  setosa    Specie1
## 6          5.4         3.9          1.7         0.4  setosa    Specie1
\end{verbatim}

\hypertarget{grouping-and-summarizing}{%
\subsection{Grouping and Summarizing}\label{grouping-and-summarizing}}

\texttt{group\_by()} and \texttt{summarise()}, are two very important functions from \texttt{dplyr}.
The first one, in itself, does not do anything.
It is meant to be followed by the latter.

In the \texttt{group\_by(variables)} command you tell R on which variables you want to group your data by specifying the column that contains this (or these) variable(s).
In the example below the only column that makes sense grouping by is \texttt{Species}.
By telling R to group with species, the next command \texttt{summarise()} give a summary output for each category of the \texttt{Species} column.
Lets look at the examples that follow.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris}
\CommentTok{\# Summarising mean Sepal.length by species}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# Grouping by this variable}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Mean\_By\_Species =} \FunctionTok{mean}\NormalTok{(Sepal.Length)) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 2
##   Species    Mean_By_Species
##   <fct>                <dbl>
## 1 setosa                5.01
## 2 versicolor            5.94
## 3 virginica             6.59
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mutate version}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Mean\_By\_Species =} \FunctionTok{mean}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 150 x 6
## # Groups:   Species [3]
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species Mean_By_Species
##           <dbl>       <dbl>        <dbl>       <dbl> <fct>             <dbl>
##  1          5.1         3.5          1.4         0.2 setosa             5.01
##  2          4.9         3            1.4         0.2 setosa             5.01
##  3          4.7         3.2          1.3         0.2 setosa             5.01
##  4          4.6         3.1          1.5         0.2 setosa             5.01
##  5          5           3.6          1.4         0.2 setosa             5.01
##  6          5.4         3.9          1.7         0.4 setosa             5.01
##  7          4.6         3.4          1.4         0.3 setosa             5.01
##  8          5           3.4          1.5         0.2 setosa             5.01
##  9          4.4         2.9          1.4         0.2 setosa             5.01
## 10          4.9         3.1          1.5         0.1 setosa             5.01
## # ... with 140 more rows
\end{verbatim}

You can group by more than one factor and ask for other summaries, such as median, sd, and other basic operations.
For instance:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{count =} \FunctionTok{n}\NormalTok{())  }\CommentTok{\# Gives you the number of entries in each group}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 2
##   Species    count
##   <fct>      <int>
## 1 setosa        50
## 2 versicolor    50
## 3 virginica     50
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Total =} \DecValTok{150}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Percentage =}\NormalTok{ (n}\SpecialCharTok{/}\NormalTok{Total) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 4
## # Groups:   Species [3]
##   Species        n Total Percentage
##   <fct>      <int> <dbl>      <dbl>
## 1 setosa        50   150       33.3
## 2 versicolor    50   150       33.3
## 3 virginica     50   150       33.3
\end{verbatim}

You can then build operations on top of your summaries (like mutations or plots)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Mean\_Length =} \FunctionTok{mean}\NormalTok{(Sepal.Length)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(Species, Mean\_Length)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_col}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-55-1.pdf}

\hypertarget{changing-format-widelong}{%
\subsection{Changing Format (Wide/Long)}\label{changing-format-widelong}}

There are two types of ways that the data can be structured in.
These ways are important for many reasons, not just for the way they look.
Certain analysis, commands or functions used in R prefer (or rather mandate) that the data is in a specific format.
This format can be either \textbf{\emph{wide}} or \textbf{\emph{long}}.

In the wide format each each variable level has a column.
Lets say we are looking at how people rate pictures of happy, angry and neutral people in terms of good looks on a rating of 0-10.
If we were to have the data in a wide format, we would have a data frame with (aside from columns related to the ID of the participant and so forth) 3 columns.
One, labeled ``Ratings\_Happy'' for instance, that would have all the ratings given by each participant to the happy faces, another with the ratings given to the angry faces and another to the neutral faces.
It should look something like this:

However, if we were to have the data in long format, we would instead have just have two columns (aside from the Participant ID and other information columns you might want).
One column, labeled ``Facial\_Expression'' for instance, would have either ``Happy'', ``Angry'' or ``Neutral''.
The other column, labeled ``Rating'', would have the rating given to the face.
Since all of the participants rated every condition, each participant would have 3 entries in the dataframe (hence making it longer).
It should look something like this:

This is quite simple to do actually.
The commands we will be using are \texttt{pivot\_wider} and \texttt{pivot\_longer} and they are quite intuitive.
Lets work through this example.
Lets first say we want to transform data frame from \emph{long} to \emph{wide}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_long }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Participant\_ID =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{,}\AttributeTok{each=}\DecValTok{3}\NormalTok{),}
                      \AttributeTok{Facial\_Expression =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Happy\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Angry\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Neutral\textquotesingle{}}\NormalTok{), }\DecValTok{5}\NormalTok{),}
                      \AttributeTok{Ratings =} \FunctionTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{5}\NormalTok{))}

\CommentTok{\# Transforming}
\NormalTok{df\_wide }\OtherTok{\textless{}{-}}\NormalTok{ df\_long }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{id\_cols =}\NormalTok{ Participant\_ID,  }\CommentTok{\# Condition that identifies the grouping (ID) factor of each entry.}
              \AttributeTok{names\_from =}\NormalTok{ Facial\_Expression,  }\CommentTok{\# Where to find our future column names}
              \AttributeTok{values\_from =}\NormalTok{ Ratings)   }\CommentTok{\# Where are the values that will fill those columns }


\FunctionTok{head}\NormalTok{(df\_wide)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 5 x 4
##   Participant_ID Happy Angry Neutral
##            <int> <dbl> <dbl>   <dbl>
## 1              1     6     4       2
## 2              2     6     4       7
## 3              3     6     5       7
## 4              4     5     8       6
## 5              5     5     8       5
\end{verbatim}

Now doing the reverse, that is, turning the data from the current \emph{wide} format and making it \emph{longer} again.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_long }\OtherTok{\textless{}{-}}\NormalTok{ df\_wide }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Happy\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Angry\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Neutral\textquotesingle{}}\NormalTok{),  }\CommentTok{\# Columns to turn into long}
               \AttributeTok{names\_to =} \StringTok{\textquotesingle{}Facial\_Expression\textquotesingle{}}\NormalTok{,  }\CommentTok{\# What will the column with the labels be called}
               \AttributeTok{values\_to =} \StringTok{\textquotesingle{}Ratings\textquotesingle{}}\NormalTok{)  }\CommentTok{\# What will the column with the values be called}

\FunctionTok{head}\NormalTok{(df\_long)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 3
##   Participant_ID Facial_Expression Ratings
##            <int> <chr>               <dbl>
## 1              1 Happy                   6
## 2              1 Angry                   4
## 3              1 Neutral                 2
## 4              2 Happy                   6
## 5              2 Angry                   4
## 6              2 Neutral                 7
\end{verbatim}

\hypertarget{missing-values}{%
\subsection{Missing Values}\label{missing-values}}

We have several ways of dealing with missing values \texttt{NA} (which, if you forget already, means ``Not Available'').
We can remove them, or omit them, depending on the situation.
The important thing to note is that you should be aware if your dataframe contains \texttt{NA} values, since these might provide misleading results, or simple provide error messages.
For instance, if you ask the mean of a column that contains just one \texttt{NA}, the result will be \texttt{NA}.
You can either specify \texttt{na.rm\ =\ TRUE} on the command (if the specific command allows you to do so), or just remove the \texttt{NA} values prior to running the command.

First lets learn how to check for missing values.
There are several ways.
Here are a few

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(df))  }\CommentTok{\# tells you how many data points are NAs (TRUE) or not (FALSE) in the whole dataframe.}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## FALSE 
##   750
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{colSums}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(df))  }\CommentTok{\# tells you more specifically the number of NAs per column in your dataframe}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##            0            0            0            0            0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{which}\NormalTok{(}\FunctionTok{colSums}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(df))}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)  }\CommentTok{\# just tells you exactly the ones that have NAs (and how many)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## named integer(0)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[}\SpecialCharTok{!}\FunctionTok{complete.cases}\NormalTok{(df),]  }\CommentTok{\# tells you the whole row that has an NA value in it.}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] Sepal.Length Sepal.Width  Petal.Length Petal.Width  Species     
## <0 rows> (or 0-length row.names)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#View(df)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{Sepal.Length }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Sepal.Length)}
\CommentTok{\# Asking a mean with NA values}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Mean =} \FunctionTok{mean}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Mean
## 1   NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Removing NAs when asking the mean}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Mean =} \FunctionTok{mean}\NormalTok{(Sepal.Length, }\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Mean
## 1 5.843333
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Removing NAs then asking for the mean}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(Sepal.Length)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Mean =} \FunctionTok{mean}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Mean
## 1 5.843333
\end{verbatim}

We can remove these NA rows or substitute them.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Replacing NA with 0}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Sepal.Length =} \FunctionTok{ifelse}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(Sepal.Length), }\DecValTok{0}\NormalTok{, Sepal.Length))}

\CommentTok{\# Removing}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(Sepal.Length))}

\CommentTok{\# or remove all NA rows}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\hypertarget{counts}{%
\subsection{Counts}\label{counts}}

Already mentioned above.
Gives you the number of entries.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Gives you the number per category of Species}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{count =} \FunctionTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 2
##   Species    count
##   <fct>      <int>
## 1 setosa        51
## 2 versicolor    50
## 3 virginica     50
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Counts the total number of entries}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     n
## 1 151
\end{verbatim}

\hypertarget{ungrouping}{%
\subsection{Ungrouping}\label{ungrouping}}

Lastly, you can use \texttt{ungroup()} in a pipe to remove the grouping that you've did, if you want to execute commands over the ``ungrouped'' data.
This is very rarely used, at least by me.
However, in certain cases it might be useful.
Here's an example, where I want to center the variable \texttt{Sepal.Length}, but I want to do so considering the species it belongs to.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# grouping by species}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Sepal.Width =} \FunctionTok{as.numeric}\NormalTok{(Sepal.Width),}
         \AttributeTok{Speal.Length =} \FunctionTok{as.numeric}\NormalTok{(Sepal.Length)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{MeanPerSpecie =} \FunctionTok{mean}\NormalTok{(Sepal.Width),  }\CommentTok{\# creates mean by species}
         \AttributeTok{CenteredWidth =}\NormalTok{ Sepal.Width }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(Sepal.Width)) }\SpecialCharTok{\%\textgreater{}\%}   \CommentTok{\# subtracts the mean (of the corresponding specie).}
  \FunctionTok{select}\NormalTok{(Species, Sepal.Width, MeanPerSpecie, CenteredWidth) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ungroup}\NormalTok{() }\CommentTok{\# remove grouping in case i want to do more mutates, but now NOT considering the groups of species.}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 151 x 4
##    Species Sepal.Width MeanPerSpecie CenteredWidth
##    <fct>         <dbl>         <dbl>         <dbl>
##  1 setosa          3.5          3.40       0.0980 
##  2 setosa          3            3.40      -0.402  
##  3 setosa          3.2          3.40      -0.202  
##  4 setosa          3.1          3.40      -0.302  
##  5 setosa          3.6          3.40       0.198  
##  6 setosa          3.9          3.40       0.498  
##  7 setosa          3.4          3.40      -0.00196
##  8 setosa          3.4          3.40      -0.00196
##  9 setosa          2.9          3.40      -0.502  
## 10 setosa          3.1          3.40      -0.302  
## # ... with 141 more rows
\end{verbatim}

\hypertarget{stringscharacters}{%
\subsection{Strings/Characters}\label{stringscharacters}}

Sometimes we want to work on strings/characters.
We may want to replace strings, alter them in some way, split them into different columns, etc.
So here I will introduce a few examples of what we can do to strings in R.

For instance lets say we want to find a pattern of a string in a column of a dataframe in R.
For that we will use the grep family of functions which is built-in in R.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# We can either find the rows on which this pattern appear}
\FunctionTok{grep}\NormalTok{(}\StringTok{\textquotesingle{}set\textquotesingle{}}\NormalTok{, df}\SpecialCharTok{$}\NormalTok{Species)}

\CommentTok{\# We can pull the string in which this pattern appears}
\FunctionTok{grep}\NormalTok{(}\StringTok{\textquotesingle{}set\textquotesingle{}}\NormalTok{, df}\SpecialCharTok{$}\NormalTok{Species, }\AttributeTok{value =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Or return a TRUE or FALSE per row}
\FunctionTok{grepl}\NormalTok{(}\StringTok{\textquotesingle{}set\textquotesingle{}}\NormalTok{, df}\SpecialCharTok{$}\NormalTok{Species)  }\CommentTok{\# the "l" after grep stands for logic (i.e., TRUE/FALSE)}

\CommentTok{\# We can find how many entries with that pattern are present}
\FunctionTok{sum}\NormalTok{(}\FunctionTok{grepl}\NormalTok{(}\StringTok{\textquotesingle{}set\textquotesingle{}}\NormalTok{, df}\SpecialCharTok{$}\NormalTok{Species))}

\CommentTok{\# We can substitute a pattern directly in the dataframe}
\FunctionTok{sub}\NormalTok{(}\StringTok{\textquotesingle{}set\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Set\textquotesingle{}}\NormalTok{, df}\SpecialCharTok{$}\NormalTok{Species)}
\end{Highlighting}
\end{Shaded}

There are additional commands within this family of functions that will allow you to extract, find or substitute exactly what you want and obeying each condition you might want.
For that just look into: \url{https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/grep}

Another relevant package used to deal with strings is \texttt{stringr}, which comes with the tidyverse.
Here I'll showing some brief examples of what you can do with it, although you can do much more, and you should check its website: \url{https://stringr.tidyverse.org/}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Just preparing the df}
\NormalTok{df2 }\OtherTok{\textless{}{-}}\NormalTok{ mtcars}
\NormalTok{df2}\SpecialCharTok{$}\NormalTok{CarName }\OtherTok{\textless{}{-}} \FunctionTok{rownames}\NormalTok{(mtcars)}
\FunctionTok{rownames}\NormalTok{(df2) }\OtherTok{\textless{}{-}} \ConstantTok{NULL}

\CommentTok{\# StringR}
\NormalTok{df2 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{CarName =} \FunctionTok{str\_replace}\NormalTok{(CarName, }\StringTok{\textquotesingle{}Merc\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Mercedes\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     mpg cyl  disp  hp drat    wt  qsec vs am gear carb             CarName
## 1  21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4           Mazda RX4
## 2  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4       Mazda RX4 Wag
## 3  22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1          Datsun 710
## 4  21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1      Hornet 4 Drive
## 5  18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2   Hornet Sportabout
## 6  18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1             Valiant
## 7  14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4          Duster 360
## 8  24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2       Mercedes 240D
## 9  22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2        Mercedes 230
## 10 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4        Mercedes 280
## 11 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4       Mercedes 280C
## 12 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3      Mercedes 450SE
## 13 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3      Mercedes 450SL
## 14 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3     Mercedes 450SLC
## 15 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4  Cadillac Fleetwood
## 16 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4 Lincoln Continental
## 17 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4   Chrysler Imperial
## 18 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1            Fiat 128
## 19 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2         Honda Civic
## 20 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1      Toyota Corolla
## 21 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1       Toyota Corona
## 22 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2    Dodge Challenger
## 23 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2         AMC Javelin
## 24 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4          Camaro Z28
## 25 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2    Pontiac Firebird
## 26 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1           Fiat X1-9
## 27 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2       Porsche 914-2
## 28 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2        Lotus Europa
## 29 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4      Ford Pantera L
## 30 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6        Ferrari Dino
## 31 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8       Maserati Bora
## 32 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2          Volvo 142E
\end{verbatim}

\hypertarget{splits}{%
\subsection{Splits}\label{splits}}

We can also split a dataframe into multiple ones, by using \texttt{group\_split()} or \texttt{split()}.
They work and do the same.
The only difference is that the former comes with the tidyverse and also just works a bit better with the pipes.
For instance, lets split the dataframe by species.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_split}\NormalTok{(Species) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## <list_of<
##   tbl_df<
##     Sepal.Length: double
##     Sepal.Width : character
##     Petal.Length: character
##     Petal.Width : character
##     Species     : factor<fb977>
##   >
## >[3]>
## [[1]]
## # A tibble: 51 x 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##           <dbl> <chr>       <chr>        <chr>       <fct>  
##  1          5.1 3.5         1.4          0.2         setosa 
##  2          4.9 3           1.4          0.2         setosa 
##  3          4.7 3.2         1.3          0.2         setosa 
##  4          4.6 3.1         1.5          0.2         setosa 
##  5          5   3.6         1.4          0.2         setosa 
##  6          5.4 3.9         1.7          0.4         setosa 
##  7          4.6 3.4         1.4          0.3         setosa 
##  8          5   3.4         1.5          0.2         setosa 
##  9          4.4 2.9         1.4          0.2         setosa 
## 10          4.9 3.1         1.5          0.1         setosa 
## # ... with 41 more rows
## 
## [[2]]
## # A tibble: 50 x 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species   
##           <dbl> <chr>       <chr>        <chr>       <fct>     
##  1          7   3.2         4.7          1.4         versicolor
##  2          6.4 3.2         4.5          1.5         versicolor
##  3          6.9 3.1         4.9          1.5         versicolor
##  4          5.5 2.3         4            1.3         versicolor
##  5          6.5 2.8         4.6          1.5         versicolor
##  6          5.7 2.8         4.5          1.3         versicolor
##  7          6.3 3.3         4.7          1.6         versicolor
##  8          4.9 2.4         3.3          1           versicolor
##  9          6.6 2.9         4.6          1.3         versicolor
## 10          5.2 2.7         3.9          1.4         versicolor
## # ... with 40 more rows
## 
## [[3]]
## # A tibble: 50 x 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species  
##           <dbl> <chr>       <chr>        <chr>       <fct>    
##  1          6.3 3.3         6            2.5         virginica
##  2          5.8 2.7         5.1          1.9         virginica
##  3          7.1 3           5.9          2.1         virginica
##  4          6.3 2.9         5.6          1.8         virginica
##  5          6.5 3           5.8          2.2         virginica
##  6          7.6 3           6.6          2.1         virginica
##  7          4.9 2.5         4.5          1.7         virginica
##  8          7.3 2.9         6.3          1.8         virginica
##  9          6.7 2.5         5.8          1.8         virginica
## 10          7.2 3.6         6.1          2.5         virginica
## # ... with 40 more rows
\end{verbatim}

\hypertarget{mapping}{%
\subsection{Mapping}\label{mapping}}

Mapping is quite useful.
It allows you to map a function to a certain output.
For instance, if you first need to split the dataframe, then perform a correlation test, you can easily do this altogether.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Sepal.Length =} \FunctionTok{as.numeric}\NormalTok{(Sepal.Length),  }\CommentTok{\# turning these columns to numeric}
         \AttributeTok{Sepal.Width =} \FunctionTok{as.numeric}\NormalTok{(Sepal.Width)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_split}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# split by pictures}
  \FunctionTok{map}\NormalTok{(}\SpecialCharTok{\textasciitilde{}} \FunctionTok{cor.test}\NormalTok{(.}\SpecialCharTok{$}\NormalTok{Sepal.Length, .}\SpecialCharTok{$}\NormalTok{Sepal.Width))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [[1]]
## 
##  Pearson's product-moment correlation
## 
## data:  .$Sepal.Length and .$Sepal.Width
## t = 6.7473, df = 49, p-value = 1.634e-08
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.5173516 0.8139116
## sample estimates:
##       cor 
## 0.6939905 
## 
## 
## [[2]]
## 
##  Pearson's product-moment correlation
## 
## data:  .$Sepal.Length and .$Sepal.Width
## t = 4.2839, df = 48, p-value = 8.772e-05
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.2900175 0.7015599
## sample estimates:
##       cor 
## 0.5259107 
## 
## 
## [[3]]
## 
##  Pearson's product-moment correlation
## 
## data:  .$Sepal.Length and .$Sepal.Width
## t = 3.5619, df = 48, p-value = 0.0008435
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.2049657 0.6525292
## sample estimates:
##       cor 
## 0.4572278
\end{verbatim}

We can see it more clearly in this dataframe.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{split}\NormalTok{(.}\SpecialCharTok{$}\NormalTok{cyl) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{map}\NormalTok{(}\SpecialCharTok{\textasciitilde{}} \FunctionTok{lm}\NormalTok{(mpg }\SpecialCharTok{\textasciitilde{}}\NormalTok{ wt, }\AttributeTok{data =}\NormalTok{ .x)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{map\_dfr}\NormalTok{(}\SpecialCharTok{\textasciitilde{}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{t}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(}\FunctionTok{coef}\NormalTok{(.)))))  }\CommentTok{\# returns the result in a dataframe format}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   (Intercept)        wt
## 1    39.57120 -5.647025
## 2    28.40884 -2.780106
## 3    23.86803 -2.192438
\end{verbatim}

\hypertarget{nesting}{%
\subsection{Nesting}\label{nesting}}

Now nesting is another neat feature, albeit less used, that sometimes might come in handy if you want a more clean data frame.
Nesting allows you to ``nest'' data frames within data frames.
The best way to see how it works and its possible benefits is with an example.

We have an example below (again, courtesy of chatGPT) about patient visits to a hospital.
Lets first build this simulated data frame.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(lubridate)  }\CommentTok{\# used for ymd function}

\CommentTok{\# Simulate a dataset of patients with multiple visits}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\NormalTok{n\_patients }\OtherTok{\textless{}{-}} \DecValTok{50}
\NormalTok{n\_visits }\OtherTok{\textless{}{-}} \DecValTok{5}
\NormalTok{patient\_data }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{patient\_id =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{n\_patients, }\AttributeTok{each =}\NormalTok{ n\_visits),}
  \AttributeTok{visit\_date =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \FunctionTok{ymd}\NormalTok{(}\StringTok{"20220101"}\NormalTok{), }\AttributeTok{length.out =}\NormalTok{ n\_visits, }\AttributeTok{by =} \StringTok{"month"}\NormalTok{), }\AttributeTok{times =}\NormalTok{ n\_patients),}
  \AttributeTok{symptom =} \FunctionTok{sample}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"cough"}\NormalTok{, }\StringTok{"fever"}\NormalTok{, }\StringTok{"headache"}\NormalTok{, }\StringTok{"fatigue"}\NormalTok{, }\StringTok{"nausea"}\NormalTok{), }\AttributeTok{size =}\NormalTok{ n\_patients }\SpecialCharTok{*}\NormalTok{ n\_visits, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# If you want to see a bigger (font{-}sized) data frame}
\CommentTok{\# kableExtra::kable(patient\_data, "html") \%\textgreater{}\%}
\CommentTok{\#   kableExtra::kable\_styling(font\_size = 20)}
\end{Highlighting}
\end{Shaded}

Now lets nest the data per ID.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Nest the visits within each patient}
\NormalTok{patient\_data\_nested }\OtherTok{\textless{}{-}}\NormalTok{ patient\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(patient\_id) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{nest}\NormalTok{()}

\FunctionTok{head}\NormalTok{(patient\_data\_nested)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 2
## # Groups:   patient_id [6]
##   patient_id data            
##        <int> <list>          
## 1          1 <tibble [5 x 2]>
## 2          2 <tibble [5 x 2]>
## 3          3 <tibble [5 x 2]>
## 4          4 <tibble [5 x 2]>
## 5          5 <tibble [5 x 2]>
## 6          6 <tibble [5 x 2]>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#View(patient\_data\_nested)}
\end{Highlighting}
\end{Shaded}

Now lets run some statistics on each patient.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate the proportion of visits where each symptom was reported}
\NormalTok{patient\_data\_nested\_summary }\OtherTok{\textless{}{-}}\NormalTok{ patient\_data\_nested }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{symptom\_summary =} \FunctionTok{map}\NormalTok{(data, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .x }\SpecialCharTok{\%\textgreater{}\%} 
      \FunctionTok{group\_by}\NormalTok{(symptom) }\SpecialCharTok{\%\textgreater{}\%} 
      \FunctionTok{summarize}\NormalTok{(}\AttributeTok{prop\_reports =} \FunctionTok{n}\NormalTok{()}\SpecialCharTok{/}\FunctionTok{nrow}\NormalTok{(.))}
\NormalTok{    )}
\NormalTok{  )}


\CommentTok{\# Unnesting and view results}
\NormalTok{patient\_data\_nested\_summary }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{unnest}\NormalTok{(symptom\_summary)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 168 x 4
## # Groups:   patient_id [50]
##    patient_id data             symptom  prop_reports
##         <int> <list>           <chr>           <dbl>
##  1          1 <tibble [5 x 2]> fever             0.4
##  2          1 <tibble [5 x 2]> headache          0.6
##  3          2 <tibble [5 x 2]> cough             0.2
##  4          2 <tibble [5 x 2]> fatigue           0.2
##  5          2 <tibble [5 x 2]> fever             0.2
##  6          2 <tibble [5 x 2]> headache          0.2
##  7          2 <tibble [5 x 2]> nausea            0.2
##  8          3 <tibble [5 x 2]> cough             0.2
##  9          3 <tibble [5 x 2]> fatigue           0.2
## 10          3 <tibble [5 x 2]> headache          0.4
## # ... with 158 more rows
\end{verbatim}

\hypertarget{end}{%
\section{End}\label{end}}

\hypertarget{exploratory-data-analysis-eda}{%
\chapter{Exploratory Data Analysis (EDA)}\label{exploratory-data-analysis-eda}}

In Exploratory Data Analysis (EDA for short) we will want to explore our data.
We usually start by getting summaries and plots that broadly summarise how our data is structured.
We then proceed to more specific exploration of what variables interest us.
There is no right way of doing EDA, and everyone does EDA slightly different.
What matters in the end is that this part of your data analysis gives you a good glimpse about your data and potential targets to further explore and analyze.
And of course, this will be a good time to put your plotting skills to test, and with R, you can do pretty much anything\ldots{} and, again, I truly mean anything.

What is the data we will be working with?
The data exemplified here comes from Dr.~Kristen Gorman in Palmer Station, Antarctica LTER, a member of the Long Term Ecological Research Network.
It contains information about 344 penguins, across 3 different species of penguins, collected from 3 islands in the Palmer Archipelago, Antarctica.

\emph{Horst AM, Hill AP, Gorman KB (2020). palmerpenguins: Palmer Archipelago (Antarctica) penguin data. R package version 0.1.0. \url{https://allisonhorst.github.io/palmerpenguins/}}

Now lets look at the data We can either show the first rows (or last rows) to get a general view on what the columns are and what the values associated with each columns are, or we can View the entire data frame.
Additionally we can also use several commands to provide us some more general info about the data frame itself.

\hypertarget{loading-data}{%
\section{Loading data}\label{loading-data}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins\_raw }\OtherTok{\textless{}{-}}\NormalTok{ palmerpenguins}\SpecialCharTok{::}\NormalTok{penguins\_raw}
\FunctionTok{head}\NormalTok{(penguins\_raw)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 17
##   study~1 Sampl~2 Species Region Island Stage Indiv~3 Clutc~4 `Date Egg` Culme~5
##   <chr>     <dbl> <chr>   <chr>  <chr>  <chr> <chr>   <chr>   <date>       <dbl>
## 1 PAL0708       1 Adelie~ Anvers Torge~ Adul~ N1A1    Yes     2007-11-11    39.1
## 2 PAL0708       2 Adelie~ Anvers Torge~ Adul~ N1A2    Yes     2007-11-11    39.5
## 3 PAL0708       3 Adelie~ Anvers Torge~ Adul~ N2A1    Yes     2007-11-16    40.3
## 4 PAL0708       4 Adelie~ Anvers Torge~ Adul~ N2A2    Yes     2007-11-16    NA  
## 5 PAL0708       5 Adelie~ Anvers Torge~ Adul~ N3A1    Yes     2007-11-16    36.7
## 6 PAL0708       6 Adelie~ Anvers Torge~ Adul~ N3A2    Yes     2007-11-16    39.3
## # ... with 7 more variables: `Culmen Depth (mm)` <dbl>,
## #   `Flipper Length (mm)` <dbl>, `Body Mass (g)` <dbl>, Sex <chr>,
## #   `Delta 15 N (o/oo)` <dbl>, `Delta 13 C (o/oo)` <dbl>, Comments <chr>, and
## #   abbreviated variable names 1: studyName, 2: `Sample Number`,
## #   3: `Individual ID`, 4: `Clutch Completion`, 5: `Culmen Length (mm)`
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Use tail() if you want to see the last rows}
\end{Highlighting}
\end{Shaded}

The \texttt{str()} command gives us some detail into the class of each column of the data frame, its length, its values, among others.

P.s., \texttt{\textless{}dbl\textgreater{}} means a numerical value with decimal points.

\hypertarget{checking-data}{%
\section{Checking data}\label{checking-data}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(penguins\_raw)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## tibble [344 x 17] (S3: tbl_df/tbl/data.frame)
##  $ studyName          : chr [1:344] "PAL0708" "PAL0708" "PAL0708" "PAL0708" ...
##  $ Sample Number      : num [1:344] 1 2 3 4 5 6 7 8 9 10 ...
##  $ Species            : chr [1:344] "Adelie Penguin (Pygoscelis adeliae)" "Adelie Penguin (Pygoscelis adeliae)" "Adelie Penguin (Pygoscelis adeliae)" "Adelie Penguin (Pygoscelis adeliae)" ...
##  $ Region             : chr [1:344] "Anvers" "Anvers" "Anvers" "Anvers" ...
##  $ Island             : chr [1:344] "Torgersen" "Torgersen" "Torgersen" "Torgersen" ...
##  $ Stage              : chr [1:344] "Adult, 1 Egg Stage" "Adult, 1 Egg Stage" "Adult, 1 Egg Stage" "Adult, 1 Egg Stage" ...
##  $ Individual ID      : chr [1:344] "N1A1" "N1A2" "N2A1" "N2A2" ...
##  $ Clutch Completion  : chr [1:344] "Yes" "Yes" "Yes" "Yes" ...
##  $ Date Egg           : Date[1:344], format: "2007-11-11" "2007-11-11" ...
##  $ Culmen Length (mm) : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...
##  $ Culmen Depth (mm)  : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...
##  $ Flipper Length (mm): num [1:344] 181 186 195 NA 193 190 181 195 193 190 ...
##  $ Body Mass (g)      : num [1:344] 3750 3800 3250 NA 3450 ...
##  $ Sex                : chr [1:344] "MALE" "FEMALE" "FEMALE" NA ...
##  $ Delta 15 N (o/oo)  : num [1:344] NA 8.95 8.37 NA 8.77 ...
##  $ Delta 13 C (o/oo)  : num [1:344] NA -24.7 -25.3 NA -25.3 ...
##  $ Comments           : chr [1:344] "Not enough blood for isotopes." NA NA "Adult not sampled." ...
##  - attr(*, "spec")=
##   .. cols(
##   ..   studyName = col_character(),
##   ..   `Sample Number` = col_double(),
##   ..   Species = col_character(),
##   ..   Region = col_character(),
##   ..   Island = col_character(),
##   ..   Stage = col_character(),
##   ..   `Individual ID` = col_character(),
##   ..   `Clutch Completion` = col_character(),
##   ..   `Date Egg` = col_date(format = ""),
##   ..   `Culmen Length (mm)` = col_double(),
##   ..   `Culmen Depth (mm)` = col_double(),
##   ..   `Flipper Length (mm)` = col_double(),
##   ..   `Body Mass (g)` = col_double(),
##   ..   Sex = col_character(),
##   ..   `Delta 15 N (o/oo)` = col_double(),
##   ..   `Delta 13 C (o/oo)` = col_double(),
##   ..   Comments = col_character()
##   .. )
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# You can also use glimpse() from the dplyr package}
\CommentTok{\# Or you can use the skim() function from the skimr package}
\end{Highlighting}
\end{Shaded}

The \texttt{summary} command gives us a summary of each column, with, in case of numeric, the distribution parameters of those values, and in the case of categorical columns, the count of each value while also highlighting always the number of \texttt{NA} entries.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(penguins\_raw)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   studyName         Sample Number      Species             Region         
##  Length:344         Min.   :  1.00   Length:344         Length:344        
##  Class :character   1st Qu.: 29.00   Class :character   Class :character  
##  Mode  :character   Median : 58.00   Mode  :character   Mode  :character  
##                     Mean   : 63.15                                        
##                     3rd Qu.: 95.25                                        
##                     Max.   :152.00                                        
##                                                                           
##     Island             Stage           Individual ID      Clutch Completion 
##  Length:344         Length:344         Length:344         Length:344        
##  Class :character   Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
##                                                                             
##                                                                             
##                                                                             
##                                                                             
##     Date Egg          Culmen Length (mm) Culmen Depth (mm) Flipper Length (mm)
##  Min.   :2007-11-09   Min.   :32.10      Min.   :13.10     Min.   :172.0      
##  1st Qu.:2007-11-28   1st Qu.:39.23      1st Qu.:15.60     1st Qu.:190.0      
##  Median :2008-11-09   Median :44.45      Median :17.30     Median :197.0      
##  Mean   :2008-11-27   Mean   :43.92      Mean   :17.15     Mean   :200.9      
##  3rd Qu.:2009-11-16   3rd Qu.:48.50      3rd Qu.:18.70     3rd Qu.:213.0      
##  Max.   :2009-12-01   Max.   :59.60      Max.   :21.50     Max.   :231.0      
##                       NA's   :2          NA's   :2         NA's   :2          
##  Body Mass (g)      Sex            Delta 15 N (o/oo) Delta 13 C (o/oo)
##  Min.   :2700   Length:344         Min.   : 7.632    Min.   :-27.02   
##  1st Qu.:3550   Class :character   1st Qu.: 8.300    1st Qu.:-26.32   
##  Median :4050   Mode  :character   Median : 8.652    Median :-25.83   
##  Mean   :4202                      Mean   : 8.733    Mean   :-25.69   
##  3rd Qu.:4750                      3rd Qu.: 9.172    3rd Qu.:-25.06   
##  Max.   :6300                      Max.   :10.025    Max.   :-23.79   
##  NA's   :2                         NA's   :14        NA's   :13       
##    Comments        
##  Length:344        
##  Class :character  
##  Mode  :character  
##                    
##                    
##                    
## 
\end{verbatim}

At this phase you should start assessing your data and will probably need to modify the data frame a bit.
Most of the tools you need were already introduced in Chapter 2, but you will learn some new ones here along the way.
First though, lets get familiarized with the data by reading its description.

So a brief intro to this data.
It has 17 columns, namely:

\textbf{studyName}: Sampling expedition from which data were collected, generated, etc.

\textbf{Sample Number}: an integer denoting the continuous numbering sequence for each sample

\textbf{Species}: a character string denoting the penguin species

\textbf{Region}: a character string denoting the region of Palmer LTER sampling grid

\textbf{Island}: a character string denoting the island near Palmer Station where samples were collected

\textbf{Stage}: a character string denoting reproductive stage at sampling

\textbf{Individual ID}: a character string denoting the unique ID for each individual in dataset

\textbf{Clutch Completion}: a character string denoting if the study nest observed with a full clutch, i.e., 2 eggs

\textbf{Date Egg}: a date denoting the date study nest observed with 1 egg (sampled)

\textbf{Culmen Length}: a number denoting the length of the dorsal ridge of a bird's bill (millimeters)

\textbf{Culmen Depth}: a number denoting the depth of the dorsal ridge of a bird's bill (millimeters)

\textbf{Flipper Length}: an integer denoting the length penguin flipper (millimeters)

\textbf{Body Mass}: an integer denoting the penguin body mass (grams)

\textbf{Sex}: a character string denoting the sex of an animal

\textbf{Delta 15 N}: a number denoting the measure of the ratio of stable isotopes 15N:14N

\textbf{Delta 13 C}: a number denoting the measure of the ratio of stable isotopes 13C:12C

\textbf{Comments}: a character string with text providing additional relevant information for data

There is also a subsetted (cleaner) version with just the species, island, size (flipper length, body mass, bill dimensions) and sex variables.
We will, however, work with the raw version and transform it ourselves making it cleaner and easier to explore and gather some initial insights about the data.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(penguins\_raw)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 17
##   study~1 Sampl~2 Species Region Island Stage Indiv~3 Clutc~4 `Date Egg` Culme~5
##   <chr>     <dbl> <chr>   <chr>  <chr>  <chr> <chr>   <chr>   <date>       <dbl>
## 1 PAL0708       1 Adelie~ Anvers Torge~ Adul~ N1A1    Yes     2007-11-11    39.1
## 2 PAL0708       2 Adelie~ Anvers Torge~ Adul~ N1A2    Yes     2007-11-11    39.5
## 3 PAL0708       3 Adelie~ Anvers Torge~ Adul~ N2A1    Yes     2007-11-16    40.3
## 4 PAL0708       4 Adelie~ Anvers Torge~ Adul~ N2A2    Yes     2007-11-16    NA  
## 5 PAL0708       5 Adelie~ Anvers Torge~ Adul~ N3A1    Yes     2007-11-16    36.7
## 6 PAL0708       6 Adelie~ Anvers Torge~ Adul~ N3A2    Yes     2007-11-16    39.3
## # ... with 7 more variables: `Culmen Depth (mm)` <dbl>,
## #   `Flipper Length (mm)` <dbl>, `Body Mass (g)` <dbl>, Sex <chr>,
## #   `Delta 15 N (o/oo)` <dbl>, `Delta 13 C (o/oo)` <dbl>, Comments <chr>, and
## #   abbreviated variable names 1: studyName, 2: `Sample Number`,
## #   3: `Individual ID`, 4: `Clutch Completion`, 5: `Culmen Length (mm)`
\end{verbatim}

\hypertarget{cleaning}{%
\section{Cleaning}\label{cleaning}}

\hypertarget{cleaning-col.-names}{%
\subsection{Cleaning col.~names}\label{cleaning-col.-names}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{names}\NormalTok{(penguins\_raw)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "studyName"           "Sample Number"       "Species"            
##  [4] "Region"              "Island"              "Stage"              
##  [7] "Individual ID"       "Clutch Completion"   "Date Egg"           
## [10] "Culmen Length (mm)"  "Culmen Depth (mm)"   "Flipper Length (mm)"
## [13] "Body Mass (g)"       "Sex"                 "Delta 15 N (o/oo)"  
## [16] "Delta 13 C (o/oo)"   "Comments"
\end{verbatim}

So first off, we might want to clean the data.
One thing we often do is rename variables (in this case columns).
We can do so simply with the use of the \texttt{rename()} function from \texttt{dplyr}.\\

\texttt{rename()}: changes the names of individual variables using new\_name = old\_name syntax.\\

\texttt{rename\_with()}: renames columns using a function.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Lets say I want to rename "Individual ID" to "ID".}
\NormalTok{penguins }\OtherTok{\textless{}{-}}\NormalTok{ penguins\_raw }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{rename}\NormalTok{(}\StringTok{\textquotesingle{}ID\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}Individual ID\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Now we might want to make every column, except ID, lower case, substitute spaces with ``\_'' and remove ``()''.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{rename\_with}\NormalTok{(tolower) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# lower{-}case every column}
  \FunctionTok{rename\_with}\NormalTok{(toupper, }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{\textquotesingle{}ID\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# up{-}case column starting with "ID"}
  \FunctionTok{rename\_with}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\FunctionTok{gsub}\NormalTok{(}\StringTok{" "}\NormalTok{, }\StringTok{"\_"}\NormalTok{, .x))  }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# subs every space (" ") with no space ("\_")}
  \FunctionTok{rename\_with}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\FunctionTok{gsub}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{("}\NormalTok{, }\StringTok{""}\NormalTok{, .x)) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\#removes every "("}
  \FunctionTok{rename\_with}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\FunctionTok{gsub}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{)"}\NormalTok{, }\StringTok{""}\NormalTok{, .x))  }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# removes every ")"}
  \FunctionTok{rename\_with}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\FunctionTok{gsub}\NormalTok{(}\StringTok{"/"}\NormalTok{ ,}\StringTok{""}\NormalTok{, .x))  }\CommentTok{\# removes /}
\end{Highlighting}
\end{Shaded}

We could also skip a few things and be less specific, but instead use only the following function from the ``janitor'' package

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{  janitor}\SpecialCharTok{::}\FunctionTok{clean\_names}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 344 x 17
##    studyn~1 sampl~2 species region island stage id    clutc~3 date_egg   culme~4
##    <chr>      <dbl> <chr>   <chr>  <chr>  <chr> <chr> <chr>   <date>       <dbl>
##  1 PAL0708        1 Adelie~ Anvers Torge~ Adul~ N1A1  Yes     2007-11-11    39.1
##  2 PAL0708        2 Adelie~ Anvers Torge~ Adul~ N1A2  Yes     2007-11-11    39.5
##  3 PAL0708        3 Adelie~ Anvers Torge~ Adul~ N2A1  Yes     2007-11-16    40.3
##  4 PAL0708        4 Adelie~ Anvers Torge~ Adul~ N2A2  Yes     2007-11-16    NA  
##  5 PAL0708        5 Adelie~ Anvers Torge~ Adul~ N3A1  Yes     2007-11-16    36.7
##  6 PAL0708        6 Adelie~ Anvers Torge~ Adul~ N3A2  Yes     2007-11-16    39.3
##  7 PAL0708        7 Adelie~ Anvers Torge~ Adul~ N4A1  No      2007-11-15    38.9
##  8 PAL0708        8 Adelie~ Anvers Torge~ Adul~ N4A2  No      2007-11-15    39.2
##  9 PAL0708        9 Adelie~ Anvers Torge~ Adul~ N5A1  Yes     2007-11-09    34.1
## 10 PAL0708       10 Adelie~ Anvers Torge~ Adul~ N5A2  Yes     2007-11-09    42  
## # ... with 334 more rows, 7 more variables: culmen_depth_mm <dbl>,
## #   flipper_length_mm <dbl>, body_mass_g <dbl>, sex <chr>,
## #   delta_15_n_ooo <dbl>, delta_13_c_ooo <dbl>, comments <chr>, and abbreviated
## #   variable names 1: studyname, 2: sample_number, 3: clutch_completion,
## #   4: culmen_length_mm
\end{verbatim}

\hypertarget{date}{%
\subsection{Date}\label{date}}

One interesting and somewhat difficult (sometimes) parameter to adjust is turning a column that is often a character to a \texttt{date} format.
In this case is simple, but I give you some examples below for you to work your way through other types of transformations.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins}\SpecialCharTok{$}\NormalTok{date\_egg }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(penguins}\SpecialCharTok{$}\NormalTok{date\_egg)}
\end{Highlighting}
\end{Shaded}

Now here are other examples, aside from this data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{characters }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"1jan1960"}\NormalTok{, }\StringTok{"2jan1960"}\NormalTok{, }\StringTok{"31mar1960"}\NormalTok{, }\StringTok{"30jul1960"}\NormalTok{)}
\NormalTok{dates }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(characters, }\StringTok{"\%d\%b\%Y"}\NormalTok{)}
\NormalTok{dates}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "1960-01-01" "1960-01-02" "1960-03-31" "1960-07-30"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{characters }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"02/27/92"}\NormalTok{, }\StringTok{"02/27/92"}\NormalTok{, }\StringTok{"01/14/92"}\NormalTok{, }\StringTok{"02/28/92"}\NormalTok{, }\StringTok{"02/01/92"}\NormalTok{)}
\NormalTok{dates }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(characters, }\StringTok{"\%m/\%d/\%y"}\NormalTok{)}
\NormalTok{dates}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "1992-02-27" "1992-02-27" "1992-01-14" "1992-02-28" "1992-02-01"
\end{verbatim}

Check also these link for better examples.
\url{https://www.r-bloggers.com/2013/08/date-formats-in-r/}

\hypertarget{cleaning-some-columns}{%
\subsection{Cleaning some columns}\label{cleaning-some-columns}}

In particular, I want to remove the species latin name from the ``species'' column as well as the parenthesis.
Now this may seem simple, but messing with characters is one of those things that having an internet connection is key, since base commands, in my opinion, are not at all clear or simple.
The command below simple means replace the \texttt{species} column with a new one (with the same name), but in this one replace all the text that is between the parenthesis (including the parenthesis themselves) \texttt{"\ *\textbackslash{}\textbackslash{}(.*?\textbackslash{}\textbackslash{})\ *"} and replace by nothing \texttt{""}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{species =} \FunctionTok{gsub}\NormalTok{(}\StringTok{" *}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{(.*?}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{) *"}\NormalTok{, }\StringTok{""}\NormalTok{, species))}
\end{Highlighting}
\end{Shaded}

Another thing that jumps to sight is the ``stage'' column, which appears to be telling the same thing always.
Lets check.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(penguins}\SpecialCharTok{$}\NormalTok{stage)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Adult, 1 Egg Stage 
##                344
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(penguins}\SpecialCharTok{$}\NormalTok{stage)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Adult, 1 Egg Stage"
\end{verbatim}

Since its all the same, I can choose to remove it.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins}\SpecialCharTok{$}\NormalTok{stage }\OtherTok{\textless{}{-}} \ConstantTok{NULL}
\end{Highlighting}
\end{Shaded}

\hypertarget{dealing-with-na-values}{%
\subsection{Dealing with NA values}\label{dealing-with-na-values}}

Now lets deal with NA values.
First lets quickly identify which columns have NA values, and how many of them each one has.
We could just look at the \texttt{summary(penguins)}, or we could do this with other base R commands, like so:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sapply}\NormalTok{(penguins, }\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(x)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         studyname     sample_number           species            region 
##                 0                 0                 0                 0 
##            island                ID clutch_completion          date_egg 
##                 0                 0                 0                 0 
##  culmen_length_mm   culmen_depth_mm flipper_length_mm       body_mass_g 
##                 2                 2                 2                 2 
##               sex    delta_15_n_ooo    delta_13_c_ooo          comments 
##                11                14                13               290
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{apply}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(penguins), }\DecValTok{2}\NormalTok{, sum)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         studyname     sample_number           species            region 
##                 0                 0                 0                 0 
##            island                ID clutch_completion          date_egg 
##                 0                 0                 0                 0 
##  culmen_length_mm   culmen_depth_mm flipper_length_mm       body_mass_g 
##                 2                 2                 2                 2 
##               sex    delta_15_n_ooo    delta_13_c_ooo          comments 
##                11                14                13               290
\end{verbatim}

Note: Go to \url{https://www.guru99.com/r-apply-sapply-tapply.html} to better understand ``apply'' and other functions.

Or we can do something more elegant and use some packages that show us, with graphics, where our NAs are.
Here are a few examples that I took from a quick google search:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Alternative 1}
\FunctionTok{library}\NormalTok{(naniar)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'naniar' was built under R version 4.2.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(UpSetR)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'UpSetR' was built under R version 4.2.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{as\_shadow\_upset}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{upset}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-89-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Alternative n2}
\FunctionTok{library}\NormalTok{(visdat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'visdat' was built under R version 4.2.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{vis\_miss}\NormalTok{(penguins)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-89-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{visdat}\SpecialCharTok{::}\FunctionTok{vis\_dat}\NormalTok{(penguins)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-89-3.pdf}

Now, we need to decide what to do with these NA values.
We can see below that two penguins have data missing from their base features (e.g., culmen\_lenght and body\_mass).
Also, a few of them don't have information regarding sex.
Since these are critical features, I'm gonna go ahead and eliminate these entries.
We can do so by several ways, but below you have two examples on how to eliminate NA values.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Example 1}
\NormalTok{penguins }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(culmen\_length\_mm),  }\CommentTok{\# show only rows that are not NA in the culmen\_length\_mm}
         \SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(sex)) }\CommentTok{\# show only rows that are not NA in the sex column}

\CommentTok{\# Example 2}
\NormalTok{penguins }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{drop\_na}\NormalTok{(culmen\_length\_mm, sex)}
\end{Highlighting}
\end{Shaded}

Now for some final touches, I will transform the body mass column's units from grams to kilograms.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Converting body\_mass from grams to kg}
\NormalTok{penguins }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{body\_mass =}\NormalTok{ body\_mass\_g}\SpecialCharTok{/}\DecValTok{1000}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{body\_mass\_g =} \ConstantTok{NULL}\NormalTok{)  }\CommentTok{\# removing old column}
\end{Highlighting}
\end{Shaded}

To finish this data cleaning, its important to point out that we could have just done everything in one go, as exemplified below.
Although as you can see, when dealing with too many things, its usually best to separate adjustments per chunks.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\OtherTok{\textless{}{-}}\NormalTok{ penguins\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rename}\NormalTok{(}\StringTok{\textquotesingle{}ID\textquotesingle{}} \OtherTok{=} \StringTok{\textquotesingle{}Individual ID\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{rename\_with}\NormalTok{(tolower) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# lower{-}case every column}
  \FunctionTok{rename\_with}\NormalTok{(toupper, }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{\textquotesingle{}ID\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# up{-}case column starting with "ID"}
  \FunctionTok{rename\_with}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\FunctionTok{gsub}\NormalTok{(}\StringTok{" "}\NormalTok{, }\StringTok{"\_"}\NormalTok{, .x))  }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# subs every space (" ") with no space ("\_")}
  \FunctionTok{rename\_with}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\FunctionTok{gsub}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{("}\NormalTok{, }\StringTok{""}\NormalTok{, .x)) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\#removes every "("}
  \FunctionTok{rename\_with}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\FunctionTok{gsub}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{)"}\NormalTok{, }\StringTok{""}\NormalTok{, .x))  }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# removes every ")"}
  \FunctionTok{rename\_with}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\FunctionTok{gsub}\NormalTok{(}\StringTok{"/"}\NormalTok{ ,}\StringTok{""}\NormalTok{, .x)) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# removes /}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date\_egg =} \FunctionTok{as.Date}\NormalTok{(date\_egg)) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# turns the column to data format}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{species =} \FunctionTok{gsub}\NormalTok{(}\StringTok{" *}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{(.*?}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{) *"}\NormalTok{, }\StringTok{""}\NormalTok{, species)) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# removes text between parenthesis in species}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{stage =} \ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# removes stage column}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(culmen\_length\_mm), }\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(sex)) }\SpecialCharTok{\%\textgreater{}\%}   \CommentTok{\# removes NA rows from these 2 columns}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{body\_mass =}\NormalTok{ body\_mass\_g}\SpecialCharTok{/}\DecValTok{1000}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}   \CommentTok{\# transforms body\_mass\_g column to kilograms}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{body\_mass\_g =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{summarising}{%
\section{Summarising}\label{summarising}}

Before we start drawing graphs left and right, its important to also explore the data with data summaries (in text format).
As mentioned, from my perspective, EDA isn't an exact science, in a sense that there is no appropriate set of measures to explore.
Knowing what to do comes from both a) knowing your data, b) what your objectives are and c) experience.
Below I'm going to try to cover some aspects of EDA (first in text than with plots) that I would do when analysing this data.
Lets start\ldots{}

So, how many observations per specie are there in the data?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 2
##   species               n
##   <chr>             <int>
## 1 Adelie Penguin      146
## 2 Chinstrap penguin    68
## 3 Gentoo penguin      119
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(penguins}\SpecialCharTok{$}\NormalTok{species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##    Adelie Penguin Chinstrap penguin    Gentoo penguin 
##               146                68               119
\end{verbatim}

Alternatively, we can use the functions \texttt{tabyl()} and \texttt{adorn\_totals()} from the janitor package and create a more elaborate summary with percentages and totals.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{  janitor}\SpecialCharTok{::}\FunctionTok{tabyl}\NormalTok{(species) }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{  janitor}\SpecialCharTok{::}\FunctionTok{adorn\_totals}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            species   n   percent
##     Adelie Penguin 146 0.4384384
##  Chinstrap penguin  68 0.2042042
##     Gentoo penguin 119 0.3573574
##              Total 333 1.0000000
\end{verbatim}

Alright, now lets say we want to know how they are distributed across islands

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(island) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 5 x 3
## # Groups:   island [3]
##   island    species               n
##   <chr>     <chr>             <int>
## 1 Biscoe    Adelie Penguin       44
## 2 Biscoe    Gentoo penguin      119
## 3 Dream     Adelie Penguin       55
## 4 Dream     Chinstrap penguin    68
## 5 Torgersen Adelie Penguin       47
\end{verbatim}

What seem to be the main problems presented in the observation column?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(comments)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(comments)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 2
##   comments                                                                 n
##   <chr>                                                                <int>
## 1 Nest never observed with full clutch.                                   34
## 2 Nest never observed with full clutch. Not enough blood for isotopes.     1
## 3 No delta15N data received from lab.                                      1
## 4 Not enough blood for isotopes.                                           7
\end{verbatim}

Since we spotted that some comments only appear very often we could quickly do some data cleaning again.
Namely we might wanna combine certain levels of a factor or characters that are less represented (compared to other levels) together, instead of representing each.
In this case we would combine less represented types of comments into a single label (e.g., ``OtherProblems'').
For that we could use \texttt{fct\_lump()}.
This function ``lumps'' (joins) together factors or characters with little representation.
We just need to say which column we want to use this on, and we can define other parameters of interest.
These are:

\begin{itemize}
\item
  \textbf{n}: (specifying which of the most common to preserve, default being 1).
  If I say \texttt{n\ =\ 2} only the two most common comments will be preserved, with the rest being labeled as ``OtherProblems''.
\item
  \textbf{p}: Alternative to ``n'' in which we can specify to preserve only the levels/characters which have at least a proportion of x.
  Again, if we said p = 0.2, only the comments which are represented in 20\% of the data would be kept.
\item
  \textbf{other\_level}: Here you set the name attributed to the lumped factors.
  In this case we say ``OtherProblems''.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{comments2 =} \FunctionTok{fct\_lump}\NormalTok{(}\AttributeTok{f=}\NormalTok{comments, }\AttributeTok{n =} \DecValTok{1}\NormalTok{, }\AttributeTok{other\_level =} \StringTok{\textquotesingle{}OtherProblems\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{head}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 17
##   study~1 sampl~2 species region island ID    clutc~3 date_egg   culme~4 culme~5
##   <chr>     <dbl> <chr>   <chr>  <chr>  <chr> <chr>   <date>       <dbl>   <dbl>
## 1 PAL0708       1 Adelie~ Anvers Torge~ N1A1  Yes     2007-11-11    39.1    18.7
## 2 PAL0708       2 Adelie~ Anvers Torge~ N1A2  Yes     2007-11-11    39.5    17.4
## 3 PAL0708       3 Adelie~ Anvers Torge~ N2A1  Yes     2007-11-16    40.3    18  
## 4 PAL0708       5 Adelie~ Anvers Torge~ N3A1  Yes     2007-11-16    36.7    19.3
## 5 PAL0708       6 Adelie~ Anvers Torge~ N3A2  Yes     2007-11-16    39.3    20.6
## 6 PAL0708       7 Adelie~ Anvers Torge~ N4A1  No      2007-11-15    38.9    17.8
## # ... with 7 more variables: flipper_length_mm <dbl>, sex <chr>,
## #   delta_15_n_ooo <dbl>, delta_13_c_ooo <dbl>, comments <chr>,
## #   body_mass <dbl>, comments2 <fct>, and abbreviated variable names
## #   1: studyname, 2: sample_number, 3: clutch_completion, 4: culmen_length_mm,
## #   5: culmen_depth_mm
\end{verbatim}

Anyway, back to exploring the data\ldots{} Now lets ask the mean for each specie \texttt{across} all columns in the data frame, \texttt{where} the values are numeric.
We can do this, by simply grouping the data by species, that using the command below.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.numeric), mean, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{head}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: There was 1 warning in `summarise()`.
## i In argument: `across(where(is.numeric), mean, na.rm = TRUE)`.
## i In group 1: `species = "Adelie Penguin"`.
## Caused by warning:
## ! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.
## Supply arguments directly to `.fns` through an anonymous function instead.
## 
##   # Previously
##   across(a:b, mean, na.rm = TRUE)
## 
##   # Now
##   across(a:b, \(x) mean(x, na.rm = TRUE))
\end{verbatim}

\begin{verbatim}
## # A tibble: 3 x 8
##   species           sample_num~1 culme~2 culme~3 flipp~4 delta~5 delta~6 body_~7
##   <chr>                    <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
## 1 Adelie Penguin            79      38.8    18.3    190.    8.86   -25.8    3.71
## 2 Chinstrap penguin         34.5    48.8    18.4    196.    9.36   -24.5    3.73
## 3 Gentoo penguin            61.5    47.6    15.0    217.    8.25   -26.2    5.09
## # ... with abbreviated variable names 1: sample_number, 2: culmen_length_mm,
## #   3: culmen_depth_mm, 4: flipper_length_mm, 5: delta_15_n_ooo,
## #   6: delta_13_c_ooo, 7: body_mass
\end{verbatim}

\hypertarget{plots}{%
\section{Plots}\label{plots}}

\hypertarget{formula}{%
\subsection{Formula}\label{formula}}

\url{https://r-graph-gallery.com/}
R has a natural plot language, but its quite ``primitive'' and complicated.
It is adequate if you want really quick plots with minimal customization.
Otherwise I would recommend using \texttt{ggplot2}.

\texttt{ggplot2} uses a distinct grammar for expression plots.
It may seem complicated at first, but its actually quite simple.
So every plot must start with a simple command:

\texttt{ggplot(dataframe,\ aes("data"))}

In the first parameter you just tell the command which dataframe to use.
Assuming your dataframe is labeled as ``df'' you can just the following:

\texttt{ggplot(df,\ aes("data"))}

or

\texttt{df\ \%\textgreater{}\%\ ggplot(aes("data"))}

The next thing we need to do is specify which variables and measures we want to add to the plot.
This is done inside the \texttt{aes()} command.
You can add the obvious x and y info, and you can also add group related info, which can be coded as ``color'', ``fill'' or ``shape''.
Here's a few generic examples:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ weight, }\AttributeTok{y =}\NormalTok{ height))}

\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ education\_level, }\AttributeTok{y =}\NormalTok{ average\_grade))}

\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ country, }\AttributeTok{y =}\NormalTok{ height, }\AttributeTok{color =}\NormalTok{ sex))}

\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ country, }\AttributeTok{y =}\NormalTok{ average\_reading\_time,}
               \AttributeTok{color =}\NormalTok{ sex, }\AttributeTok{shape =}\NormalTok{ genre))}
\end{Highlighting}
\end{Shaded}

After this is specified, you just need to add layers of what you want.
By adding, I mean inserting a \texttt{+} and specifying the layers you want.
Do you want points?
Bars?
Lines?
Circles?
Whatever you want, you'll add each as a layer with \texttt{geom\_something()}, with the something corresponding to what you want.
\texttt{ggplot2} has plenty of geoms, and I'll be showing you a few below.
If you want to see what the rest can do, visit: \url{https://ggplot2.tidyverse.org/reference/}

So your general plot code for a simple bar plot should look something like:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(dataframe, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ variable, }\AttributeTok{y =}\NormalTok{ variable2)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{() }
\end{Highlighting}
\end{Shaded}

Lastly, you might want to specify other little details, such as the labels, the theme, the color scheme, etc.
You can specify hundreds of things.
I'm just gonna leave you the commands I use the most and I think will be most useful to you.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Specifying the labels}
\FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{\textquotesingle{}x{-}axis label\textquotesingle{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textquotesingle{}y{-}axis label\textquotesingle{}}\NormalTok{, }\AttributeTok{title =} \StringTok{\textquotesingle{}title text\textquotesingle{}}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}color label text\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Specifying the lower and upper bounds of the axis}
\FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}lower\_y\_limit\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}upper\_y\_limit\textquotesingle{}}\NormalTok{),}
                \AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}lower\_x\_limit\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}upper\_y\_limit\textquotesingle{}}\NormalTok{))}

\CommentTok{\# Splitting the graphs creating several based on a grouping variable}
\FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\StringTok{\textquotesingle{}grouping\_variable\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Themes (just some examples)}
\FunctionTok{theme\_classic}\NormalTok{()}
\FunctionTok{theme\_light}\NormalTok{()}
\FunctionTok{theme\_gray}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

If you want to save your plots you can do so either by clicking in the ``Export'' button on your Plots separator or you can use the function \texttt{ggsave()}.

Well this should give you a general idea on how plots work.
For more info, visit: \url{http://r-statistics.co/Complete-Ggplot2-Tutorial-Part1-With-R-Code.html}

On to some examples with our data.

Note: I purposely leave some additional parameters inside each plot building code, not to confuse you, but to introduce you more ways to tweak your plot.
I encourage you to mess with them.

\hypertarget{cols-and-bars}{%
\subsection{Cols and Bars}\label{cols-and-bars}}

The bar plot is one of the most common ones.
R has two types of ``bar'' plots.

\begin{itemize}
\item
  \texttt{geom\_bar}: Creates proportional count of entries (same as \texttt{count} but in a plot).
  Only requires one variable.
\item
  \texttt{geom\_col}: Creates a more typical bar plot, where the height represents values/statistics of the data,
\end{itemize}

Here's an example usage of \texttt{geom\_bar}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Count}
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 2
##   species               n
##   <chr>             <int>
## 1 Adelie Penguin      146
## 2 Chinstrap penguin    68
## 3 Gentoo penguin      119
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Geom bar (count as a plot)}

\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{() }
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-102-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{fill =} \StringTok{\textquotesingle{}darkgreen\textquotesingle{}}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, }\AttributeTok{size =} \DecValTok{2}\NormalTok{, }\AttributeTok{width =}\NormalTok{ .}\DecValTok{5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## i Please use `linewidth` instead.
\end{verbatim}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-102-2.pdf}

Now regarding \texttt{geom\_col} and the more typical use of showing means.
You have two ways of doing it, either:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  you compute the means and build the plot with \texttt{geom\_col()}
\item
  you use the \texttt{stat\_summary()} function to compute the mean inside the ggplot and specify that you want the ``col'' geom (or ``bar'' geom).
\end{enumerate}

I usually just use \texttt{stat\_summary()}, instead of pre-computing the means, because its faster and this allows me to add another function with \texttt{stat\_summary()} that can also compute things like error bars.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. }
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(species, sex) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{body\_mass =} \FunctionTok{mean}\NormalTok{(body\_mass)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(species, body\_mass, }\AttributeTok{fill =}\NormalTok{ sex)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(.}\DecValTok{9}\NormalTok{), }\AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{)) }\SpecialCharTok{+} 
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{\textquotesingle{}Plot with Means: Method 1\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'species'. You can override using the
## `.groups` argument.
\end{verbatim}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-103-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 2.}
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(species, body\_mass, }\AttributeTok{fill =}\NormalTok{ sex)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{\textquotesingle{}col\textquotesingle{}}\NormalTok{, }\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(.}\DecValTok{9}\NormalTok{), }
               \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{6}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{\textquotesingle{}Plot with Means: Method 2\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-103-2.pdf}

\hypertarget{boxplots}{%
\subsection{Boxplots}\label{boxplots}}

Boxplots are a really cool way of showing you how your data is distributed across each category.
Its particularly important when you have skewed data, or are just simply more interested in the median (as opposed to the mean).
Below I introduce you the standard box plot, while also showing you other layers that can both appear on their own or can complement the boxplot geom, namely \texttt{geom\_jitter()} and \texttt{geom\_violin()}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(delta\_15\_n\_ooo)) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# remove NAs in the column to prevent warnings}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ species, }\AttributeTok{y =}\NormalTok{ delta\_15\_n\_ooo, }\AttributeTok{fill =}\NormalTok{ species)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_jitter}\NormalTok{(}\AttributeTok{width =}\NormalTok{ .}\DecValTok{2}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.3}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{shape =}\NormalTok{ island, }\AttributeTok{color =}\NormalTok{ sex), }\AttributeTok{size =} \DecValTok{3}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_violin}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{1}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# the alpha parameter models transparency (ranges from 0 to 1)}
  \FunctionTok{theme\_light}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-104-1.pdf}

\hypertarget{density}{%
\subsection{Density}\label{density}}

Density plots are great and provide a simple way for you to measure distribution of a variable's values.
You just need to point out the variable name, in this case we will look at ``body\_mass'', and we will additionally want the distributions separated by ``species''.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass, }\AttributeTok{fill =}\NormalTok{ species)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{\textquotesingle{}Body mass (kg)\textquotesingle{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textquotesingle{}Density\textquotesingle{}}\NormalTok{,}
       \AttributeTok{fill =} \StringTok{\textquotesingle{}Species\textquotesingle{}}\NormalTok{, }
       \AttributeTok{title =} \StringTok{\textquotesingle{}Body mass distributions across Species\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Dark2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-105-1.pdf}

\hypertarget{facets}{%
\subsection{Facets}\label{facets}}

\texttt{facet\_wrap} is quite useful if you want to compare two plots across 2 (or more) variables.
It divides the data across the variable you name and creates two distinct plots.
You just need to specify the variable, which in this case in done so with \texttt{\textasciitilde{}name\_of\_the\_variable}.
Importantly, if you want the scales (y-limits and x-limits) to be adjusted for each variable's info, you need to specify this using \texttt{scales\ =\ \textquotesingle{}free\textquotesingle{}} if every scale (x and y) can vary between facets, or \texttt{scales\ =\ \textquotesingle{}free\_x\textquotesingle{}} and \texttt{scales\ =\ \textquotesingle{}free\_y\textquotesingle{}}, if you just want the x or y scales to vary freely, respetively.
In this case since we want to compare them directly, I think its best if they are fixed (the default behavior of the function), so you get a better picture as to how different they really are.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass, }\AttributeTok{fill =}\NormalTok{ species)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{\textquotesingle{}Body mass (g)\textquotesingle{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textquotesingle{}Density\textquotesingle{}}\NormalTok{,}
       \AttributeTok{fill =} \StringTok{\textquotesingle{}Species\textquotesingle{}}\NormalTok{, }
       \AttributeTok{title =} \StringTok{\textquotesingle{}Body mass distributions across Species\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Dark2"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{sex, }\AttributeTok{scales =} \StringTok{\textquotesingle{}fixed\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-106-1.pdf}

\hypertarget{coord-flip}{%
\subsection{Coord flip}\label{coord-flip}}

For some plots, it might also be interesting (either more aesthetically pleasing or just a necessity given space limitations) to ``flip the coordinates''.
You can do so, by using the command \texttt{coord\_flip()}.
Here's an example.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ island, }\AttributeTok{fill =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.8}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"darkorange"}\NormalTok{,}\StringTok{"purple"}\NormalTok{,}\StringTok{"cyan4"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{species, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{coord\_flip}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-107-1.pdf}

\hypertarget{correlation-plots}{%
\subsection{Correlation plots}\label{correlation-plots}}

Another particularly useful feature that is usually (initially) explored with plots is correlations.
So lets say we want to get a general idea about correlations between a set of variables in the dataframe.
Here's a way to do it:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{correlations }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}\StringTok{\textquotesingle{}culmen\_length\_mm\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}culmen\_depth\_mm\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}flipper\_length\_mm\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}body\_mass\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{cor}\NormalTok{()}

\NormalTok{corrplot}\SpecialCharTok{::}\FunctionTok{corrplot}\NormalTok{(correlations, }\AttributeTok{method =} \StringTok{\textquotesingle{}number\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-108-1.pdf}

We can additionally separate this correlations by specie.
For that we can use the function \texttt{ggpairs()} from the \texttt{GGally} package.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}\StringTok{\textquotesingle{}species\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}culmen\_length\_mm\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}culmen\_depth\_mm\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}flipper\_length\_mm\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}body\_mass\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{  GGally}\SpecialCharTok{::}\FunctionTok{ggpairs}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ species), }\AttributeTok{axisLabels =} \StringTok{\textquotesingle{}none\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Registered S3 method overwritten by 'GGally':
##   method from   
##   +.gg   ggplot2
\end{verbatim}

\begin{verbatim}
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-109-1.pdf}

When you want to assess something more specific you can use a point plot.
Point plots allow us to see how two numeric variables correlate with each other.
In this example we explore how bill length and flipper length might be correlated, within each species.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot\_fixe }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ culmen\_length\_mm, }\AttributeTok{color =}\NormalTok{ species, }\AttributeTok{shape =}\NormalTok{ species)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =}\NormalTok{ species), }\AttributeTok{size =} \FloatTok{1.7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =}\NormalTok{ species), }\AttributeTok{method =} \StringTok{\textquotesingle{}lm\textquotesingle{}}\NormalTok{, }\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{2}\NormalTok{, }\AttributeTok{formula =} \StringTok{\textquotesingle{}y \textasciitilde{} x\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# adding a line based on linear regression}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{\textquotesingle{}Flipper Length (mm)\textquotesingle{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textquotesingle{}Bill Length (mm)\textquotesingle{}}\NormalTok{,}
       \AttributeTok{color =} \StringTok{\textquotesingle{}Species\textquotesingle{}}\NormalTok{, }\AttributeTok{shape =} \StringTok{\textquotesingle{}Species\textquotesingle{}}\NormalTok{,}
       \AttributeTok{title =} \StringTok{\textquotesingle{}Correlation between Flipper Length and Bill Length\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Dark2"}\NormalTok{)}

\NormalTok{plot\_fixe}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-110-1.pdf}

\hypertarget{multiplots}{%
\subsection{Multiplots}\label{multiplots}}

Another cool thing we might want to do is add multiple plots to a final image.
We can do this using the function \texttt{multiplot} from the packages \texttt{Rmisc}.
Lets say we want to measure the mean of the deltas (``both delta\_15\_n\_ooo'' and ``delta\_13\_c\_ooo''), by species and sex.
And we want to see them, side by side.
To do so, we must create each plot separately, and assign it to a object.
Afterwards, we just need to call these objects inside the \texttt{multiplot} function.
Here's how to do it:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d15\_plot }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(delta\_15\_n\_ooo)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(species, sex) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{delta\_15 =} \FunctionTok{mean}\NormalTok{(delta\_15\_n\_ooo)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(species, delta\_15, }\AttributeTok{color =}\NormalTok{ sex)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =}\NormalTok{ sex), }\AttributeTok{size =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'species'. You can override using the
## `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d13\_plot }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(delta\_13\_c\_ooo)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(species, sex) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{delta\_13 =} \FunctionTok{mean}\NormalTok{(delta\_13\_c\_ooo)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(species, delta\_13, }\AttributeTok{color =}\NormalTok{ sex)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =}\NormalTok{ sex), }\AttributeTok{size =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'species'. You can override using the
## `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Rmisc}\SpecialCharTok{::}\FunctionTok{multiplot}\NormalTok{(d15\_plot, d13\_plot)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-111-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# or}
\NormalTok{Rmisc}\SpecialCharTok{::}\FunctionTok{multiplot}\NormalTok{(d15\_plot, d13\_plot, }\AttributeTok{cols =} \DecValTok{2}\NormalTok{)  }\CommentTok{\# the cols parameter establishes the number of columns in the plot matrix}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-111-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# or}
\FunctionTok{library}\NormalTok{(patchwork)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'patchwork' was built under R version 4.2.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d15\_plot }\SpecialCharTok{+}\NormalTok{ d13\_plot}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-111-3.pdf}

\hypertarget{date-1}{%
\subsection{Date}\label{date-1}}

Plotting date is quite easy, and its quite useful when dealing with time-series analysis.
In this data, as you will see, data is not that relevant.
Below, I first build a general plot showing how many collections there were per date.
Since I found a pattern, showing that these collection took place between November and December in three separate years, I then build three blocks of data for each year, and split the plot to better show the number of data entries per date.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Original plot}
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(date\_egg)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-112-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Transformed plot}
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{DateBlock =} \FunctionTok{case\_when}\NormalTok{(  }\CommentTok{\# creating a new column that identifies which year that data bellongs to}
\NormalTok{    date\_egg }\SpecialCharTok{\textless{}} \StringTok{\textquotesingle{}2008{-}01{-}01\textquotesingle{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textquotesingle{}2007\textquotesingle{}}\NormalTok{,}
\NormalTok{    date\_egg }\SpecialCharTok{\textgreater{}} \StringTok{\textquotesingle{}2008{-}01{-}01\textquotesingle{}} \SpecialCharTok{\&}\NormalTok{ date\_egg }\SpecialCharTok{\textless{}} \StringTok{\textquotesingle{}2009{-}01{-}01\textquotesingle{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textquotesingle{}2008\textquotesingle{}}\NormalTok{,}
\NormalTok{    date\_egg }\SpecialCharTok{\textgreater{}} \StringTok{\textquotesingle{}2009{-}01{-}01\textquotesingle{}}  \SpecialCharTok{\textasciitilde{}} \StringTok{\textquotesingle{}2009\textquotesingle{}}
\NormalTok{  )) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(date\_egg)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{DateBlock, }\AttributeTok{scales =} \StringTok{\textquotesingle{}free\_x\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-112-2.pdf}

\hypertarget{ordering-factors}{%
\subsection{Ordering factors}\label{ordering-factors}}

Another useful function, is the function \texttt{fct\_reorder()} which comes from the package \texttt{forcats}.
This function is particularly (although not exclusively) useful for plots.
As default, R organizes the levels in a factor by alphabetical order.
This function allows us to alter the order by which levels in a factor are presented, according to certain conditions we can define ourselves.
For instance if we plot the mean ``delta\_15\_ooo'' per species of penguin, we get the x-axis with (alphabetically defined) Adelie, Chinstrap and Gentoo penguins.
But lets say instead, we want to reorder the x-axis in a descending order according to mean delta\_15 of each species.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Original plot}
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{species =} \FunctionTok{as.factor}\NormalTok{(species)) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# Turning species to factor}
  \FunctionTok{group\_by}\NormalTok{(species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{delta\_15 =} \FunctionTok{mean}\NormalTok{(delta\_15\_n\_ooo, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(species, delta\_15)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{\textquotesingle{}bar\textquotesingle{}}\NormalTok{, }\AttributeTok{width=}\NormalTok{.}\DecValTok{75}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textquotesingle{}tomato1\textquotesingle{}}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# plotting the mean}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{10}\NormalTok{, }\AttributeTok{vjust =} \FloatTok{0.6}\NormalTok{)) }\SpecialCharTok{+}\CommentTok{\# just to show the x{-}axis text better}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-113-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Reordered plot}
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{delta\_15 =} \FunctionTok{mean}\NormalTok{(delta\_15\_n\_ooo, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{species =} \FunctionTok{fct\_reorder}\NormalTok{(species, delta\_15, }\AttributeTok{.desc =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# organized the levels of species based on delta\_15 (descending)}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(species, delta\_15)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{\textquotesingle{}bar\textquotesingle{}}\NormalTok{, }\AttributeTok{width=}\NormalTok{.}\DecValTok{75}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textquotesingle{}tomato1\textquotesingle{}}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# plotting the mean}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{10}\NormalTok{, }\AttributeTok{vjust =} \FloatTok{0.6}\NormalTok{)) }\SpecialCharTok{+} \CommentTok{\# just to show the x{-}axis text better}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-113-2.pdf}

\hypertarget{end-1}{%
\section{End}\label{end-1}}

\hypertarget{basic-statistical-analysis}{%
\chapter{Basic Statistical Analysis}\label{basic-statistical-analysis}}

In this chapter we will perform some basic statistical analyses on several distinct data sets. These analyses are just some examples that should get you going. The point here is to show you the syntax adopted by most analyses-related functions as well as to demonstrate how you need to prepare data, what the output looks like, etc.. Everything you will see will pretty much be the action part of the analysis plan, and not the whole exploration and full comprehension of the data that should precede any analysis. I will not be discussing the output of each analysis, only how to perform them. That latter part will be up to you, since you already have the know-how on how to read, wrangle, describe and visualize your data (Chapter 1, 2 and 3).\\
Thus, this is by no means a detailed guide on how to analyse data. That would require an entire book on itself. So remember, this is just a ``demo'' and not the entire game. I will make sure, however, to leave some references for each topic if you are interested in better understanding and applying these analyses methods yourself. At the end you will have some more general recommendations for a full ``intro to analysis with R'' type of books/guides.\\

\textbf{Disclaimer}: I am not (by no means) a statistical expert, and some of the explanations used here, albeit brief and simple, might oversimplify or even outright give you a wrong idea about the analysis. I advise you to carefully read about the analysis you plan to perform and not just rely on this guide for that purpose.

Now, why use R? Why not just manipulate the data however you like and then save it as a ``.csv'' and read it in SPSS (or any other statistical analysis program). Well, there are several reasons\ldots{}

\begin{itemize}
\item
  \emph{1}: It does not cut your workflow.\\
\item
  \emph{2}: It records every step you take in the analysis.\\
\item
  \emph{3}: It provides a sharable report for others to see and execute the code themselves.\\
\item
  \emph{4}: It has more (way more) ways for you to analyze data.\\
\item
  \emph{5}: It makes you understand (at least a bit more) what you are doing.\\
\end{itemize}

\hypertarget{correlations}{%
\section{Correlations}\label{correlations}}

Correlations tests, as you might already know, measure covariance between variables (strength of association), indicating if there is a positive or negative relationship between them.

There are several types, but I will focus here on the two (well three) most common ones:

\begin{itemize}
\item
  \emph{Pearson r correlation (Parametric)}: Measures the linear dependence between two variables (x and y).\\
\item
  \emph{Spearman rho AND Kendall tau correlation (Non-parametric)}: Computes the correlation between the rankings of variable x and y.\\
\end{itemize}

There are several built-in commands/functions to perform correlations in R. These are \texttt{cor()}, \texttt{cor.test()}. There are slight differences between them, since \texttt{cor()} does not provide any p-values, but works for multiple comparisons, and \texttt{cor.test()} provides p-values, but does not work for multiple comparisons. There are definitely more functions to calculate different correlation indexes and with more features, but these are the simpler ones and do not require you to install any package to perform them.

To show off some examples of correlation, we will use a data set ``Ginzberg'' from the \texttt{carData} package, which containing data about psychiatric patients hospitalized with depression.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OtherTok{\textless{}{-}} \FunctionTok{as\_tibble}\NormalTok{(carData}\SpecialCharTok{::}\NormalTok{Ginzberg)}

\FunctionTok{head}\NormalTok{(d)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 6
##   simplicity fatalism depression adjsimp adjfatal adjdep
##        <dbl>    <dbl>      <dbl>   <dbl>    <dbl>  <dbl>
## 1      0.930   0.356       0.599   0.759   0.107   0.419
## 2      0.911   1.18        0.728   0.727   0.999   0.517
## 3      0.534  -0.0584      0.534   0.622   0.0381  0.707
## 4      0.741   0.356       0.566   0.835   0.422   0.656
## 5      0.534   0.770       0.502   0.477   0.814   0.535
## 6      0.628   1.39        0.566   0.407   1.23    0.340
\end{verbatim}

We can choose to selectively correlate two variables, like for instance fatalism with depression

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot}
\NormalTok{d }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(fatalism, depression)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{\textquotesingle{}lm\textquotesingle{}}\NormalTok{, }\AttributeTok{formula =} \StringTok{\textquotesingle{}y \textasciitilde{} x\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-116-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Correlation test}
\FunctionTok{cor.test}\NormalTok{(d}\SpecialCharTok{$}\NormalTok{fatalism, d}\SpecialCharTok{$}\NormalTok{depression)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's product-moment correlation
## 
## data:  d$fatalism and d$depression
## t = 7.8024, df = 80, p-value = 1.97e-11
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.5136315 0.7652141
## sample estimates:
##       cor 
## 0.6573674
\end{verbatim}

Alternatively we can quickly explor all correlations within a data set

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Simple descripite measure}
\FunctionTok{cor}\NormalTok{(d[,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            simplicity  fatalism depression   adjsimp  adjfatal    adjdep
## simplicity  1.0000000 0.6312820  0.6432668 0.8828320 0.4739231 0.5055916
## fatalism    0.6312820 1.0000000  0.6573674 0.4762675 0.8871990 0.5155501
## depression  0.6432668 0.6573674  1.0000000 0.5240324 0.5317250 0.9150317
## adjsimp     0.8828320 0.4762675  0.5240324 1.0000000 0.5368211 0.5726930
## adjfatal    0.4739231 0.8871990  0.5317250 0.5368211 1.0000000 0.5810994
## adjdep      0.5055916 0.5155501  0.9150317 0.5726930 0.5810994 1.0000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Simple graphic version}
\FunctionTok{pairs}\NormalTok{(d)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-117-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# More elaborate version}
\FunctionTok{library}\NormalTok{(GGally)}
\FunctionTok{ggpairs}\NormalTok{(d)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-117-2.pdf}

You can also split the correlation by groups. Here's how.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Adding a generic group variable}
\NormalTok{group }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}A\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}B\textquotesingle{}}\NormalTok{), }\FunctionTok{nrow}\NormalTok{(d), }\AttributeTok{replace=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{d}\SpecialCharTok{$}\NormalTok{group }\OtherTok{\textless{}{-}}\NormalTok{ group}


\CommentTok{\# Correlation plots}
\FunctionTok{ggpairs}\NormalTok{(d[, }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{7}\NormalTok{)], }
        \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ group))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-118-1.pdf}

Lastly, we can correlate all other variables with one of our choosing.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Naming cols}
\NormalTok{cols }\OtherTok{\textless{}{-}} \FunctionTok{colnames}\NormalTok{(d)[}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{)]}

\CommentTok{\# d to dataframe (cor.test is picky)}
\NormalTok{d }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(d)}

\CommentTok{\# Iterate over all combinations}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in}\NormalTok{ cols)\{}
\NormalTok{  cor }\OtherTok{\textless{}{-}} \FunctionTok{unlist}\NormalTok{(}\FunctionTok{cor.test}\NormalTok{(d}\SpecialCharTok{$}\NormalTok{depression, d[, col]))}
\NormalTok{  cor\_value }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(cor[}\DecValTok{4}\NormalTok{]), }\DecValTok{3}\NormalTok{)}
\NormalTok{  cor\_pvalue }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(cor[}\DecValTok{3}\NormalTok{]), }\DecValTok{3}\NormalTok{)}
  
  \ControlFlowTok{if}\NormalTok{ (cor\_pvalue }\SpecialCharTok{==} \DecValTok{0}\NormalTok{)\{}
\NormalTok{    cor\_pvalue }\OtherTok{=} \StringTok{\textquotesingle{}\textless{}0.001\textquotesingle{}}
\NormalTok{  \}}
  
  \FunctionTok{cat}\NormalTok{(}\StringTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}n}\StringTok{Correlation between Depression and\textquotesingle{}}\NormalTok{, col, }\StringTok{\textquotesingle{}: \textquotesingle{}}\NormalTok{, cor\_value, }\StringTok{\textquotesingle{}, with p{-}value:\textquotesingle{}}\NormalTok{, cor\_pvalue)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Correlation between Depression and simplicity :  0.643 , with p-value: <0.001
## Correlation between Depression and fatalism :  0.657 , with p-value: <0.001
## Correlation between Depression and adjsimp :  0.524 , with p-value: <0.001
## Correlation between Depression and adjfatal :  0.532 , with p-value: <0.001
## Correlation between Depression and adjdep :  0.915 , with p-value: <0.001
\end{verbatim}

Now all of the correlation we have seen so far have been between two continuous variables, and we thus always employed a Pearson correlation test. To perform other correlations, just choose which method you want with the \texttt{method} argument inside the \texttt{cor.test()} function. You can choose between ``pearson'' (default), ``kendall'' or ``spearman''.\\

For more information about correlations in R I recommend you read the following:\\
- www.sthda.com/english/wiki/correlation-test-between-two-variables-in-r\\
- \url{https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/\#for-2-variables}

\hypertarget{linear-regressions}{%
\section{Linear Regressions}\label{linear-regressions}}

So linear regression (LR) are a statistical method used to model a relationship between a \textbf{dependent (outcome) variable} and \textbf{independent (predictors) variables} by fitting a linear equation to the observed data. We can use it to study understand the relationship between these variables or predict future (yet unobserved) values.\\
The basic syntax for LR in R is as follows: \texttt{lm(y\ \textasciitilde{}\ x,\ data\ =\ d)}. \texttt{lm} stands for linear model. \texttt{y} will be our outcome variable and \texttt{x} our predictor. You can interpret \texttt{\textasciitilde{}} here and in the following analysis as ``predicted by''.

Lets look at a couple of examples. To do this we are going to load the data ``Soils'' from the \texttt{carData} package. This data concerns soil characteristics measured on samples. We will assume ``pH'' is our outcome/dependent variable.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ carData}\SpecialCharTok{::}\NormalTok{Soils}

\NormalTok{m }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(pH }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Depth, }\AttributeTok{data =}\NormalTok{ d)}
\NormalTok{m}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = pH ~ Depth, data = d)
## 
## Coefficients:
## (Intercept)   Depth10-30   Depth30-60   Depth60-90  
##      5.3975      -0.3933      -1.1192      -1.4000
\end{verbatim}

Now if you call the model you created (here labeled as ``m'') it prints only a very small output with the coefficients of the equation only. You can get a more detailed view of everything using the command \texttt{summary()} or something more concise with \texttt{anova()} or \texttt{car::Anova()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = pH ~ Depth, data = d)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.54417 -0.23250 -0.08083  0.15500  1.66583 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)   5.3975     0.1089  49.585  < 2e-16 ***
## Depth10-30   -0.3933     0.1539  -2.555   0.0142 *  
## Depth30-60   -1.1192     0.1539  -7.270 4.60e-09 ***
## Depth60-90   -1.4000     0.1539  -9.094 1.15e-11 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3771 on 44 degrees of freedom
## Multiple R-squared:  0.7051, Adjusted R-squared:  0.685 
## F-statistic: 35.07 on 3 and 44 DF,  p-value: 9.811e-12
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{anova}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Variance Table
## 
## Response: pH
##           Df  Sum Sq Mean Sq F value    Pr(>F)    
## Depth      3 14.9590  4.9863  35.068 9.811e-12 ***
## Residuals 44  6.2563  0.1422                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{car}\SpecialCharTok{::}\FunctionTok{Anova}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Anova Table (Type II tests)
## 
## Response: pH
##            Sum Sq Df F value    Pr(>F)    
## Depth     14.9590  3  35.068 9.811e-12 ***
## Residuals  6.2563 44                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

Now its not the focus of this book to explain all the content of the output. If you ever performed a similar analysis in SPSS then you should, by looking careful, finding everything you need.

Now, linear regression has a few assumptions that you probably would like to assure. These are:

1 - \emph{Linearity}: The relationship between the independent and dependent variables is linear.
2 - \emph{Independence}: The observations are independent of each other.
3 - \emph{Homoscedasticity}: The variance of the errors is constant across all levels of the independent variable(s)
4 - \emph{Normality}: The errors are normally distributed.
5 - \emph{Independence of errors}: The errors are independent of the independent variable(s)

Again, these are beside the point of the guide, but if you want to check them, here is a quick way around a few of the most pertinent points.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Homoscedasticity }
\FunctionTok{plot}\NormalTok{(m}\SpecialCharTok{$}\NormalTok{residuals }\SpecialCharTok{\textasciitilde{}}\NormalTok{ m}\SpecialCharTok{$}\NormalTok{fitted.values)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-122-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Or with ggplot}
\NormalTok{t }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(m}\SpecialCharTok{$}\NormalTok{residuals, m}\SpecialCharTok{$}\NormalTok{fitted.values)}
\NormalTok{t }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(m.fitted.values, m.residuals)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-122-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Normality}
\FunctionTok{plot}\NormalTok{(}\FunctionTok{density}\NormalTok{(m}\SpecialCharTok{$}\NormalTok{residuals))}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-122-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Or with ggplot}
\NormalTok{t }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(m.residuals)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-122-4.pdf}

With your model you can then make predictions, of course. To do this you use the command \texttt{predict}. Lets create a different model first with a continuous predictor

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# New model}
\NormalTok{m }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(pH }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Na, }\AttributeTok{data =}\NormalTok{ d)}

\CommentTok{\# Creating a data frame with several predictor variables we wish to now the predictions too.}
\NormalTok{pd }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Na =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FloatTok{3.5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\FloatTok{8.2}\NormalTok{, }\DecValTok{10}\NormalTok{))}

\CommentTok{\# Predicting}
\FunctionTok{predict}\NormalTok{(m, pd)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        1        2        3        4        5 
## 5.320747 4.966709 4.471054 4.301116 4.046208
\end{verbatim}

Lastly, lets plot our model.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Creating a dummy range of Na values.}
\NormalTok{na\_values }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FunctionTok{range}\NormalTok{(d}\SpecialCharTok{$}\NormalTok{Na)[}\DecValTok{1}\NormalTok{], }\FunctionTok{range}\NormalTok{(d}\SpecialCharTok{$}\NormalTok{Na)[}\DecValTok{2}\NormalTok{], }\FloatTok{0.5}\NormalTok{)}
\NormalTok{plt\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Na =}\NormalTok{ na\_values)}

\CommentTok{\# Generating predictions with prediction confidence intervals}
\NormalTok{plt\_data}\SpecialCharTok{$}\NormalTok{predictions }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(m, plt\_data, }\AttributeTok{se.fit =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{interval =} \StringTok{\textquotesingle{}prediction\textquotesingle{}}\NormalTok{, }\AttributeTok{level =}\NormalTok{ .}\DecValTok{95}\NormalTok{)}\SpecialCharTok{$}\NormalTok{fit[, }\DecValTok{1}\NormalTok{]}
\NormalTok{plt\_data}\SpecialCharTok{$}\NormalTok{lwr }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(m, plt\_data, }\AttributeTok{se.fit =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{interval =} \StringTok{\textquotesingle{}prediction\textquotesingle{}}\NormalTok{, }\AttributeTok{level =}\NormalTok{ .}\DecValTok{95}\NormalTok{)}\SpecialCharTok{$}\NormalTok{fit[, }\DecValTok{2}\NormalTok{]}
\NormalTok{plt\_data}\SpecialCharTok{$}\NormalTok{upr }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(m, plt\_data, }\AttributeTok{se.fit =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{interval =} \StringTok{\textquotesingle{}prediction\textquotesingle{}}\NormalTok{, }\AttributeTok{level =}\NormalTok{ .}\DecValTok{95}\NormalTok{)}\SpecialCharTok{$}\NormalTok{fit[, }\DecValTok{3}\NormalTok{]}

\CommentTok{\# Plotting}
\NormalTok{plt\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(Na, predictions)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_ribbon}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin =}\NormalTok{ lwr, }\AttributeTok{ymax =}\NormalTok{ upr), }\AttributeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{8}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-124-1.pdf}

Linear regressions are one of the fundamental pillars of statistics. Nearly all statistical analyses are variations of linear regressions. I encourage you to truly understand them as it will give you more confidence when trying to perform any of the analyses shown below. Here are a few resources:\\

\begin{itemize}
\tightlist
\item
  \url{https://www.spiceworks.com/tech/artificial-intelligence/articles/what-is-linear-regression/} (Just on linear regression)\\
\item
  \url{https://www.datacamp.com/tutorial/linear-regression-R}\strut \\
\item
  \url{https://www.tutorialspoint.com/r/r_linear_regression.htm}
\end{itemize}

\hypertarget{t-tests}{%
\subsection{T-tests}\label{t-tests}}

T-tests, used two compare two samples, are also easily done with just base R.
You have the following options:

\begin{itemize}
\item
  One sample (for, as an example, a mean of 2)
  \texttt{t.test(y,\ mu\ =\ 2)}
\item
  Independent samples (samples not related to each other)
  \texttt{t.test(y\ \textasciitilde{}\ x)} (Syntax wide)
  \texttt{t.test(y1,\ y2)} (Syntax long)
\item
  Paired samples (samples related in some way to each other - e.g., from the same ID but different conditions)
  \texttt{t.test(y1,\ y2,\ paired=TRUE)}
\end{itemize}

Lets proceed to some basic examples with the Soils data set from the \texttt{carData} package. This data set depicts soil characteristics that were measured on sample from three types of contours and four depths. The area was also divided into four blocks.

Needless to say the assumptions of the linear regression also hold for the t-tests and ANOVAs, so you should check them out first. But, for the purpose of demonstration, lets skip this and get to the point.

So one question, even if it doesn't entirely makes sense (or at all), is if Density of the samples
is different from 1.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ carData}\SpecialCharTok{::}\NormalTok{Soils}

\FunctionTok{t.test}\NormalTok{(d}\SpecialCharTok{$}\NormalTok{Dens, }\AttributeTok{mu =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  One Sample t-test
## 
## data:  d$Dens
## t = 9.9572, df = 47, p-value = 3.678e-13
## alternative hypothesis: true mean is not equal to 1
## 95 percent confidence interval:
##  1.252023 1.379644
## sample estimates:
## mean of x 
##  1.315833
\end{verbatim}

Now, we may want to know if a Top contour is different from a Slope contour in terms of pH values.
For that we can use a independent-sample t-test. As I showed above, you can use two different syntaxes, with the result, of course, being exactly the same. The choice of syntax usually depends on how your data is structured. If in a long format (such as in this data set) we usually just use the second type of syntax (\texttt{t.test(y1,\ y2)}). If in a wide format we typically use the first syntax (\texttt{y\ \textasciitilde{}\ x}). Still, as long as you prepare your data, you can use whatever format you want.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Syntax wide}
\FunctionTok{t.test}\NormalTok{(d[d}\SpecialCharTok{$}\NormalTok{Contour }\SpecialCharTok{==} \StringTok{\textquotesingle{}Top\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}pH\textquotesingle{}}\NormalTok{], d[d}\SpecialCharTok{$}\NormalTok{Contour }\SpecialCharTok{==} \StringTok{\textquotesingle{}Slope\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}pH\textquotesingle{}}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  d[d$Contour == "Top", "pH"] and d[d$Contour == "Slope", "pH"]
## t = -0.67156, df = 27.412, p-value = 0.5075
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.7143742  0.3618742
## sample estimates:
## mean of x mean of y 
##   4.57000   4.74625
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Syntax long}
\NormalTok{d\_test }\OtherTok{\textless{}{-}}\NormalTok{ d[d}\SpecialCharTok{$}\NormalTok{Contour }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Top\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Slope\textquotesingle{}}\NormalTok{),]  }\CommentTok{\# subsetting the data with these two types of contour}
\FunctionTok{t.test}\NormalTok{(pH }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Contour, }\AttributeTok{data =}\NormalTok{ d\_test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  pH by Contour
## t = 0.67156, df = 27.412, p-value = 0.5075
## alternative hypothesis: true difference in means between group Slope and group Top is not equal to 0
## 95 percent confidence interval:
##  -0.3618742  0.7143742
## sample estimates:
## mean in group Slope   mean in group Top 
##             4.74625             4.57000
\end{verbatim}

Now all of these were examples of \textbf{independent} t-tests. To do a \textbf{paired-samples (dependent)} t-test you just have to use \texttt{paired\ =\ TRUE} within the function.
Now the data we used is not dependent/related in any manner. As such, lets use a different data set that features dependent/paired data. For this we will use the data set ``ChickWeight'' that is pre-installed in R. This data describes how time impact the weight gain by chickens considering different diets. Although the type of diet is not paired (only one diet is explored per chicken) the time intervals are measured per chick (each chicken is measured across several time intervals). We are going to work only with the first and second time measurements.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Loading our data frame}
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ ChickWeight}

\CommentTok{\# Messing up with the data so that we can work on a simple example}
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ d }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(Time }\SpecialCharTok{==} \DecValTok{0} \SpecialCharTok{|}\NormalTok{ Time }\SpecialCharTok{==} \DecValTok{2}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Time =} \FunctionTok{ifelse}\NormalTok{(Time }\SpecialCharTok{==} \DecValTok{0}\NormalTok{, }\StringTok{\textquotesingle{}InitialEvaluation\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}FinalEvaluation\textquotesingle{}}\NormalTok{)) }

\FunctionTok{head}\NormalTok{(d)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Grouped Data: weight ~ Time | Chick
##   weight              Time Chick Diet
## 1     42 InitialEvaluation     1    1
## 2     51   FinalEvaluation     1    1
## 3     40 InitialEvaluation     2    1
## 4     49   FinalEvaluation     2    1
## 5     43 InitialEvaluation     3    1
## 6     39   FinalEvaluation     3    1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(weight }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Time, }\AttributeTok{data =}\NormalTok{ d, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Paired t-test
## 
## data:  weight by Time
## t = 15.907, df = 49, p-value < 2.2e-16
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##  7.129123 9.190877
## sample estimates:
## mean difference 
##            8.16
\end{verbatim}

\hypertarget{anovas}{%
\subsection{Anovas}\label{anovas}}

(Very) Simply put, ANOVAs are used to compare groups with more than two-levels. So previously in the t-test examples we only compared two-groups. Either 1 level against a mean value, or two levels between themselves.
Now, if we want to assess if the type of contour differs in their pH level we can simply perform an anova. There are definitely more ways to perform ANOVAs, but for sake of brevity, I'll just leave with the \texttt{aov()} way.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Loading our data frame}
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ carData}\SpecialCharTok{::}\NormalTok{Soils}

\CommentTok{\# Analysis}
\NormalTok{oneway\_anova }\OtherTok{\textless{}{-}} \FunctionTok{aov}\NormalTok{(pH }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Contour, }\AttributeTok{data =}\NormalTok{ d)}
\FunctionTok{summary}\NormalTok{(oneway\_anova)  }\CommentTok{\# asks for the summary}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Df Sum Sq Mean Sq F value Pr(>F)
## Contour      2  0.261  0.1303    0.28  0.757
## Residuals   45 20.955  0.4657
\end{verbatim}

Once more, we performed a one-way (Just 1 factor, which in this case is Contour) independent sample anova. To perform two-way or even more, we could just add more factors such as \texttt{aov(y\ \textasciitilde{}\ factor1\ +\ factor2,\ data\ =\ d)}. Let me exemplify below so I can also you show how you test for interaction between factors in a two-way ANOVA.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{twoway\_anova }\OtherTok{\textless{}{-}} \FunctionTok{aov}\NormalTok{(pH }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Contour}\SpecialCharTok{*}\NormalTok{Block, }\AttributeTok{data =}\NormalTok{ d)}
\FunctionTok{summary}\NormalTok{(twoway\_anova)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##               Df Sum Sq Mean Sq F value Pr(>F)
## Contour        2  0.261  0.1303   0.274  0.762
## Block          3  1.232  0.4108   0.862  0.470
## Contour:Block  6  2.568  0.4280   0.898  0.507
## Residuals     36 17.154  0.4765
\end{verbatim}

The \texttt{*} between the two factors, signifies ``interaction''.

Lastly, you may want to perform a paired samples ANOVA. In this case you can't simply say \texttt{paired\ =\ TRUE}. Here you need a different function. I'm going to introduce you two new ways to perform a repeated-measures (or independent) ANOVA.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(rstatix)  }\CommentTok{\# for anova\_test()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'rstatix' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'rstatix'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:stats':
## 
##     filter
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ez)  }\CommentTok{\# for the ezANOVA()}

\NormalTok{rep.anova1 }\OtherTok{\textless{}{-}} \FunctionTok{anova\_test}\NormalTok{(}\AttributeTok{data =}\NormalTok{ d, }\AttributeTok{dv =}\NormalTok{ pH, }\AttributeTok{wid =}\NormalTok{ Group, }\AttributeTok{within =}\NormalTok{ Block)}
\NormalTok{rep.anova1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## ANOVA Table (type III tests)
## 
## $ANOVA
##   Effect DFn DFd     F     p p<.05   ges
## 1  Block   3  33 3.192 0.036     * 0.058
## 
## $`Mauchly's Test for Sphericity`
##   Effect     W        p p<.05
## 1  Block 0.069 9.95e-05     *
## 
## $`Sphericity Corrections`
##   Effect   GGe      DF[GG] p[GG] p[GG]<.05   HFe     DF[HF] p[HF] p[HF]<.05
## 1  Block 0.417 1.25, 13.78 0.089           0.446 1.34, 14.7 0.086
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Or}

\NormalTok{rep.anova2 }\OtherTok{\textless{}{-}} \FunctionTok{ezANOVA}\NormalTok{(}\AttributeTok{data =}\NormalTok{ d, }\AttributeTok{dv =}\NormalTok{ pH, }\AttributeTok{wid =}\NormalTok{ Group, }\AttributeTok{within =}\NormalTok{ Block)}
\NormalTok{rep.anova2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $ANOVA
##   Effect DFn DFd        F         p p<.05        ges
## 2  Block   3  33 3.191956 0.0362248     * 0.05809364
## 
## $`Mauchly's Test for Sphericity`
##   Effect         W            p p<.05
## 2  Block 0.0690423 9.949466e-05     *
## 
## $`Sphericity Corrections`
##   Effect       GGe      p[GG] p[GG]<.05       HFe      p[HF] p[HF]<.05
## 2  Block 0.4174896 0.08941906           0.4455701 0.08562993
\end{verbatim}

\hypertarget{post-hocs}{%
\subsubsection{Post-hocs}\label{post-hocs}}

Lastly, I would like to briefly introduce a way for you to perform post-hocs. Post-hoc tests are the follow-up on ANOVAs where you investigate which exact groups present a difference. So say for instance that our previous \texttt{twoway\_anova} tells us that the type of Contour shows a statistically significant change over pH (I know it doesn't, so just pretend). Now, you may want to know which contour do exactly differ between themselves in terms of pH values.

For that we will use the \texttt{emmeans} package and base functions such as \texttt{pairs()}and \texttt{contrast()}. There are many other ways to obtain post-hocs, some may be simpler but more specific, but, as an example, I'll demonstrate one of the most versatile (i.e., \texttt{emmeans}). This allows you to do post-hoc test for many types of linear, generalized linear models and mixed models. Given its vast applicability, it sometimes may be a bit confusing in how to extract the post-hoc tests for your model the way you want. For that you can consult its help vignette here:

\url{https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html\#contents}

This function

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(emmeans)  }\CommentTok{\# stands for estimated marginal means}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'emmeans' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'emmeans'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:GGally':
## 
##     pigs
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(twoway\_anova)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##               Df Sum Sq Mean Sq F value Pr(>F)
## Contour        2  0.261  0.1303   0.274  0.762
## Block          3  1.232  0.4108   0.862  0.470
## Contour:Block  6  2.568  0.4280   0.898  0.507
## Residuals     36 17.154  0.4765
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{emm }\OtherTok{\textless{}{-}} \FunctionTok{emmeans}\NormalTok{(}\AttributeTok{object =}\NormalTok{ twoway\_anova,}
                     \AttributeTok{specs =} \SpecialCharTok{\textasciitilde{}}\NormalTok{ Contour}\SpecialCharTok{*}\NormalTok{Block,}
                     \AttributeTok{by =} \StringTok{\textquotesingle{}Contour\textquotesingle{}}\NormalTok{, }
                     \AttributeTok{type =} \StringTok{\textquotesingle{}response\textquotesingle{}}\NormalTok{,}
                     \AttributeTok{adjust =} \StringTok{\textquotesingle{}bonferroni\textquotesingle{}}\NormalTok{)}


\FunctionTok{pairs}\NormalTok{(emm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Contour = Depression:
##  contrast        estimate    SE df t.ratio p.value
##  Block1 - Block2  -0.3525 0.488 36  -0.722  0.8876
##  Block1 - Block3  -0.3000 0.488 36  -0.615  0.9268
##  Block1 - Block4  -0.6550 0.488 36  -1.342  0.5431
##  Block2 - Block3   0.0525 0.488 36   0.108  0.9995
##  Block2 - Block4  -0.3025 0.488 36  -0.620  0.9251
##  Block3 - Block4  -0.3550 0.488 36  -0.727  0.8855
## 
## Contour = Slope:
##  contrast        estimate    SE df t.ratio p.value
##  Block1 - Block2  -0.2725 0.488 36  -0.558  0.9437
##  Block1 - Block3  -0.2500 0.488 36  -0.512  0.9557
##  Block1 - Block4  -1.0225 0.488 36  -2.095  0.1742
##  Block2 - Block3   0.0225 0.488 36   0.046  1.0000
##  Block2 - Block4  -0.7500 0.488 36  -1.537  0.4270
##  Block3 - Block4  -0.7725 0.488 36  -1.583  0.4010
## 
## Contour = Top:
##  contrast        estimate    SE df t.ratio p.value
##  Block1 - Block2  -0.1050 0.488 36  -0.215  0.9964
##  Block1 - Block3   0.2250 0.488 36   0.461  0.9670
##  Block1 - Block4   0.3900 0.488 36   0.799  0.8544
##  Block2 - Block3   0.3300 0.488 36   0.676  0.9055
##  Block2 - Block4   0.4950 0.488 36   1.014  0.7423
##  Block3 - Block4   0.1650 0.488 36   0.338  0.9865
## 
## P value adjustment: tukey method for comparing a family of 4 estimates
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{contrast}\NormalTok{(emm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Contour = Depression:
##  contrast      estimate    SE df t.ratio p.value
##  Block1 effect  -0.3269 0.299 36  -1.094  0.5628
##  Block2 effect   0.0256 0.299 36   0.086  0.9322
##  Block3 effect  -0.0269 0.299 36  -0.090  0.9322
##  Block4 effect   0.3281 0.299 36   1.098  0.5628
## 
## Contour = Slope:
##  contrast      estimate    SE df t.ratio p.value
##  Block1 effect  -0.3862 0.299 36  -1.292  0.4090
##  Block2 effect  -0.1138 0.299 36  -0.381  0.7058
##  Block3 effect  -0.1363 0.299 36  -0.456  0.7058
##  Block4 effect   0.6362 0.299 36   2.129  0.1608
## 
## Contour = Top:
##  contrast      estimate    SE df t.ratio p.value
##  Block1 effect   0.1275 0.299 36   0.427  0.7462
##  Block2 effect   0.2325 0.299 36   0.778  0.7462
##  Block3 effect  -0.0975 0.299 36  -0.326  0.7462
##  Block4 effect  -0.2625 0.299 36  -0.878  0.7462
## 
## P value adjustment: fdr method for 4 tests
\end{verbatim}

You can change your \texttt{by} parameters to adjust what comparisons you want in the \texttt{pairs} and \texttt{contrast} functions. I recommend you manipulate this to really understand its inner workings.

As for the difference between the two functions (i.e., \texttt{pairs} and \texttt{contrasts}):\\
- \texttt{pairs} -\textgreater{} Performs all pairwise comparisons
- \texttt{contrast} -\textgreater{} Used to test specific comparisons/hypotheses

If they are pairwise comparisons you should instead say (in this example) \texttt{pairwise\ \textasciitilde{}\ Contour\ *\ Block}.

\hypertarget{generalized-linear-regression}{%
\section{Generalized Linear Regression}\label{generalized-linear-regression}}

When you have a outcome variable in which its error distribution of its model is not normally distributed, i.e., outcomes such counts or yes/no answers, you should use a \textbf{generalized} linear regression (GLM). It has a \emph{link function} that allows you to model the relationship between the predictor variables and the response variable in the same fashion as a linear regression. Again this is very briefly and simply put, I encourage you to explore more on your own.

Now, GLMs are aptly executed in R with the function \texttt{glm()}

We are going to take on an example from the CES11 database (carData package) which a 2011 Canadian poll on abortion. Here people could vote on weather abortion should be banned (`Yes') or not (`No').
Before performing our GLM we need to first convert the YES/NO answers to 0 and 1 values. Which is which doesn't really matter (only matter for the interpretation of the estimate). Since this is a A or B type of response, we will use the binomial family to model the data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ carData}\SpecialCharTok{::}\NormalTok{CES11}

\CommentTok{\# Recoding}
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ d }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{abortion01 =} \FunctionTok{ifelse}\NormalTok{(abortion }\SpecialCharTok{==} \StringTok{\textquotesingle{}Yes\textquotesingle{}}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{))}

\CommentTok{\# GLM}
\NormalTok{m }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(abortion01 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gender, }\AttributeTok{family =} \StringTok{\textquotesingle{}binomial\textquotesingle{}}\NormalTok{, }\AttributeTok{data =}\NormalTok{ d)}

\CommentTok{\# Interpretation/Summary}
\FunctionTok{summary}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = abortion01 ~ gender, family = "binomial", data = d)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.6425  -0.6425  -0.6365  -0.6365   1.8418  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(>|z|)    
## (Intercept) -1.47295    0.07279 -20.235   <2e-16 ***
## genderMale  -0.02064    0.10984  -0.188    0.851    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2137.6  on 2230  degrees of freedom
## Residual deviance: 2137.6  on 2229  degrees of freedom
## AIC: 2141.6
## 
## Number of Fisher Scoring iterations: 4
\end{verbatim}

Once more, there are many parameters you can tune, other functions you can use, and other families you can model. This is just the more widely known function and most simple example.

\hypertarget{linear-mixed-models}{%
\section{Linear Mixed Models}\label{linear-mixed-models}}

Now, it is far beyond the scope of this brief book to explain to you what linear \textbf{mixed models} (LMMs) are. Firstly, they are known by many names (just see \url{https://en.wikipedia.org/wiki/Multilevel_model}). In linear mixed models you can specify both fixed and random effects. Fixed effects are your usual predictor variables that have systematic effects on your outcome (e.g., treatment manipulations). Random effects are those that have stochastic (random) effect on your outcome, since these are selected randomly. For instance, lets say you plan on exploring if aggressive words, compared to neutral words, cause people to have increased heart-rate. For this you would need to select a \textbf{random sample} of aggressive words and neutral words, since there is no way you could expose your participants to all aggressive or neutral words. These can thus be considered a \emph{random variable}. Usually, IDs of the participants themselves are seen as random effects, since the participants introduce some random (unpredictable) variability (different sample of 1000 participant will lead to slightly different results). And by this I mean each word (the ID of each word), not the category of the word (the category is a fixed variable). You also can (need) to specify the structure of these random effects in a correct manner, namely which effects are nested or crossed and their respective structure. Now, I'm sorry if this doesn't make any sense, but the purpose here is to introduce you to a brief example of LMMs in R and I must skip with a detailed explanation. If it makes you feel any better, the distinction between random and fixed effects is still debated even among top statisticians. There are many more topics to cover for you to understand properly a LMM (even I don't think I understand all of them), but we'll stop here.

To perform LMMs I will use the \texttt{lmer()} function from the \texttt{lme4} package. We will use the sleepstudy data from \texttt{lme4} package. This data is from an experiment related to how sleep deprivation impairs reaction times. In this data participants were trained on the first two days (day 0 and 1) and began the experiment on day 2 (baseline).

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lme4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'lme4' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## Loading required package: Matrix
\end{verbatim}

\begin{verbatim}
## Warning: package 'Matrix' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'Matrix'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:tidyr':
## 
##     expand, pack, unpack
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ lme4}\SpecialCharTok{::}\NormalTok{sleepstudy}

\CommentTok{\# Preparing the data adjusting for deprivation days}
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ d }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\NormalTok{(Days }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Days =}\NormalTok{ Days }\SpecialCharTok{{-}} \DecValTok{2}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Days =} \FunctionTok{as.factor}\NormalTok{(Days))}

\NormalTok{lmm }\OtherTok{\textless{}{-}} \FunctionTok{lmer}\NormalTok{(Reaction }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Days }\SpecialCharTok{+}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{|}\NormalTok{Subject), }\AttributeTok{data =}\NormalTok{ d)}
\NormalTok{car}\SpecialCharTok{::}\FunctionTok{Anova}\NormalTok{(lmm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: Reaction
##       Chisq Df Pr(>Chisq)    
## Days 107.17  7  < 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Post{-}hocs}
\FunctionTok{library}\NormalTok{(emmeans)}
\NormalTok{emm }\OtherTok{\textless{}{-}} \FunctionTok{emmeans}\NormalTok{(}\AttributeTok{object =}\NormalTok{ lmm,}
                     \AttributeTok{specs =}\NormalTok{ pairwise }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Days,}
                     \AttributeTok{type =} \StringTok{\textquotesingle{}response\textquotesingle{}}\NormalTok{,}
                     \AttributeTok{adjust =} \StringTok{\textquotesingle{}bonferroni\textquotesingle{}}\NormalTok{, }
               \AttributeTok{contr =} \FunctionTok{list}\NormalTok{(}\AttributeTok{Days =} \StringTok{"dummy"}\NormalTok{))}


\FunctionTok{pairs}\NormalTok{(emm)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{7}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Note: adjust = "tukey" was changed to "sidak"
## because "tukey" is only appropriate for one set of pairwise comparisons
\end{verbatim}

\begin{verbatim}
##  contrast      estimate   SE  df t.ratio p.value
##  Days0 - Days1    -17.6 10.2 119  -1.723  0.4728
##  Days0 - Days2    -23.3 10.2 119  -2.277  0.1600
##  Days0 - Days3    -43.2 10.2 119  -4.219  0.0003
##  Days0 - Days4    -46.8 10.2 119  -4.577  0.0001
##  Days0 - Days5    -53.4 10.2 119  -5.219  <.0001
##  Days0 - Days6    -71.3 10.2 119  -6.967  <.0001
##  Days0 - Days7    -85.5 10.2 119  -8.357  <.0001
## 
## Degrees-of-freedom method: kenward-roger 
## P value adjustment: sidak method for 7 tests
\end{verbatim}

\hypertarget{generalized-linear-mixed-models}{%
\section{Generalized Linear Mixed Models}\label{generalized-linear-mixed-models}}

Much like generalized linear models, \textbf{Generalized Linear Mixed Models (GLMMs)} allow us to model data that doens't follow a linear trend, like binary data or count data.
To perform GLMMs I will use the \texttt{glmer()} function from the same \texttt{lme4} package. We will use the MplsStops data from \texttt{carData} package. This data set contains the results of nearly all stops made by the Minneapolis Police Department for the year 2017. I'm interested in exploring if more stops are made for Black compared with White people. Since these have been collected by different precincts and different neighborhoods, I can use them too to help explain variability in the data. Obviously this is just an example, since firstly, the data should be adjusted towards the number of White and Black people living in these areas, but it serves as a base example.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ carData}\SpecialCharTok{::}\NormalTok{MplsStops }

\CommentTok{\# Isolating Black/White people and preparing data}
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ d }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{race =} \FunctionTok{as.character}\NormalTok{(race)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(race }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Black\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}White\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{race =} \FunctionTok{as.factor}\NormalTok{(race)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(policePrecinct, neighborhood, race) }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{summarise}\NormalTok{(}\AttributeTok{Stops =} \FunctionTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'policePrecinct', 'neighborhood'. You can
## override using the `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{head}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 4
## # Groups:   policePrecinct, neighborhood [3]
##   policePrecinct neighborhood    race  Stops
##            <int> <fct>           <fct> <int>
## 1              1 Cedar Riverside Black   140
## 2              1 Cedar Riverside White    80
## 3              1 Downtown East   Black    49
## 4              1 Downtown East   White    81
## 5              1 Downtown West   Black  1367
## 6              1 Downtown West   White   780
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{glmm }\OtherTok{\textless{}{-}} \FunctionTok{glmer}\NormalTok{(Stops }\SpecialCharTok{\textasciitilde{}}\NormalTok{ race }\SpecialCharTok{+}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{|}\NormalTok{policePrecinct),}
              \AttributeTok{family =} \StringTok{\textquotesingle{}poisson\textquotesingle{}}\NormalTok{, }\AttributeTok{data =}\NormalTok{ d)}

\NormalTok{car}\SpecialCharTok{::}\FunctionTok{Anova}\NormalTok{(glmm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: Stops
##       Chisq Df Pr(>Chisq)    
## race 456.84  1  < 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\hypertarget{bayesian-analysis}{%
\section{Bayesian analysis}\label{bayesian-analysis}}

Bayesian analysis, can be performed with, among others, the package \texttt{brms}.
This package creates an interface for STAN through R. For those of you who don't know what STAN is, don't worry, its just another probabilistic programming language used for Bayesian statistical inference.
A bayesian model is not that different from the models we built above, we just need to specificy some additional parameters, like \emph{family} and \emph{priors}. Explaining this is beyond this guide, so I encourage you to visit/read the following:

\begin{itemize}
\tightlist
\item
  \url{https://rstudio-pubs-static.s3.amazonaws.com/721703_f1c1a8d256ce4393aabfe23c9c1d221d.html\#what-is-bayesian-inference-work}
\item
  Statistical Rethinking by Richard McElreath
\end{itemize}

Now, we are going to build a model using the \texttt{mtcars}. For this example we are going to create a model predicting \emph{mpg} (miles per galon) using \emph{disp} (displacement of the engine). The model is going to be pretty simple with uninformative priors.

Here is a list (courtesy of chatGPT) of all parameters that can be defined inside a \texttt{brm()} model, with their respective descriptions

• \emph{formula}: The model formula specified using bf(), which defines the response and predictor variables in the model.
• \emph{data}: The dataset containing the variables used in the model.
• \emph{family}: The likelihood function used in the model, which specifies the distribution of the response variable. Common options include gaussian() (for linear regression), binomial() (for logistic regression), poisson() (for count data), and negbinomial() (for overdispersed count data).
• \emph{prior}: A specification of the prior distributions used for the model parameters. Priors can be specified using prior() and can include a wide range of distributions, such as normal(), cauchy(), gamma(), student\_t(), and lkj().
• \emph{control}: A list of control parameters that affect the behavior of the MCMC algorithm used to estimate the posterior distribution. Control parameters can include adapt\_delta (the target acceptance rate for the algorithm), max\_treedepth (the maximum depth of the trees used in the algorithm), and iter (the total number of MCMC iterations to run).
• \emph{chains}: The number of Markov chains to run during the MCMC algorithm. The default is 4.
• \emph{cores}: The number of cores to use for parallel processing during the MCMC algorithm.
• \emph{iter}: The total number of MCMC iterations to run.
• \emph{warmup}: The number of warmup iterations to run at the beginning of the MCMC algorithm, which are discarded before the posterior distribution is estimated.
• \emph{thin}: The thinning interval used to reduce autocorrelation between the MCMC samples.
• \emph{cores}: The number of CPU cores to use for parallel processing.
• \emph{seed}: The random seed used to initialize the MCMC algorithm.
• \emph{save\_all\_pars}: Whether to save all parameter values during the MCMC algorithm. If TRUE, all parameter values are saved, which can be useful for diagnostic purposes.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(brms)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: Rcpp
\end{verbatim}

\begin{verbatim}
## Warning: package 'Rcpp' was built under R version 4.2.2
\end{verbatim}

\begin{verbatim}
## Loading 'brms' package (version 2.18.0). Useful instructions
## can be found by typing help('brms'). A more detailed introduction
## to the package is available through vignette('brms_overview').
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'brms'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:lme4':
## 
##     ngrps
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:stats':
## 
##     ar
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ mtcars}

\FunctionTok{brm}\NormalTok{(}\AttributeTok{formula =} \FunctionTok{bf}\NormalTok{(mpg }\SpecialCharTok{\textasciitilde{}}\NormalTok{ disp),}
    \AttributeTok{data =}\NormalTok{ d,}
    \AttributeTok{family =} \FunctionTok{gaussian}\NormalTok{(),}
    \AttributeTok{prior =} \FunctionTok{c}\NormalTok{(}\FunctionTok{prior}\NormalTok{(}\FunctionTok{normal}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{), }\AttributeTok{class =}\NormalTok{ Intercept),}
              \FunctionTok{prior}\NormalTok{(}\FunctionTok{normal}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{), }\AttributeTok{class =}\NormalTok{ b)),}
    \AttributeTok{chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{iter =} \DecValTok{2000}\NormalTok{, }\AttributeTok{warmup =} \DecValTok{500}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Compiling Stan program...
\end{verbatim}

\begin{verbatim}
## Start sampling
\end{verbatim}

\begin{verbatim}
## 
## SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 3.6e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.36 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 1: Iteration:  501 / 2000 [ 25%]  (Sampling)
## Chain 1: Iteration:  700 / 2000 [ 35%]  (Sampling)
## Chain 1: Iteration:  900 / 2000 [ 45%]  (Sampling)
## Chain 1: Iteration: 1100 / 2000 [ 55%]  (Sampling)
## Chain 1: Iteration: 1300 / 2000 [ 65%]  (Sampling)
## Chain 1: Iteration: 1500 / 2000 [ 75%]  (Sampling)
## Chain 1: Iteration: 1700 / 2000 [ 85%]  (Sampling)
## Chain 1: Iteration: 1900 / 2000 [ 95%]  (Sampling)
## Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.047 seconds (Warm-up)
## Chain 1:                0.041 seconds (Sampling)
## Chain 1:                0.088 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 8e-06 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 2: Iteration:  501 / 2000 [ 25%]  (Sampling)
## Chain 2: Iteration:  700 / 2000 [ 35%]  (Sampling)
## Chain 2: Iteration:  900 / 2000 [ 45%]  (Sampling)
## Chain 2: Iteration: 1100 / 2000 [ 55%]  (Sampling)
## Chain 2: Iteration: 1300 / 2000 [ 65%]  (Sampling)
## Chain 2: Iteration: 1500 / 2000 [ 75%]  (Sampling)
## Chain 2: Iteration: 1700 / 2000 [ 85%]  (Sampling)
## Chain 2: Iteration: 1900 / 2000 [ 95%]  (Sampling)
## Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.043 seconds (Warm-up)
## Chain 2:                0.034 seconds (Sampling)
## Chain 2:                0.077 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 8e-06 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 3: Iteration:  501 / 2000 [ 25%]  (Sampling)
## Chain 3: Iteration:  700 / 2000 [ 35%]  (Sampling)
## Chain 3: Iteration:  900 / 2000 [ 45%]  (Sampling)
## Chain 3: Iteration: 1100 / 2000 [ 55%]  (Sampling)
## Chain 3: Iteration: 1300 / 2000 [ 65%]  (Sampling)
## Chain 3: Iteration: 1500 / 2000 [ 75%]  (Sampling)
## Chain 3: Iteration: 1700 / 2000 [ 85%]  (Sampling)
## Chain 3: Iteration: 1900 / 2000 [ 95%]  (Sampling)
## Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.023 seconds (Warm-up)
## Chain 3:                0.038 seconds (Sampling)
## Chain 3:                0.061 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 7e-06 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.07 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 4: Iteration:  501 / 2000 [ 25%]  (Sampling)
## Chain 4: Iteration:  700 / 2000 [ 35%]  (Sampling)
## Chain 4: Iteration:  900 / 2000 [ 45%]  (Sampling)
## Chain 4: Iteration: 1100 / 2000 [ 55%]  (Sampling)
## Chain 4: Iteration: 1300 / 2000 [ 65%]  (Sampling)
## Chain 4: Iteration: 1500 / 2000 [ 75%]  (Sampling)
## Chain 4: Iteration: 1700 / 2000 [ 85%]  (Sampling)
## Chain 4: Iteration: 1900 / 2000 [ 95%]  (Sampling)
## Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.023 seconds (Warm-up)
## Chain 4:                0.034 seconds (Sampling)
## Chain 4:                0.057 seconds (Total)
## Chain 4:
\end{verbatim}

\begin{verbatim}
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: mpg ~ disp 
##    Data: d (Number of observations: 32) 
##   Draws: 4 chains, each with iter = 2000; warmup = 500; thin = 1;
##          total post-warmup draws = 6000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    29.32      1.30    26.73    31.77 1.00     6134     4014
## disp         -0.04      0.00    -0.05    -0.03 1.00     6922     4592
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     3.38      0.47     2.64     4.45 1.00     3204     2894
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m1 }\OtherTok{\textless{}{-}} \FunctionTok{brm}\NormalTok{(}\AttributeTok{data =}\NormalTok{ d, }
    \AttributeTok{family =}\NormalTok{ gaussian,}
    \AttributeTok{formula =}\NormalTok{ mpg }\SpecialCharTok{\textasciitilde{}} \DecValTok{1} \SpecialCharTok{+}\NormalTok{ disp, }\CommentTok{\# or simply bf(mpg \textasciitilde{} disp)}
    \AttributeTok{prior =} \FunctionTok{c}\NormalTok{(}\FunctionTok{prior}\NormalTok{(}\FunctionTok{normal}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{), }\AttributeTok{class =}\NormalTok{ Intercept),}
              \FunctionTok{prior}\NormalTok{(}\FunctionTok{normal}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{), }\AttributeTok{class =}\NormalTok{ b),}
              \FunctionTok{prior}\NormalTok{(}\FunctionTok{lognormal}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{class =}\NormalTok{ sigma)),}
    \AttributeTok{iter =} \DecValTok{2000}\NormalTok{, }\AttributeTok{warmup =} \DecValTok{1000}\NormalTok{, }\AttributeTok{chains =} \DecValTok{4}\NormalTok{, }\AttributeTok{cores =} \DecValTok{4}\NormalTok{,}
    \AttributeTok{seed =} \DecValTok{7}\NormalTok{,}
    \AttributeTok{file =} \StringTok{\textquotesingle{}ex\_fit\textquotesingle{}}\NormalTok{)}

\FunctionTok{print}\NormalTok{(m1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: mpg ~ 1 + disp 
##    Data: d (Number of observations: 32) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    29.30      1.21    26.77    31.71 1.00     3401     2398
## disp         -0.04      0.00    -0.05    -0.03 1.00     3515     2666
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     3.28      0.42     2.59     4.20 1.00     2640     2936
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).
\end{verbatim}

\hypertarget{time-series}{%
\section{Time series}\label{time-series}}

Time series analysis are another common type of analysis that allows us to identify trends and forecast future values in data that is collected in regular intervals along some time-frame.
To illustrate a time-series analysis we are going to use the ``AirPassengers'' data set. This data set represents the monthly totals of international airline passengers from 1949 to 1960.
To perform a time series you need to make sure that your data is a \texttt{ts} object. Luckily our example is already in this format. For further reading and questions, you can read the following:

\begin{itemize}
\tightlist
\item
  \url{https://a-little-book-of-r-for-time-series.readthedocs.io/en/latest/src/timeseries.html}
\item
  \url{https://www.geeksforgeeks.org/time-series-analysis-in-r/}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the AirPassengers dataset}
\FunctionTok{data}\NormalTok{(AirPassengers)}
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ AirPassengers}

\CommentTok{\# Converting the data frame to a ts object.}
\NormalTok{ts\_data }\OtherTok{\textless{}{-}} \FunctionTok{ts}\NormalTok{(d, }\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{1949}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{frequency =} \DecValTok{12}\NormalTok{)}

\CommentTok{\# Plotting data frame}
\NormalTok{d\_plot }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{date =} \FunctionTok{time}\NormalTok{(ts\_data), }\AttributeTok{passengers =} \FunctionTok{as.numeric}\NormalTok{(ts\_data))}

\NormalTok{d\_plot }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(date, passengers)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Don't know how to automatically pick scale for object of type <ts>. Defaulting
## to continuous.
\end{verbatim}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-136-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Perform a decomposition to separate the trend, seasonal, and random components}
\NormalTok{decomp }\OtherTok{\textless{}{-}} \FunctionTok{decompose}\NormalTok{(ts\_data)}

\CommentTok{\# See the results of the decomposition}
\FunctionTok{plot}\NormalTok{(decomp)}
\end{Highlighting}
\end{Shaded}

\includegraphics{using_r_data_files/figure-latex/unnamed-chunk-136-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fit a simple linear regression model to the time series data}
\NormalTok{m }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(ts\_data }\SpecialCharTok{\textasciitilde{}} \FunctionTok{time}\NormalTok{(ts\_data))}

\FunctionTok{summary}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = ts_data ~ time(ts_data))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -93.858 -30.727  -5.757  24.489 164.999 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(>|t|)    
## (Intercept)   -62055.907   2166.077  -28.65   <2e-16 ***
## time(ts_data)     31.886      1.108   28.78   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 46.06 on 142 degrees of freedom
## Multiple R-squared:  0.8536, Adjusted R-squared:  0.8526 
## F-statistic: 828.2 on 1 and 142 DF,  p-value: < 2.2e-16
\end{verbatim}

\hypertarget{drift-difussion-modelling}{%
\section{Drift difussion modelling}\label{drift-difussion-modelling}}

\hypertarget{survival-analysis}{%
\section{Survival analysis}\label{survival-analysis}}

\hypertarget{end-2}{%
\section{End}\label{end-2}}

  \bibliography{book.bib,packages.bib}

\end{document}
